[0m15:07:36.833875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C824B2AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8274FD8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82395CC40>]}


============================== 15:07:36.878843 | e35b63fb-8f4e-4594-917f-7a1284664bde ==============================
[0m15:07:36.878843 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:07:36.880857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select test_model', 'send_anonymous_usage_stats': 'True'}
[0m15:07:37.411167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e35b63fb-8f4e-4594-917f-7a1284664bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C824FA4220>]}
[0m15:07:37.570008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e35b63fb-8f4e-4594-917f-7a1284664bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8273E8DC0>]}
[0m15:07:37.578638 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:07:37.684355 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:07:37.995496 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m15:07:37.996492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e35b63fb-8f4e-4594-917f-7a1284664bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C826A973D0>]}
[0m15:07:44.345871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e35b63fb-8f4e-4594-917f-7a1284664bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C827B8A1C0>]}
[0m15:07:44.709348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e35b63fb-8f4e-4594-917f-7a1284664bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8275CAAF0>]}
[0m15:07:44.710354 [info ] [MainThread]: Found 1 model, 1 source, 423 macros
[0m15:07:44.711357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e35b63fb-8f4e-4594-917f-7a1284664bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C827D57160>]}
[0m15:07:44.713877 [info ] [MainThread]: 
[0m15:07:44.716391 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:07:44.720937 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:07:52.474881 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:07:52.476051 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:07:52.477568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:56.567441 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

[0m15:08:00.653205 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:08:00.653205 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:08:00.655754 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m15:08:00.656766 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:08:00.657767 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m15:08:00.658772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:00.660985 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:08:00.660985 [info ] [MainThread]: 
[0m15:08:00.663002 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 15.94 seconds (15.94s).
[0m15:08:00.664004 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m15:08:00.669192 [debug] [MainThread]: Command `dbt run` failed at 15:08:00.668171 after 23.96 seconds
[0m15:08:00.670723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C824B2AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C827797CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C824A2FF40>]}
[0m15:08:00.671733 [debug] [MainThread]: Flushing usage events
[0m15:23:32.932311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC51CEAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC7CE7AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC7CE7850>]}


============================== 15:23:32.948176 | 2cd3c6a6-86c7-460b-b59f-1f0c62acc6fe ==============================
[0m15:23:32.948176 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:23:32.949697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select test_model', 'send_anonymous_usage_stats': 'True'}
[0m15:23:33.490316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cd3c6a6-86c7-460b-b59f-1f0c62acc6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC50D8AC0>]}
[0m15:23:33.620866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cd3c6a6-86c7-460b-b59f-1f0c62acc6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC5B9C160>]}
[0m15:23:33.623865 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:23:33.649516 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:23:34.294578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:34.295588 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:34.379634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cd3c6a6-86c7-460b-b59f-1f0c62acc6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC8285940>]}
[0m15:23:34.700652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cd3c6a6-86c7-460b-b59f-1f0c62acc6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC82C2B80>]}
[0m15:23:34.701640 [info ] [MainThread]: Found 1 model, 1 source, 423 macros
[0m15:23:34.703155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cd3c6a6-86c7-460b-b59f-1f0c62acc6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC8291FA0>]}
[0m15:23:34.707176 [info ] [MainThread]: 
[0m15:23:34.709185 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:34.713896 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:23:35.427528 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:23:35.429046 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:23:35.430053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:37.569293 [debug] [ThreadPool]: SQL status: SELECT 4 in 2.139 seconds
[0m15:23:37.571447 [debug] [ThreadPool]: On list_postgres: Close
[0m15:23:37.573609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_pipedrive_analytics)
[0m15:23:37.575841 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_pipedrive_analytics"
"
[0m15:23:37.590450 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m15:23:37.591719 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: BEGIN
[0m15:23:37.592734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:39.668233 [debug] [ThreadPool]: SQL status: BEGIN in 2.075 seconds
[0m15:23:39.668807 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m15:23:39.669939 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_pipedrive_analytics"} */
create schema if not exists "public_pipedrive_analytics"
[0m15:23:39.676587 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.005 seconds
[0m15:23:39.678260 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m15:23:39.679273 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m15:23:39.680278 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m15:23:39.685572 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m15:23:39.686102 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: Close
[0m15:23:39.689447 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m15:23:39.702226 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:23:39.703749 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m15:23:39.704771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:41.776985 [debug] [ThreadPool]: SQL status: BEGIN in 2.072 seconds
[0m15:23:41.778688 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:23:41.779830 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m15:23:41.790478 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m15:23:41.792873 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m15:23:41.796587 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m15:23:41.808393 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:41.809509 [debug] [MainThread]: On master: BEGIN
[0m15:23:41.810616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:43.879547 [debug] [MainThread]: SQL status: BEGIN in 2.069 seconds
[0m15:23:43.880663 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:43.881759 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:23:43.892140 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m15:23:43.894356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cd3c6a6-86c7-460b-b59f-1f0c62acc6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC8349430>]}
[0m15:23:43.895403 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:43.899239 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:43.899794 [debug] [MainThread]: On master: BEGIN
[0m15:23:43.904903 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:23:43.905993 [debug] [MainThread]: On master: COMMIT
[0m15:23:43.906542 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:43.907123 [debug] [MainThread]: On master: COMMIT
[0m15:23:43.910283 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:23:43.910831 [debug] [MainThread]: On master: Close
[0m15:23:43.911969 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:43.914321 [info ] [MainThread]: 
[0m15:23:44.024515 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m15:23:44.026038 [info ] [Thread-1  ]: 1 of 1 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m15:23:44.028326 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.test_model'
[0m15:23:44.029339 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m15:23:44.049558 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m15:23:44.054569 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m15:23:44.136205 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m15:23:44.153973 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:23:44.154981 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m15:23:44.155983 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:23:46.212820 [debug] [Thread-1  ]: SQL status: BEGIN in 2.057 seconds
[0m15:23:46.213935 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:23:46.215017 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM postgres.public.activity
  );
  
[0m15:23:46.221184 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m15:23:46.232405 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:23:46.232405 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m15:23:46.237254 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:23:46.264846 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m15:23:46.264846 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:23:46.266984 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m15:23:46.274208 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m15:23:46.285803 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m15:23:46.293370 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:23:46.293370 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m15:23:46.296612 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m15:23:46.303165 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m15:23:46.306421 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cd3c6a6-86c7-460b-b59f-1f0c62acc6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC872CF40>]}
[0m15:23:46.307511 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 0[0m in 2.28s]
[0m15:23:46.309131 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m15:23:46.313541 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:46.314095 [debug] [MainThread]: On master: BEGIN
[0m15:23:46.315203 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:48.416322 [debug] [MainThread]: SQL status: BEGIN in 2.101 seconds
[0m15:23:48.416876 [debug] [MainThread]: On master: COMMIT
[0m15:23:48.418015 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:48.418561 [debug] [MainThread]: On master: COMMIT
[0m15:23:48.421300 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:23:48.421887 [debug] [MainThread]: On master: Close
[0m15:23:48.423567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:48.424106 [debug] [MainThread]: Connection 'create_postgres_public_pipedrive_analytics' was properly closed.
[0m15:23:48.424648 [debug] [MainThread]: Connection 'list_postgres_public_pipedrive_analytics' was properly closed.
[0m15:23:48.425186 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m15:23:48.425772 [info ] [MainThread]: 
[0m15:23:48.427477 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.72 seconds (13.72s).
[0m15:23:48.429728 [debug] [MainThread]: Command end result
[0m15:23:48.491832 [info ] [MainThread]: 
[0m15:23:48.493853 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:48.495375 [info ] [MainThread]: 
[0m15:23:48.496024 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:23:48.499574 [debug] [MainThread]: Command `dbt run` succeeded at 15:23:48.499574 after 15.73 seconds
[0m15:23:48.501584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC51CEAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC5145EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC71474F0>]}
[0m15:23:48.502588 [debug] [MainThread]: Flushing usage events
[0m15:34:36.011551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A63999BB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A63C4B9B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A63C4B9940>]}


============================== 15:34:36.029513 | 283527f6-3f48-4e4b-ad68-d6a0111d5e9e ==============================
[0m15:34:36.029513 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:34:36.033851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select test_model', 'send_anonymous_usage_stats': 'True'}
[0m15:34:36.638028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '283527f6-3f48-4e4b-ad68-d6a0111d5e9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A63C4BC640>]}
[0m15:34:36.745580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '283527f6-3f48-4e4b-ad68-d6a0111d5e9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A63A36C1C0>]}
[0m15:34:36.749611 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:34:36.780439 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:34:37.370871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:34:37.372878 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\test_model.sql
[0m15:34:37.781906 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.test_model' (models\test_model.sql) depends on a source named 'postgres.activity' which was not found
[0m15:34:37.785929 [debug] [MainThread]: Command `dbt run` failed at 15:34:37.784932 after 1.90 seconds
[0m15:34:37.786937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A63999BB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A639885AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A63CA8E6D0>]}
[0m15:34:37.786937 [debug] [MainThread]: Flushing usage events
[0m15:35:43.409271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002067704BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002067740DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020679AFAD00>]}


============================== 15:35:43.428092 | dbd4502c-dc8c-4148-bb67-8a614968695e ==============================
[0m15:35:43.428092 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:35:43.430107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select test_model', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:35:43.936734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbd4502c-dc8c-4148-bb67-8a614968695e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020676F596D0>]}
[0m15:35:44.065629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbd4502c-dc8c-4148-bb67-8a614968695e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020677A1D130>]}
[0m15:35:44.069685 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:35:44.094648 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:35:44.591153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:35:44.593162 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\test_model.sql
[0m15:35:45.218776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbd4502c-dc8c-4148-bb67-8a614968695e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002067A296940>]}
[0m15:35:45.598544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbd4502c-dc8c-4148-bb67-8a614968695e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002067A3032B0>]}
[0m15:35:45.599543 [info ] [MainThread]: Found 1 model, 1 source, 423 macros
[0m15:35:45.601529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbd4502c-dc8c-4148-bb67-8a614968695e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002067A0B4CA0>]}
[0m15:35:45.604068 [info ] [MainThread]: 
[0m15:35:45.606061 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:35:45.610587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:35:46.366041 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:35:46.367022 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:35:46.368534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:48.587815 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.219 seconds
[0m15:35:48.591665 [debug] [ThreadPool]: On list_postgres: Close
[0m15:35:48.594602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_integration)
[0m15:35:48.596257 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_integration"
"
[0m15:35:48.610746 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_integration"
[0m15:35:48.611756 [debug] [ThreadPool]: On create_postgres_public_integration: BEGIN
[0m15:35:48.611756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:50.740620 [debug] [ThreadPool]: SQL status: BEGIN in 2.129 seconds
[0m15:35:50.742312 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_integration"
[0m15:35:50.743481 [debug] [ThreadPool]: On create_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_integration"} */
create schema if not exists "public_integration"
[0m15:35:50.767094 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.023 seconds
[0m15:35:50.769622 [debug] [ThreadPool]: On create_postgres_public_integration: COMMIT
[0m15:35:50.770708 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_integration"
[0m15:35:50.771266 [debug] [ThreadPool]: On create_postgres_public_integration: COMMIT
[0m15:35:50.785927 [debug] [ThreadPool]: SQL status: COMMIT in 0.013 seconds
[0m15:35:50.787165 [debug] [ThreadPool]: On create_postgres_public_integration: Close
[0m15:35:50.791044 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_integration'
[0m15:35:50.802625 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m15:35:50.804625 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m15:35:50.804625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:52.893388 [debug] [ThreadPool]: SQL status: BEGIN in 2.088 seconds
[0m15:35:52.894742 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m15:35:52.895303 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m15:35:53.060388 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.164 seconds
[0m15:35:53.063955 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m15:35:53.067828 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m15:35:53.078861 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:53.080484 [debug] [MainThread]: On master: BEGIN
[0m15:35:53.081713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:35:55.168396 [debug] [MainThread]: SQL status: BEGIN in 2.087 seconds
[0m15:35:55.169712 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:55.170836 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:35:55.197293 [debug] [MainThread]: SQL status: SELECT 0 in 0.025 seconds
[0m15:35:55.199504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbd4502c-dc8c-4148-bb67-8a614968695e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002067A655730>]}
[0m15:35:55.200715 [debug] [MainThread]: On master: ROLLBACK
[0m15:35:55.204085 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:55.205173 [debug] [MainThread]: On master: BEGIN
[0m15:35:55.210268 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:35:55.210882 [debug] [MainThread]: On master: COMMIT
[0m15:35:55.211945 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:55.212488 [debug] [MainThread]: On master: COMMIT
[0m15:35:55.214657 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:35:55.216972 [debug] [MainThread]: On master: Close
[0m15:35:55.219176 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:35:55.220829 [info ] [MainThread]: 
[0m15:35:55.246006 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m15:35:55.247533 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.test_model ..................... [RUN]
[0m15:35:55.250083 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.test_model'
[0m15:35:55.251088 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m15:35:55.282540 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m15:35:55.289237 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m15:35:55.429322 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m15:35:55.435534 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:35:55.436535 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m15:35:55.438053 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:35:57.513334 [debug] [Thread-1  ]: SQL status: BEGIN in 2.075 seconds
[0m15:35:57.514451 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:35:57.515589 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_integration"."test_model__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m15:35:57.581122 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.064 seconds
[0m15:35:57.598392 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:35:57.599905 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_integration"."test_model__dbt_tmp" rename to "test_model"
[0m15:35:57.607600 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:35:57.653640 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m15:35:57.655166 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:35:57.656687 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m15:35:57.674604 [debug] [Thread-1  ]: SQL status: COMMIT in 0.016 seconds
[0m15:35:57.688794 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."test_model__dbt_backup"
[0m15:35:57.699378 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:35:57.700389 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_integration"."test_model__dbt_backup" cascade
[0m15:35:57.708266 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m15:35:57.712689 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m15:35:57.716541 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd4502c-dc8c-4148-bb67-8a614968695e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002067A7C2550>]}
[0m15:35:57.718398 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.test_model ................ [[32mSELECT 0[0m in 2.47s]
[0m15:35:57.721525 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m15:35:57.725529 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:57.726594 [debug] [MainThread]: On master: BEGIN
[0m15:35:57.727145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:35:59.801380 [debug] [MainThread]: SQL status: BEGIN in 2.074 seconds
[0m15:35:59.802471 [debug] [MainThread]: On master: COMMIT
[0m15:35:59.803017 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:59.803559 [debug] [MainThread]: On master: COMMIT
[0m15:35:59.806472 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:35:59.807569 [debug] [MainThread]: On master: Close
[0m15:35:59.809215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:59.810325 [debug] [MainThread]: Connection 'create_postgres_public_integration' was properly closed.
[0m15:35:59.810887 [debug] [MainThread]: Connection 'list_postgres_public_integration' was properly closed.
[0m15:35:59.811407 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m15:35:59.812523 [info ] [MainThread]: 
[0m15:35:59.814097 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.21 seconds (14.21s).
[0m15:35:59.816320 [debug] [MainThread]: Command end result
[0m15:35:59.884385 [info ] [MainThread]: 
[0m15:35:59.886447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:35:59.888480 [info ] [MainThread]: 
[0m15:35:59.889475 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:35:59.893485 [debug] [MainThread]: Command `dbt run` succeeded at 15:35:59.892485 after 16.68 seconds
[0m15:35:59.894481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002067704BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002067A1E42B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206775EF370>]}
[0m15:35:59.897044 [debug] [MainThread]: Flushing usage events
[0m15:42:38.517770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6461A7D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F648CBBFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F644FDDD00>]}


============================== 15:42:38.532984 | a5eb7954-c99b-4190-9105-d3a34b8ec725 ==============================
[0m15:42:38.532984 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:42:38.535033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select test_model', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:42:39.010609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5eb7954-c99b-4190-9105-d3a34b8ec725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6460B3DC0>]}
[0m15:42:39.115808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5eb7954-c99b-4190-9105-d3a34b8ec725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F648C47DC0>]}
[0m15:42:39.119823 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:42:39.142075 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:42:39.654560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:39.656091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:39.747589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5eb7954-c99b-4190-9105-d3a34b8ec725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6492549D0>]}
[0m15:42:40.059691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5eb7954-c99b-4190-9105-d3a34b8ec725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F649291B80>]}
[0m15:42:40.060705 [info ] [MainThread]: Found 1 model, 1 source, 423 macros
[0m15:42:40.063715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5eb7954-c99b-4190-9105-d3a34b8ec725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F649265A30>]}
[0m15:42:40.066981 [info ] [MainThread]: 
[0m15:42:40.071081 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:42:40.075638 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:42:40.570408 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:42:40.571921 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:42:40.573469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:42.703327 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.129 seconds
[0m15:42:42.706081 [debug] [ThreadPool]: On list_postgres: Close
[0m15:42:42.708655 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_integration'
[0m15:42:42.723188 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m15:42:42.724353 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m15:42:42.725453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:44.793480 [debug] [ThreadPool]: SQL status: BEGIN in 2.068 seconds
[0m15:42:44.794560 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m15:42:44.795677 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m15:42:44.811179 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m15:42:44.813331 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m15:42:44.816313 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m15:42:44.826188 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:44.827322 [debug] [MainThread]: On master: BEGIN
[0m15:42:44.828603 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:42:46.915012 [debug] [MainThread]: SQL status: BEGIN in 2.086 seconds
[0m15:42:46.916133 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:46.917421 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:42:46.930536 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m15:42:46.933463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5eb7954-c99b-4190-9105-d3a34b8ec725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6497281C0>]}
[0m15:42:46.934014 [debug] [MainThread]: On master: ROLLBACK
[0m15:42:46.937795 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:46.938870 [debug] [MainThread]: On master: BEGIN
[0m15:42:46.944467 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:42:46.945555 [debug] [MainThread]: On master: COMMIT
[0m15:42:46.946698 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:46.947984 [debug] [MainThread]: On master: COMMIT
[0m15:42:46.952607 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m15:42:46.953803 [debug] [MainThread]: On master: Close
[0m15:42:46.955947 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:42:46.958036 [info ] [MainThread]: 
[0m15:42:46.975454 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m15:42:46.976474 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.test_model ..................... [RUN]
[0m15:42:46.979466 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.test_model'
[0m15:42:46.980975 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m15:42:46.998422 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m15:42:47.001935 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m15:42:47.115587 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m15:42:47.118096 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:42:47.119112 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m15:42:47.120111 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:42:49.197540 [debug] [Thread-1  ]: SQL status: BEGIN in 2.077 seconds
[0m15:42:49.198643 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:42:49.200309 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_integration"."test_model__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m15:42:49.229607 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.028 seconds
[0m15:42:49.244140 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:42:49.246156 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_integration"."test_model" rename to "test_model__dbt_backup"
[0m15:42:49.253389 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:42:49.263061 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:42:49.264742 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_integration"."test_model__dbt_tmp" rename to "test_model"
[0m15:42:49.268756 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:42:49.320076 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m15:42:49.321089 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:42:49.323092 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m15:42:49.330736 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m15:42:49.344337 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."test_model__dbt_backup"
[0m15:42:49.353159 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:42:49.354156 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_integration"."test_model__dbt_backup" cascade
[0m15:42:49.377671 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.022 seconds
[0m15:42:49.384180 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m15:42:49.388688 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5eb7954-c99b-4190-9105-d3a34b8ec725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6496E5880>]}
[0m15:42:49.390230 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.test_model ................ [[32mSELECT 0[0m in 2.41s]
[0m15:42:49.391746 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m15:42:49.397635 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:49.398747 [debug] [MainThread]: On master: BEGIN
[0m15:42:49.399843 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:42:51.487042 [debug] [MainThread]: SQL status: BEGIN in 2.087 seconds
[0m15:42:51.488122 [debug] [MainThread]: On master: COMMIT
[0m15:42:51.488667 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:51.489760 [debug] [MainThread]: On master: COMMIT
[0m15:42:51.491953 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:42:51.493056 [debug] [MainThread]: On master: Close
[0m15:42:51.494097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:51.495384 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:42:51.495965 [debug] [MainThread]: Connection 'list_postgres_public_integration' was properly closed.
[0m15:42:51.497052 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m15:42:51.497603 [info ] [MainThread]: 
[0m15:42:51.498615 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.43 seconds (11.43s).
[0m15:42:51.501613 [debug] [MainThread]: Command end result
[0m15:42:51.567790 [info ] [MainThread]: 
[0m15:42:51.570319 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:51.571316 [info ] [MainThread]: 
[0m15:42:51.573335 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:42:51.575322 [debug] [MainThread]: Command `dbt run` succeeded at 15:42:51.575322 after 13.18 seconds
[0m15:42:51.577506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6461A7D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F648118670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F64909C040>]}
[0m15:42:51.578517 [debug] [MainThread]: Flushing usage events
[0m15:44:53.936545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD681BA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD9327760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD9327A30>]}


============================== 15:44:53.954296 | 6d229d3c-7737-4ded-82b5-14af7d410269 ==============================
[0m15:44:53.954296 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:44:53.956825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select test_model', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:44:54.421233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d229d3c-7737-4ded-82b5-14af7d410269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD6C57220>]}
[0m15:44:54.556451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d229d3c-7737-4ded-82b5-14af7d410269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD71DC1C0>]}
[0m15:44:54.560483 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:44:54.589579 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:44:54.854074 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:44:54.856087 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:44:54.857091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d229d3c-7737-4ded-82b5-14af7d410269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD878F430>]}
[0m15:44:57.759454 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m15:44:57.797513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d229d3c-7737-4ded-82b5-14af7d410269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD66FE190>]}
[0m15:44:58.142936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d229d3c-7737-4ded-82b5-14af7d410269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD9A61FA0>]}
[0m15:44:58.144454 [info ] [MainThread]: Found 1 model, 1 source, 423 macros
[0m15:44:58.146465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d229d3c-7737-4ded-82b5-14af7d410269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD99E1D00>]}
[0m15:44:58.150006 [info ] [MainThread]: 
[0m15:44:58.153017 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:44:58.158043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_POSTGRES'
[0m15:44:58.725638 [debug] [ThreadPool]: Using postgres connection "list_POSTGRES"
[0m15:44:58.727635 [debug] [ThreadPool]: On list_POSTGRES: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_POSTGRES"} */

    select distinct nspname from pg_namespace
  
[0m15:44:58.727635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:00.830453 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  database "POSTGRES" does not exist

[0m15:45:02.898840 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_POSTGRES"} */

    select distinct nspname from pg_namespace
  
[0m15:45:02.900009 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:45:02.901162 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m15:45:02.902177 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:45:02.903401 [debug] [ThreadPool]: On list_POSTGRES: No close available on handle
[0m15:45:02.905689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:02.906241 [debug] [MainThread]: Connection 'list_POSTGRES' was properly closed.
[0m15:45:02.906780 [info ] [MainThread]: 
[0m15:45:02.908439 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m15:45:02.910148 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  database "POSTGRES" does not exist
  
[0m15:45:02.913997 [debug] [MainThread]: Command `dbt run` failed at 15:45:02.913997 after 9.21 seconds
[0m15:45:02.915556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD681BA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD9A2E070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD9A612E0>]}
[0m15:45:02.916558 [debug] [MainThread]: Flushing usage events
[0m15:45:55.392169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68C387D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68EE9EF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68B1BED00>]}


============================== 15:45:55.405962 | 40fe0e2c-c2db-4884-9869-763173be4a71 ==============================
[0m15:45:55.405962 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:45:55.407984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select test_model', 'send_anonymous_usage_stats': 'True'}
[0m15:45:56.094059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40fe0e2c-c2db-4884-9869-763173be4a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68C2FEFD0>]}
[0m15:45:56.283124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40fe0e2c-c2db-4884-9869-763173be4a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68EE2E0A0>]}
[0m15:45:56.288654 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:45:56.329756 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:45:56.787191 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:45:56.795834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '40fe0e2c-c2db-4884-9869-763173be4a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68E2FF490>]}
[0m15:46:00.860250 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m15:46:00.899259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40fe0e2c-c2db-4884-9869-763173be4a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68C30DE80>]}
[0m15:46:01.269899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40fe0e2c-c2db-4884-9869-763173be4a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68F5D15E0>]}
[0m15:46:01.271918 [info ] [MainThread]: Found 1 model, 1 source, 423 macros
[0m15:46:01.272933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40fe0e2c-c2db-4884-9869-763173be4a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68F601FD0>]}
[0m15:46:01.276681 [info ] [MainThread]: 
[0m15:46:01.278692 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:46:01.283756 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:46:01.814934 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:46:01.817475 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:46:01.818486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:03.929621 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.111 seconds
[0m15:46:03.934085 [debug] [ThreadPool]: On list_postgres: Close
[0m15:46:03.939495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m15:46:03.954469 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:46:03.955970 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m15:46:03.956989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:06.023498 [debug] [ThreadPool]: SQL status: BEGIN in 2.066 seconds
[0m15:46:06.024616 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:46:06.025719 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m15:46:06.038888 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m15:46:06.041641 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m15:46:06.044404 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m15:46:06.056064 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:06.057575 [debug] [MainThread]: On master: BEGIN
[0m15:46:06.058592 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:46:08.144391 [debug] [MainThread]: SQL status: BEGIN in 2.086 seconds
[0m15:46:08.144947 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:08.146067 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:46:08.156044 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m15:46:08.158721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40fe0e2c-c2db-4884-9869-763173be4a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68F96D9D0>]}
[0m15:46:08.160351 [debug] [MainThread]: On master: ROLLBACK
[0m15:46:08.163823 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:08.164908 [debug] [MainThread]: On master: BEGIN
[0m15:46:08.170577 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:46:08.171683 [debug] [MainThread]: On master: COMMIT
[0m15:46:08.172258 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:08.172797 [debug] [MainThread]: On master: COMMIT
[0m15:46:08.175445 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:46:08.176612 [debug] [MainThread]: On master: Close
[0m15:46:08.177716 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:46:08.179379 [info ] [MainThread]: 
[0m15:46:08.198699 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m15:46:08.200225 [info ] [Thread-1  ]: 1 of 1 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m15:46:08.201742 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.test_model'
[0m15:46:08.203745 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m15:46:08.224075 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m15:46:08.228116 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m15:46:08.341890 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m15:46:08.346961 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:46:08.347969 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m15:46:08.348961 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:46:10.445156 [debug] [Thread-1  ]: SQL status: BEGIN in 2.096 seconds
[0m15:46:10.446265 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:46:10.447427 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m15:46:10.462508 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.014 seconds
[0m15:46:10.484801 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:46:10.485808 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m15:46:10.492427 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.005 seconds
[0m15:46:10.499992 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:46:10.501161 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m15:46:10.505780 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:46:10.549267 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m15:46:10.551794 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:46:10.553319 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m15:46:10.561173 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m15:46:10.577499 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m15:46:10.591272 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:46:10.592292 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m15:46:10.610948 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.017 seconds
[0m15:46:10.615356 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m15:46:10.619694 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40fe0e2c-c2db-4884-9869-763173be4a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68FA25970>]}
[0m15:46:10.621945 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 0[0m in 2.42s]
[0m15:46:10.624546 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m15:46:10.627669 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:10.628805 [debug] [MainThread]: On master: BEGIN
[0m15:46:10.629363 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:46:12.715072 [debug] [MainThread]: SQL status: BEGIN in 2.086 seconds
[0m15:46:12.716503 [debug] [MainThread]: On master: COMMIT
[0m15:46:12.718145 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:12.719321 [debug] [MainThread]: On master: COMMIT
[0m15:46:12.723200 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:46:12.724290 [debug] [MainThread]: On master: Close
[0m15:46:12.725981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:12.726994 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:46:12.728500 [debug] [MainThread]: Connection 'list_postgres_public_pipedrive_analytics' was properly closed.
[0m15:46:12.728500 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m15:46:12.730512 [info ] [MainThread]: 
[0m15:46:12.731511 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.45 seconds (11.45s).
[0m15:46:12.734404 [debug] [MainThread]: Command end result
[0m15:46:12.804029 [info ] [MainThread]: 
[0m15:46:12.805550 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:46:12.806564 [info ] [MainThread]: 
[0m15:46:12.808560 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:46:12.811197 [debug] [MainThread]: Command `dbt run` succeeded at 15:46:12.810201 after 17.58 seconds
[0m15:46:12.812195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68C387D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68F4E3EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68C90B280>]}
[0m15:46:12.813204 [debug] [MainThread]: Flushing usage events
[0m15:52:02.084832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023490F4AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023493A4BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023493A4BCD0>]}


============================== 15:52:02.100030 | 2a85121e-2121-4588-a8c8-f94a14a2d222 ==============================
[0m15:52:02.100030 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:52:02.102030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:52:02.636542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a85121e-2121-4588-a8c8-f94a14a2d222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023490E098B0>]}
[0m15:52:02.747924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a85121e-2121-4588-a8c8-f94a14a2d222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002349190C1C0>]}
[0m15:52:02.751440 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:52:02.776553 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:52:03.418914 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m15:52:03.419923 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models\test_model.sql
[0m15:52:03.494489 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.enpal_assessment_project
- models.integration
[0m15:52:03.508117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a85121e-2121-4588-a8c8-f94a14a2d222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023493FC5040>]}
[0m15:52:03.743340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a85121e-2121-4588-a8c8-f94a14a2d222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002349407D2E0>]}
[0m15:52:03.744356 [info ] [MainThread]: Found 423 macros
[0m15:52:03.746365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a85121e-2121-4588-a8c8-f94a14a2d222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023493FC5F40>]}
[0m15:52:03.748371 [info ] [MainThread]: 
[0m15:52:03.750395 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:52:03.755468 [debug] [MainThread]: Command end result
[0m15:52:03.826470 [debug] [MainThread]: Command `dbt run` succeeded at 15:52:03.826470 after 1.85 seconds
[0m15:52:03.827487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023490F4AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023494030340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234914E5640>]}
[0m15:52:03.829491 [debug] [MainThread]: Flushing usage events
[0m15:52:34.842829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165AB6BAB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165AE1D3B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165AE1D3910>]}


============================== 15:52:34.857145 | a8854a6d-d43b-4008-9338-7e8750d9732a ==============================
[0m15:52:34.857145 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:52:34.858656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select test_model', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:52:35.334324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8854a6d-d43b-4008-9338-7e8750d9732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165ABB113A0>]}
[0m15:52:35.455515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8854a6d-d43b-4008-9338-7e8750d9732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165AC08E1C0>]}
[0m15:52:35.458515 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:52:35.486477 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:52:36.126982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:52:36.126982 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:52:36.127977 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.integration
- models.enpal_assessment_project
[0m15:52:36.148298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8854a6d-d43b-4008-9338-7e8750d9732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165AE747F40>]}
[0m15:52:36.407555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8854a6d-d43b-4008-9338-7e8750d9732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165AE7AACA0>]}
[0m15:52:36.408564 [info ] [MainThread]: Found 423 macros
[0m15:52:36.410279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8854a6d-d43b-4008-9338-7e8750d9732a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165AE747CA0>]}
[0m15:52:36.410816 [warn ] [MainThread]: The selection criterion 'test_model' does not match any enabled nodes
[0m15:52:36.414372 [info ] [MainThread]: 
[0m15:52:36.415375 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:52:36.421437 [debug] [MainThread]: Command end result
[0m15:52:36.495024 [debug] [MainThread]: Command `dbt run` succeeded at 15:52:36.494026 after 1.78 seconds
[0m15:52:36.496030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165AB6BAB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165AE747910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165ABC64670>]}
[0m15:52:36.497040 [debug] [MainThread]: Flushing usage events
[0m15:53:48.978687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714F66EB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027151FBCA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027151FBCA90>]}


============================== 15:53:48.992569 | c0058f21-5595-4137-8be5-9f1f7dfaa36e ==============================
[0m15:53:48.992569 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:53:48.994576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ls', 'send_anonymous_usage_stats': 'True'}
[0m15:53:49.405209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0058f21-5595-4137-8be5-9f1f7dfaa36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714FAC13A0>]}
[0m15:53:49.542016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0058f21-5595-4137-8be5-9f1f7dfaa36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271515C6070>]}
[0m15:53:49.546597 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:53:49.569789 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:53:49.888330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:53:49.888330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:53:49.890864 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.integration
- models.enpal_assessment_project
[0m15:53:49.902443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0058f21-5595-4137-8be5-9f1f7dfaa36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271526F1E80>]}
[0m15:53:50.126663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0058f21-5595-4137-8be5-9f1f7dfaa36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027152745BB0>]}
[0m15:53:50.127665 [info ] [MainThread]: Found 423 macros
[0m15:53:50.129660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0058f21-5595-4137-8be5-9f1f7dfaa36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271527044F0>]}
[0m15:53:50.130675 [warn ] [MainThread]: No nodes selected!
[0m15:53:50.134227 [debug] [MainThread]: Command `dbt ls` succeeded at 15:53:50.132697 after 1.26 seconds
[0m15:53:50.135242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714F66EB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271521563A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271526DE6A0>]}
[0m15:53:50.136240 [debug] [MainThread]: Flushing usage events
[0m15:54:37.580503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C9FA4AD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA256CF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C9E82CD00>]}


============================== 15:54:37.598844 | 3921dc5f-0d3b-40d0-bcd5-8e712e552f00 ==============================
[0m15:54:37.598844 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:54:37.600863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select test_model', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:54:38.057817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3921dc5f-0d3b-40d0-bcd5-8e712e552f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C9F9BDFD0>]}
[0m15:54:38.235737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3921dc5f-0d3b-40d0-bcd5-8e712e552f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA25BE0A0>]}
[0m15:54:38.240329 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:54:38.270422 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:54:38.587728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:54:38.589242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:54:38.589242 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.integration
- models.enpal_assessment_project
[0m15:54:38.604381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3921dc5f-0d3b-40d0-bcd5-8e712e552f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA2AD4940>]}
[0m15:54:38.827027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3921dc5f-0d3b-40d0-bcd5-8e712e552f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA2B37D30>]}
[0m15:54:38.829050 [info ] [MainThread]: Found 423 macros
[0m15:54:38.830042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3921dc5f-0d3b-40d0-bcd5-8e712e552f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA2AD4C70>]}
[0m15:54:38.832054 [warn ] [MainThread]: The selection criterion 'test_model' does not match any enabled nodes
[0m15:54:38.834597 [info ] [MainThread]: 
[0m15:54:38.836606 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:54:38.840662 [debug] [MainThread]: Command end result
[0m15:54:38.920384 [debug] [MainThread]: Command `dbt run` succeeded at 15:54:38.918874 after 1.47 seconds
[0m15:54:38.920384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C9FA4AD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA19CF5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C9FFF2280>]}
[0m15:54:38.921940 [debug] [MainThread]: Flushing usage events
[0m15:55:31.824814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DAEB5B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DD9C3B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DD9C3940>]}


============================== 15:55:31.841910 | e5e5dc85-8eeb-48d2-af0a-c18e5e8f8b50 ==============================
[0m15:55:31.841910 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:55:31.843921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select test_model', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:55:32.289065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5e5dc85-8eeb-48d2-af0a-c18e5e8f8b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DB2843A0>]}
[0m15:55:32.413672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5e5dc85-8eeb-48d2-af0a-c18e5e8f8b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DB87E1C0>]}
[0m15:55:32.415670 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:55:32.442935 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:55:32.753185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:55:32.754191 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:55:32.756183 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.enpal_assessment_project
- models.integration
[0m15:55:32.767440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5e5dc85-8eeb-48d2-af0a-c18e5e8f8b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DDF36F40>]}
[0m15:55:32.995680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5e5dc85-8eeb-48d2-af0a-c18e5e8f8b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DDF99CA0>]}
[0m15:55:32.996676 [info ] [MainThread]: Found 423 macros
[0m15:55:32.997677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5e5dc85-8eeb-48d2-af0a-c18e5e8f8b50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DDF36CD0>]}
[0m15:55:32.998679 [warn ] [MainThread]: The selection criterion 'test_model' does not match any enabled nodes
[0m15:55:33.000673 [info ] [MainThread]: 
[0m15:55:33.002180 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:55:33.007221 [debug] [MainThread]: Command end result
[0m15:55:33.074944 [debug] [MainThread]: Command `dbt run` succeeded at 15:55:33.074944 after 1.36 seconds
[0m15:55:33.075945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DAEB5B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DDF36970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267DB45F670>]}
[0m15:55:33.078483 [debug] [MainThread]: Flushing usage events
[0m15:57:10.763396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94D15AB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94FC73B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94FC73910>]}


============================== 15:57:10.780668 | 4a0e9dbd-2105-4788-8c1b-0ea33adeded1 ==============================
[0m15:57:10.780668 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:57:10.783673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select test_model', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:57:11.226896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a0e9dbd-2105-4788-8c1b-0ea33adeded1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94D5B13A0>]}
[0m15:57:11.366322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a0e9dbd-2105-4788-8c1b-0ea33adeded1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94DB2C1C0>]}
[0m15:57:11.370840 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:57:11.398442 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:57:11.812257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:57:11.814272 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\sources.yml
[0m15:57:11.814272 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\test_model.sql
[0m15:57:12.571606 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m15:57:12.597041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a0e9dbd-2105-4788-8c1b-0ea33adeded1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9504A29A0>]}
[0m15:57:12.938186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a0e9dbd-2105-4788-8c1b-0ea33adeded1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B950517430>]}
[0m15:57:12.939189 [info ] [MainThread]: Found 1 model, 1 source, 423 macros
[0m15:57:12.940183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a0e9dbd-2105-4788-8c1b-0ea33adeded1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B950494220>]}
[0m15:57:12.943235 [info ] [MainThread]: 
[0m15:57:12.945249 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:57:12.950787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:57:13.510193 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:57:13.511192 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:57:13.511192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:15.655021 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.144 seconds
[0m15:57:15.658872 [debug] [ThreadPool]: On list_postgres: Close
[0m15:57:15.663334 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_integration'
[0m15:57:15.680415 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m15:57:15.681422 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m15:57:15.682413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:17.763798 [debug] [ThreadPool]: SQL status: BEGIN in 2.081 seconds
[0m15:57:17.764820 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m15:57:17.765330 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m15:57:17.778659 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m15:57:17.781348 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m15:57:17.785407 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m15:57:17.795163 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:17.796289 [debug] [MainThread]: On master: BEGIN
[0m15:57:17.796827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:19.880717 [debug] [MainThread]: SQL status: BEGIN in 2.083 seconds
[0m15:57:19.881866 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:19.882415 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:57:19.897417 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m15:57:19.900775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a0e9dbd-2105-4788-8c1b-0ea33adeded1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B950954BB0>]}
[0m15:57:19.901865 [debug] [MainThread]: On master: ROLLBACK
[0m15:57:19.905423 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:19.907173 [debug] [MainThread]: On master: BEGIN
[0m15:57:19.913056 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:57:19.914180 [debug] [MainThread]: On master: COMMIT
[0m15:57:19.914732 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:19.916261 [debug] [MainThread]: On master: COMMIT
[0m15:57:19.920430 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m15:57:19.922035 [debug] [MainThread]: On master: Close
[0m15:57:19.923874 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:19.925539 [info ] [MainThread]: 
[0m15:57:19.948994 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m15:57:19.951514 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.test_model ..................... [RUN]
[0m15:57:19.953540 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.test_model'
[0m15:57:19.954539 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m15:57:19.972409 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m15:57:19.975453 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m15:57:20.082512 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m15:57:20.086041 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:57:20.087041 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m15:57:20.088036 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:57:22.158791 [debug] [Thread-1  ]: SQL status: BEGIN in 2.071 seconds
[0m15:57:22.159936 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:57:22.160488 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_integration"."test_model__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m15:57:22.179388 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.017 seconds
[0m15:57:22.189474 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:57:22.191490 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_integration"."test_model" rename to "test_model__dbt_backup"
[0m15:57:22.197367 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.005 seconds
[0m15:57:22.203453 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:57:22.204550 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_integration"."test_model__dbt_tmp" rename to "test_model"
[0m15:57:22.208442 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:57:22.245616 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m15:57:22.246633 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:57:22.248625 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m15:57:22.257667 [debug] [Thread-1  ]: SQL status: COMMIT in 0.008 seconds
[0m15:57:22.272941 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."test_model__dbt_backup"
[0m15:57:22.285055 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m15:57:22.286065 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_integration"."test_model__dbt_backup" cascade
[0m15:57:22.312862 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.025 seconds
[0m15:57:22.321753 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m15:57:22.326004 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a0e9dbd-2105-4788-8c1b-0ea33adeded1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B95092FB50>]}
[0m15:57:22.328988 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.test_model ................ [[32mSELECT 0[0m in 2.37s]
[0m15:57:22.332076 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m15:57:22.338002 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:22.340698 [debug] [MainThread]: On master: BEGIN
[0m15:57:22.344267 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:24.450644 [debug] [MainThread]: SQL status: BEGIN in 2.106 seconds
[0m15:57:24.451798 [debug] [MainThread]: On master: COMMIT
[0m15:57:24.452915 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:24.454046 [debug] [MainThread]: On master: COMMIT
[0m15:57:24.457387 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:57:24.458509 [debug] [MainThread]: On master: Close
[0m15:57:24.460765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:24.461941 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:57:24.461941 [debug] [MainThread]: Connection 'list_postgres_public_integration' was properly closed.
[0m15:57:24.464506 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m15:57:24.465500 [info ] [MainThread]: 
[0m15:57:24.467015 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.52 seconds (11.52s).
[0m15:57:24.470066 [debug] [MainThread]: Command end result
[0m15:57:24.685209 [info ] [MainThread]: 
[0m15:57:24.686205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:24.687722 [info ] [MainThread]: 
[0m15:57:24.689755 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:57:24.692361 [debug] [MainThread]: Command `dbt run` succeeded at 15:57:24.691350 after 14.03 seconds
[0m15:57:24.693362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94D15AB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94F051970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9504A2BE0>]}
[0m15:57:24.694381 [debug] [MainThread]: Flushing usage events
[0m16:01:11.566768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A00A18AAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A00CCA7AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A00CCA7850>]}


============================== 16:01:11.589514 | 473942cd-91d3-49c4-ac50-a00f893c0775 ==============================
[0m16:01:11.589514 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:01:11.592021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select test_model', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:01:12.107129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '473942cd-91d3-49c4-ac50-a00f893c0775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A00A61A310>]}
[0m16:01:12.247332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '473942cd-91d3-49c4-ac50-a00f893c0775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A00AB5E160>]}
[0m16:01:12.251858 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:01:12.279363 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:01:12.949103 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m16:01:12.951105 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\enpal_assessment_project\test_model.sql
[0m16:01:12.952115 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\enpal_assessment_project\sources.yml
[0m16:01:12.953116 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models\test_model.sql
[0m16:01:13.658889 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m16:01:13.682818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '473942cd-91d3-49c4-ac50-a00f893c0775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A00D4B0EB0>]}
[0m16:01:13.993424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '473942cd-91d3-49c4-ac50-a00f893c0775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A00D5479D0>]}
[0m16:01:13.995429 [info ] [MainThread]: Found 1 model, 1 source, 423 macros
[0m16:01:13.996945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '473942cd-91d3-49c4-ac50-a00f893c0775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A00D4A4880>]}
[0m16:01:13.999955 [info ] [MainThread]: 
[0m16:01:14.002471 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:01:14.007504 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:01:14.694892 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:01:14.696894 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:01:14.698909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:16.863867 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.165 seconds
[0m16:01:16.867096 [debug] [ThreadPool]: On list_postgres: Close
[0m16:01:16.871018 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m16:01:16.888034 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:01:16.889634 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m16:01:16.891153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:18.976389 [debug] [ThreadPool]: SQL status: BEGIN in 2.085 seconds
[0m16:01:18.977507 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:01:18.978631 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m16:01:19.000686 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.021 seconds
[0m16:01:19.003096 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m16:01:19.006576 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m16:01:19.019014 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:19.020205 [debug] [MainThread]: On master: BEGIN
[0m16:01:19.021311 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:01:21.113161 [debug] [MainThread]: SQL status: BEGIN in 2.092 seconds
[0m16:01:21.113730 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:21.114845 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:01:21.136144 [debug] [MainThread]: SQL status: SELECT 0 in 0.020 seconds
[0m16:01:21.139010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '473942cd-91d3-49c4-ac50-a00f893c0775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A00D8EE490>]}
[0m16:01:21.140107 [debug] [MainThread]: On master: ROLLBACK
[0m16:01:21.142986 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:21.144079 [debug] [MainThread]: On master: BEGIN
[0m16:01:21.151287 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:01:21.151830 [debug] [MainThread]: On master: COMMIT
[0m16:01:21.153526 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:21.154060 [debug] [MainThread]: On master: COMMIT
[0m16:01:21.157975 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:01:21.159071 [debug] [MainThread]: On master: Close
[0m16:01:21.160174 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:01:21.161837 [info ] [MainThread]: 
[0m16:01:21.183943 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.test_model
[0m16:01:21.184939 [info ] [Thread-1  ]: 1 of 1 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m16:01:21.190050 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.test_model'
[0m16:01:21.192052 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.test_model
[0m16:01:21.212444 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m16:01:21.216448 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.test_model
[0m16:01:21.323642 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m16:01:21.328199 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m16:01:21.329191 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: BEGIN
[0m16:01:21.330187 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:01:23.428006 [debug] [Thread-1  ]: SQL status: BEGIN in 2.098 seconds
[0m16:01:23.429119 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m16:01:23.430206 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m16:01:23.453173 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.023 seconds
[0m16:01:23.466757 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m16:01:23.466757 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m16:01:23.474911 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.006 seconds
[0m16:01:23.481436 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m16:01:23.481998 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m16:01:23.485738 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:01:23.519767 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m16:01:23.520767 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m16:01:23.522285 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: COMMIT
[0m16:01:23.531964 [debug] [Thread-1  ]: SQL status: COMMIT in 0.008 seconds
[0m16:01:23.542827 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m16:01:23.550897 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m16:01:23.551901 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m16:01:23.577008 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.024 seconds
[0m16:01:23.582381 [debug] [Thread-1  ]: On model.enpal_assessment_project.test_model: Close
[0m16:01:23.587047 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '473942cd-91d3-49c4-ac50-a00f893c0775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A00D94B430>]}
[0m16:01:23.588922 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 0[0m in 2.40s]
[0m16:01:23.591435 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.test_model
[0m16:01:23.594684 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:23.595263 [debug] [MainThread]: On master: BEGIN
[0m16:01:23.596382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:01:25.683368 [debug] [MainThread]: SQL status: BEGIN in 2.087 seconds
[0m16:01:25.683910 [debug] [MainThread]: On master: COMMIT
[0m16:01:25.684466 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:25.685002 [debug] [MainThread]: On master: COMMIT
[0m16:01:25.688450 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:01:25.689540 [debug] [MainThread]: On master: Close
[0m16:01:25.690657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:25.691752 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:01:25.692347 [debug] [MainThread]: Connection 'list_postgres_public_pipedrive_analytics' was properly closed.
[0m16:01:25.692901 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m16:01:25.693461 [info ] [MainThread]: 
[0m16:01:25.695115 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.69 seconds (11.69s).
[0m16:01:25.697338 [debug] [MainThread]: Command end result
[0m16:01:25.884824 [info ] [MainThread]: 
[0m16:01:25.885819 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:25.890049 [info ] [MainThread]: 
[0m16:01:25.891613 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:01:25.894624 [debug] [MainThread]: Command `dbt run` succeeded at 16:01:25.894624 after 14.47 seconds
[0m16:01:25.895976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A00A18AAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A00CD72130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A00D23F040>]}
[0m16:01:25.897997 [debug] [MainThread]: Flushing usage events
[0m16:08:00.455053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B01A93AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B01D447760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B01D447A30>]}


============================== 16:08:00.469638 | e2763c02-bafe-4548-ba98-25cd94f7aa76 ==============================
[0m16:08:00.469638 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:08:00.470642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select intg_activity', 'send_anonymous_usage_stats': 'True'}
[0m16:08:00.963749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2763c02-bafe-4548-ba98-25cd94f7aa76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B01ADB9220>]}
[0m16:08:01.088503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2763c02-bafe-4548-ba98-25cd94f7aa76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B01B2FE1C0>]}
[0m16:08:01.092024 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:08:01.119533 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:08:01.728009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:08:01.729016 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\integration\schema.yml
[0m16:08:01.731012 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\integration\intg_activity.sql
[0m16:08:02.288945 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "postgres_public_activity".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("postgres_public", "activity").
  
  To fix this, change the name of one of these resources:
  - source.enpal_assessment_project.postgres_public.activity (models\integration\schema.yml)
  - source.enpal_assessment_project.postgres_public.activity (models\enpal_assessment_project\sources.yml)
[0m16:08:02.301064 [debug] [MainThread]: Command `dbt run` failed at 16:08:02.300043 after 1.95 seconds
[0m16:08:02.302579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B01A93AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B01B2299D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B01DA5CE80>]}
[0m16:08:02.303590 [debug] [MainThread]: Flushing usage events
[0m16:09:58.130713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A56BBBAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A596C7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A596C70D0>]}


============================== 16:09:58.152818 | 289d66c8-79b3-4c26-a09d-3be66e69615b ==============================
[0m16:09:58.152818 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:09:58.155405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select intg_activity', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:09:58.845297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '289d66c8-79b3-4c26-a09d-3be66e69615b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A570380D0>]}
[0m16:09:59.057071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '289d66c8-79b3-4c26-a09d-3be66e69615b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A59248D90>]}
[0m16:09:59.061616 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:09:59.098621 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:09:59.768286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:09:59.770305 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\integration\schema.yml
[0m16:09:59.771303 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\integration\intg_activity.sql
[0m16:10:00.513930 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "postgres_public_activity".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("postgres_public", "activity").
  
  To fix this, change the name of one of these resources:
  - source.enpal_assessment_project.postgres_public.activity (models\integration\schema.yml)
  - source.enpal_assessment_project.postgres_public.activity (models\enpal_assessment_project\sources.yml)
[0m16:10:00.516922 [debug] [MainThread]: Command `dbt run` failed at 16:10:00.516922 after 2.56 seconds
[0m16:10:00.518443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A56BBBAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A574B39A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A59CD90D0>]}
[0m16:10:00.520464 [debug] [MainThread]: Flushing usage events
[0m16:11:04.471771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115A22ABB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115A671D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115CCD3D00>]}


============================== 16:11:04.486856 | b64710fa-d804-477c-ac42-87c228188b56 ==============================
[0m16:11:04.486856 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:11:04.489380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select intg_activity', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:11:05.293497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b64710fa-d804-477c-ac42-87c228188b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115A6C13D0>]}
[0m16:11:05.435805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b64710fa-d804-477c-ac42-87c228188b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115ABFD130>]}
[0m16:11:05.439807 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:11:05.459454 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:11:06.025329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:11:06.027853 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\integration\intg_activity.sql
[0m16:11:06.029873 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\integration\schema.yml
[0m16:11:07.505647 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m16:11:07.556053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b64710fa-d804-477c-ac42-87c228188b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115D54EA00>]}
[0m16:11:08.140099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b64710fa-d804-477c-ac42-87c228188b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115D5E2130>]}
[0m16:11:08.146136 [info ] [MainThread]: Found 2 models, 2 sources, 423 macros
[0m16:11:08.149168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b64710fa-d804-477c-ac42-87c228188b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115D5F24F0>]}
[0m16:11:08.152705 [info ] [MainThread]: 
[0m16:11:08.161321 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:11:08.168359 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:11:09.092322 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:11:09.094329 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:11:09.095838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:11.309201 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.213 seconds
[0m16:11:11.312001 [debug] [ThreadPool]: On list_postgres: Close
[0m16:11:11.315356 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_integration'
[0m16:11:11.331882 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m16:11:11.332471 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m16:11:11.333482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:13.407791 [debug] [ThreadPool]: SQL status: BEGIN in 2.074 seconds
[0m16:11:13.408864 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m16:11:13.409398 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m16:11:13.436231 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.026 seconds
[0m16:11:13.438416 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m16:11:13.442266 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m16:11:13.443946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_integration, now list_postgres_public_pipedrive_analytics)
[0m16:11:13.450494 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:11:13.451614 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m16:11:13.452137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:15.525684 [debug] [ThreadPool]: SQL status: BEGIN in 2.074 seconds
[0m16:11:15.526834 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:11:15.527394 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m16:11:15.535048 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m16:11:15.536693 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m16:11:15.540733 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m16:11:15.552419 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:15.553493 [debug] [MainThread]: On master: BEGIN
[0m16:11:15.554631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:17.643701 [debug] [MainThread]: SQL status: BEGIN in 2.089 seconds
[0m16:11:17.644770 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:17.645363 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:11:17.666525 [debug] [MainThread]: SQL status: SELECT 0 in 0.020 seconds
[0m16:11:17.668584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b64710fa-d804-477c-ac42-87c228188b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115D99FBE0>]}
[0m16:11:17.669680 [debug] [MainThread]: On master: ROLLBACK
[0m16:11:17.673059 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:17.674185 [debug] [MainThread]: On master: BEGIN
[0m16:11:17.678847 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:11:17.679954 [debug] [MainThread]: On master: COMMIT
[0m16:11:17.680507 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:17.681065 [debug] [MainThread]: On master: COMMIT
[0m16:11:17.683903 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:11:17.685080 [debug] [MainThread]: On master: Close
[0m16:11:17.686180 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:17.687817 [info ] [MainThread]: 
[0m16:11:17.710705 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.intg_activity
[0m16:11:17.712711 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.intg_activity .................. [RUN]
[0m16:11:17.714710 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.intg_activity'
[0m16:11:17.716714 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.intg_activity
[0m16:11:17.738495 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.intg_activity"
[0m16:11:17.746254 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.intg_activity
[0m16:11:17.857387 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.intg_activity"
[0m16:11:17.862463 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity"
[0m16:11:17.863984 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: BEGIN
[0m16:11:17.865001 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:11:19.945057 [debug] [Thread-1  ]: SQL status: BEGIN in 2.080 seconds
[0m16:11:19.946141 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity"
[0m16:11:19.947258 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity"} */

  
    

  create  table "postgres"."public_integration"."intg_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m16:11:19.986055 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.038 seconds
[0m16:11:20.002186 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity"
[0m16:11:20.003198 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity"} */
alter table "postgres"."public_integration"."intg_activity__dbt_tmp" rename to "intg_activity"
[0m16:11:20.010456 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.005 seconds
[0m16:11:20.044040 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: COMMIT
[0m16:11:20.045051 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity"
[0m16:11:20.046055 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: COMMIT
[0m16:11:20.052799 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m16:11:20.065020 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."intg_activity__dbt_backup"
[0m16:11:20.073566 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity"
[0m16:11:20.075083 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity"} */
drop table if exists "postgres"."public_integration"."intg_activity__dbt_backup" cascade
[0m16:11:20.081936 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m16:11:20.085853 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: Close
[0m16:11:20.089804 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b64710fa-d804-477c-ac42-87c228188b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115D5E2370>]}
[0m16:11:20.090934 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.intg_activity ............. [[32mSELECT 0[0m in 2.37s]
[0m16:11:20.092596 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.intg_activity
[0m16:11:20.097094 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:20.098160 [debug] [MainThread]: On master: BEGIN
[0m16:11:20.098708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:22.167490 [debug] [MainThread]: SQL status: BEGIN in 2.069 seconds
[0m16:11:22.168645 [debug] [MainThread]: On master: COMMIT
[0m16:11:22.169232 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:22.169793 [debug] [MainThread]: On master: COMMIT
[0m16:11:22.173158 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:11:22.173713 [debug] [MainThread]: On master: Close
[0m16:11:22.175410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:22.176550 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:11:22.177107 [debug] [MainThread]: Connection 'list_postgres_public_pipedrive_analytics' was properly closed.
[0m16:11:22.178227 [debug] [MainThread]: Connection 'model.enpal_assessment_project.intg_activity' was properly closed.
[0m16:11:22.179248 [info ] [MainThread]: 
[0m16:11:22.181272 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.02 seconds (14.02s).
[0m16:11:22.183872 [debug] [MainThread]: Command end result
[0m16:11:22.372987 [info ] [MainThread]: 
[0m16:11:22.375010 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:22.376534 [info ] [MainThread]: 
[0m16:11:22.376534 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:11:22.380719 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:22.380088 after 18.06 seconds
[0m16:11:22.381730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115A22ABB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115ABFD130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115A7D4370>]}
[0m16:11:22.382742 [debug] [MainThread]: Flushing usage events
[0m16:17:34.049787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023744574A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023747087760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023747087A30>]}


============================== 16:17:34.064511 | f907c964-afb2-47e1-afb4-4bf3b69ef593 ==============================
[0m16:17:34.064511 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:17:34.066515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select intg_activity', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:17:34.551559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f907c964-afb2-47e1-afb4-4bf3b69ef593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237449F4220>]}
[0m16:17:34.667351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f907c964-afb2-47e1-afb4-4bf3b69ef593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023744F3C1C0>]}
[0m16:17:34.671362 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:17:34.696554 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:17:35.381658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:17:35.382770 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:17:35.401123 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m16:17:35.538676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f907c964-afb2-47e1-afb4-4bf3b69ef593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023747634F10>]}
[0m16:17:35.853432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f907c964-afb2-47e1-afb4-4bf3b69ef593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237476911C0>]}
[0m16:17:35.854451 [info ] [MainThread]: Found 2 models, 2 sources, 423 macros
[0m16:17:35.856471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f907c964-afb2-47e1-afb4-4bf3b69ef593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374763C5B0>]}
[0m16:17:35.858467 [info ] [MainThread]: 
[0m16:17:35.860473 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:17:35.863601 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:17:36.345240 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:17:36.346249 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:17:36.347260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:38.488052 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.141 seconds
[0m16:17:38.491361 [debug] [ThreadPool]: On list_postgres: Close
[0m16:17:38.495433 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m16:17:38.511212 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:17:38.512226 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m16:17:38.514241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:40.607547 [debug] [ThreadPool]: SQL status: BEGIN in 2.094 seconds
[0m16:17:40.609215 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:17:40.610400 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m16:17:40.622743 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m16:17:40.626981 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m16:17:40.631121 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m16:17:40.633370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_integration)
[0m16:17:40.641181 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m16:17:40.642238 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m16:17:40.642238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:17:42.715522 [debug] [ThreadPool]: SQL status: BEGIN in 2.072 seconds
[0m16:17:42.716606 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m16:17:42.717660 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m16:17:42.725933 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m16:17:42.727504 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m16:17:42.731427 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m16:17:42.745484 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:42.746500 [debug] [MainThread]: On master: BEGIN
[0m16:17:42.747506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:17:44.828043 [debug] [MainThread]: SQL status: BEGIN in 2.081 seconds
[0m16:17:44.829139 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:44.829730 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:17:44.839221 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m16:17:44.841285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f907c964-afb2-47e1-afb4-4bf3b69ef593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023747691280>]}
[0m16:17:44.842298 [debug] [MainThread]: On master: ROLLBACK
[0m16:17:44.845853 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:44.846399 [debug] [MainThread]: On master: BEGIN
[0m16:17:44.850776 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:17:44.851831 [debug] [MainThread]: On master: COMMIT
[0m16:17:44.852406 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:44.853495 [debug] [MainThread]: On master: COMMIT
[0m16:17:44.856763 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m16:17:44.857849 [debug] [MainThread]: On master: Close
[0m16:17:44.858934 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:17:44.860667 [info ] [MainThread]: 
[0m16:17:44.879332 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.intg_activity
[0m16:17:44.881347 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.intg_activity .................. [RUN]
[0m16:17:44.883875 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.intg_activity'
[0m16:17:44.884878 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.intg_activity
[0m16:17:44.901865 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.intg_activity"
[0m16:17:44.906411 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.intg_activity
[0m16:17:45.008976 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.intg_activity"
[0m16:17:45.011709 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity"
[0m16:17:45.012820 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: BEGIN
[0m16:17:45.013395 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:17:47.094002 [debug] [Thread-1  ]: SQL status: BEGIN in 2.080 seconds
[0m16:17:47.095214 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity"
[0m16:17:47.096364 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity"} */

  
    

  create  table "postgres"."public_integration"."intg_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m16:17:47.164903 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.067 seconds
[0m16:17:47.176000 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity"
[0m16:17:47.176000 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity"} */
alter table "postgres"."public_integration"."intg_activity" rename to "intg_activity__dbt_backup"
[0m16:17:47.181297 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:17:47.187940 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity"
[0m16:17:47.189239 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity"} */
alter table "postgres"."public_integration"."intg_activity__dbt_tmp" rename to "intg_activity"
[0m16:17:47.194862 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.005 seconds
[0m16:17:47.242113 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: COMMIT
[0m16:17:47.243111 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity"
[0m16:17:47.244113 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: COMMIT
[0m16:17:47.255556 [debug] [Thread-1  ]: SQL status: COMMIT in 0.010 seconds
[0m16:17:47.270915 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."intg_activity__dbt_backup"
[0m16:17:47.278920 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity"
[0m16:17:47.281093 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity"} */
drop table if exists "postgres"."public_integration"."intg_activity__dbt_backup" cascade
[0m16:17:47.298187 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.016 seconds
[0m16:17:47.303186 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: Close
[0m16:17:47.307205 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f907c964-afb2-47e1-afb4-4bf3b69ef593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237433A4820>]}
[0m16:17:47.308316 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.intg_activity ............. [[32mSELECT 4579[0m in 2.42s]
[0m16:17:47.310961 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.intg_activity
[0m16:17:47.314150 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:47.314678 [debug] [MainThread]: On master: BEGIN
[0m16:17:47.315818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:17:49.392569 [debug] [MainThread]: SQL status: BEGIN in 2.077 seconds
[0m16:17:49.393682 [debug] [MainThread]: On master: COMMIT
[0m16:17:49.394784 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:49.395899 [debug] [MainThread]: On master: COMMIT
[0m16:17:49.398678 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:17:49.399238 [debug] [MainThread]: On master: Close
[0m16:17:49.400948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:49.402028 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:17:49.403741 [debug] [MainThread]: Connection 'list_postgres_public_integration' was properly closed.
[0m16:17:49.404284 [debug] [MainThread]: Connection 'model.enpal_assessment_project.intg_activity' was properly closed.
[0m16:17:49.405461 [info ] [MainThread]: 
[0m16:17:49.407177 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.55 seconds (13.55s).
[0m16:17:49.409624 [debug] [MainThread]: Command end result
[0m16:17:49.478294 [info ] [MainThread]: 
[0m16:17:49.479967 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:17:49.481980 [info ] [MainThread]: 
[0m16:17:49.483984 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:17:49.487556 [debug] [MainThread]: Command `dbt run` succeeded at 16:17:49.486998 after 15.55 seconds
[0m16:17:49.488569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023744574A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237464E85B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374650FAF0>]}
[0m16:17:49.489576 [debug] [MainThread]: Flushing usage events
[0m20:18:30.353573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD3738DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD6247A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD56A8550>]}


============================== 20:18:30.407146 | f47cb75f-f5d2-436d-8b16-fac95cf600c4 ==============================
[0m20:18:30.407146 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:18:30.408791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select intg_activity_types', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:18:31.045411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f47cb75f-f5d2-436d-8b16-fac95cf600c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD3643E80>]}
[0m20:18:31.148877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f47cb75f-f5d2-436d-8b16-fac95cf600c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD3BE3040>]}
[0m20:18:31.152554 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:18:31.216866 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:18:34.095684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m20:18:34.097196 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\integration\intg_fields.sql
[0m20:18:34.098218 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\integration\intg_stages.sql
[0m20:18:34.099228 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\integration\intg_users.sql
[0m20:18:34.099734 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\integration\intg_activity_types.sql
[0m20:18:34.100740 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\integration\intg_deal_changes.sql
[0m20:18:34.101744 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\integration\schema.yml
[0m20:18:34.787397 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m20:18:34.821330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f47cb75f-f5d2-436d-8b16-fac95cf600c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD6AB2970>]}
[0m20:18:35.159910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f47cb75f-f5d2-436d-8b16-fac95cf600c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD6B16C40>]}
[0m20:18:35.161419 [info ] [MainThread]: Found 7 models, 7 sources, 423 macros
[0m20:18:35.162428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f47cb75f-f5d2-436d-8b16-fac95cf600c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD6639F40>]}
[0m20:18:35.165430 [info ] [MainThread]: 
[0m20:18:35.167435 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:18:35.171936 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:18:41.363220 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:18:41.365220 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:18:41.366221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:43.585937 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.219 seconds
[0m20:18:43.587559 [debug] [ThreadPool]: On list_postgres: Close
[0m20:18:43.598293 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m20:18:43.611109 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:18:43.612232 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m20:18:43.612749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:45.688633 [debug] [ThreadPool]: SQL status: BEGIN in 2.075 seconds
[0m20:18:45.689752 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:18:45.690941 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m20:18:45.721988 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.030 seconds
[0m20:18:45.724050 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m20:18:45.727396 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m20:18:45.729069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_integration)
[0m20:18:45.736243 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m20:18:45.737377 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m20:18:45.738485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:47.826593 [debug] [ThreadPool]: SQL status: BEGIN in 2.088 seconds
[0m20:18:47.827133 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m20:18:47.827672 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m20:18:47.836024 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m20:18:47.837699 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m20:18:47.842094 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m20:18:47.854736 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:47.854736 [debug] [MainThread]: On master: BEGIN
[0m20:18:47.856251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:18:49.936939 [debug] [MainThread]: SQL status: BEGIN in 2.080 seconds
[0m20:18:49.937557 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:49.938664 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:18:49.962707 [debug] [MainThread]: SQL status: SELECT 0 in 0.023 seconds
[0m20:18:49.964346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f47cb75f-f5d2-436d-8b16-fac95cf600c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD6EB30D0>]}
[0m20:18:49.965531 [debug] [MainThread]: On master: ROLLBACK
[0m20:18:49.968844 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:49.969392 [debug] [MainThread]: On master: BEGIN
[0m20:18:49.974486 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:18:49.975024 [debug] [MainThread]: On master: COMMIT
[0m20:18:49.976070 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:49.976621 [debug] [MainThread]: On master: COMMIT
[0m20:18:49.979405 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:18:49.979958 [debug] [MainThread]: On master: Close
[0m20:18:49.981438 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:18:49.982966 [info ] [MainThread]: 
[0m20:18:50.028640 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.intg_activity_types
[0m20:18:50.031192 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.intg_activity_types ............ [RUN]
[0m20:18:50.034184 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.intg_activity_types'
[0m20:18:50.035194 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.intg_activity_types
[0m20:18:50.054709 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.intg_activity_types"
[0m20:18:50.061025 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.intg_activity_types
[0m20:18:50.170856 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.intg_activity_types"
[0m20:18:50.177017 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity_types"
[0m20:18:50.178287 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: BEGIN
[0m20:18:50.178858 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:18:52.269607 [debug] [Thread-1  ]: SQL status: BEGIN in 2.091 seconds
[0m20:18:52.271339 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity_types"
[0m20:18:52.271917 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity_types"} */

  
    

  create  table "postgres"."public_integration"."intg_activity_types__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."activity_types"
  );
  
[0m20:18:52.324776 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.051 seconds
[0m20:18:52.335291 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity_types"
[0m20:18:52.337313 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity_types"} */
alter table "postgres"."public_integration"."intg_activity_types__dbt_tmp" rename to "intg_activity_types"
[0m20:18:52.342423 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m20:18:52.387583 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: COMMIT
[0m20:18:52.389344 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity_types"
[0m20:18:52.390492 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: COMMIT
[0m20:18:52.402230 [debug] [Thread-1  ]: SQL status: COMMIT in 0.010 seconds
[0m20:18:52.415935 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."intg_activity_types__dbt_backup"
[0m20:18:52.426149 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity_types"
[0m20:18:52.427152 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity_types"} */
drop table if exists "postgres"."public_integration"."intg_activity_types__dbt_backup" cascade
[0m20:18:52.432342 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m20:18:52.436818 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: Close
[0m20:18:52.440723 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f47cb75f-f5d2-436d-8b16-fac95cf600c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD68CCAC0>]}
[0m20:18:52.442404 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.intg_activity_types ....... [[32mSELECT 0[0m in 2.41s]
[0m20:18:52.443996 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.intg_activity_types
[0m20:18:52.447886 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:52.449085 [debug] [MainThread]: On master: BEGIN
[0m20:18:52.449682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:18:54.532507 [debug] [MainThread]: SQL status: BEGIN in 2.083 seconds
[0m20:18:54.533609 [debug] [MainThread]: On master: COMMIT
[0m20:18:54.534152 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:54.534716 [debug] [MainThread]: On master: COMMIT
[0m20:18:54.538103 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:18:54.539214 [debug] [MainThread]: On master: Close
[0m20:18:54.540305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:54.540857 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:18:54.541407 [debug] [MainThread]: Connection 'list_postgres_public_integration' was properly closed.
[0m20:18:54.542530 [debug] [MainThread]: Connection 'model.enpal_assessment_project.intg_activity_types' was properly closed.
[0m20:18:54.543094 [info ] [MainThread]: 
[0m20:18:54.544226 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 19.38 seconds (19.38s).
[0m20:18:54.547205 [debug] [MainThread]: Command end result
[0m20:18:54.723992 [info ] [MainThread]: 
[0m20:18:54.724992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:18:54.726992 [info ] [MainThread]: 
[0m20:18:54.728519 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:18:54.731161 [debug] [MainThread]: Command `dbt run` succeeded at 20:18:54.730160 after 24.62 seconds
[0m20:18:54.732156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD68C07F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD68B3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD68B3160>]}
[0m20:18:54.733158 [debug] [MainThread]: Flushing usage events
[0m20:20:40.493635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016752565D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016752EA87C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016755004250>]}


============================== 20:20:40.511886 | e364e6cb-e0ef-40e2-a57b-63dc5e9ff07c ==============================
[0m20:20:40.511886 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:20:40.513898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select intg_deal_changes', 'send_anonymous_usage_stats': 'True'}
[0m20:20:41.037374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e364e6cb-e0ef-40e2-a57b-63dc5e9ff07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167529B1400>]}
[0m20:20:41.184703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e364e6cb-e0ef-40e2-a57b-63dc5e9ff07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016755004DC0>]}
[0m20:20:41.189493 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:20:41.213485 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:20:41.746266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:20:41.748249 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:20:41.764642 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m20:20:41.862419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e364e6cb-e0ef-40e2-a57b-63dc5e9ff07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001675563F370>]}
[0m20:20:42.186902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e364e6cb-e0ef-40e2-a57b-63dc5e9ff07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167556CFF70>]}
[0m20:20:42.188415 [info ] [MainThread]: Found 7 models, 7 sources, 423 macros
[0m20:20:42.189616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e364e6cb-e0ef-40e2-a57b-63dc5e9ff07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001675563FC70>]}
[0m20:20:42.192945 [info ] [MainThread]: 
[0m20:20:42.193946 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:20:42.199460 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:20:42.619237 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:20:42.620257 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:20:42.621259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:44.755319 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.134 seconds
[0m20:20:44.758612 [debug] [ThreadPool]: On list_postgres: Close
[0m20:20:44.772357 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_integration'
[0m20:20:44.788799 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m20:20:44.789787 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m20:20:44.790796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:46.870916 [debug] [ThreadPool]: SQL status: BEGIN in 2.080 seconds
[0m20:20:46.871448 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m20:20:46.872513 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m20:20:46.881401 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m20:20:46.884945 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m20:20:46.888606 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m20:20:46.890866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_integration, now list_postgres_public_pipedrive_analytics)
[0m20:20:46.900749 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:20:46.901980 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m20:20:46.903104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:20:48.962220 [debug] [ThreadPool]: SQL status: BEGIN in 2.059 seconds
[0m20:20:48.963294 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:20:48.964394 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m20:20:48.972583 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m20:20:48.974134 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m20:20:48.978075 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m20:20:48.991414 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:48.992435 [debug] [MainThread]: On master: BEGIN
[0m20:20:48.993436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:51.064115 [debug] [MainThread]: SQL status: BEGIN in 2.071 seconds
[0m20:20:51.065216 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:51.065786 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:20:51.075879 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m20:20:51.080379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e364e6cb-e0ef-40e2-a57b-63dc5e9ff07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167556951C0>]}
[0m20:20:51.082015 [debug] [MainThread]: On master: ROLLBACK
[0m20:20:51.085377 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:51.086471 [debug] [MainThread]: On master: BEGIN
[0m20:20:51.090807 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:20:51.092051 [debug] [MainThread]: On master: COMMIT
[0m20:20:51.092601 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:51.093159 [debug] [MainThread]: On master: COMMIT
[0m20:20:51.096458 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:20:51.097000 [debug] [MainThread]: On master: Close
[0m20:20:51.098781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:20:51.101324 [info ] [MainThread]: 
[0m20:20:51.118098 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.intg_deal_changes
[0m20:20:51.119114 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.intg_deal_changes .............. [RUN]
[0m20:20:51.122161 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.intg_deal_changes'
[0m20:20:51.123179 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.intg_deal_changes
[0m20:20:51.143929 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.intg_deal_changes"
[0m20:20:51.149933 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.intg_deal_changes
[0m20:20:51.217193 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.intg_deal_changes"
[0m20:20:51.221201 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_deal_changes"
[0m20:20:51.222193 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: BEGIN
[0m20:20:51.222193 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:20:53.293015 [debug] [Thread-1  ]: SQL status: BEGIN in 2.070 seconds
[0m20:20:53.294096 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_deal_changes"
[0m20:20:53.294642 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_deal_changes"} */

  
    

  create  table "postgres"."public_integration"."intg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."deal_changes"
  );
  
[0m20:20:53.318795 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.023 seconds
[0m20:20:53.329034 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_deal_changes"
[0m20:20:53.330041 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_deal_changes"} */
alter table "postgres"."public_integration"."intg_deal_changes__dbt_tmp" rename to "intg_deal_changes"
[0m20:20:53.334584 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m20:20:53.362028 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: COMMIT
[0m20:20:53.363032 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_deal_changes"
[0m20:20:53.363032 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: COMMIT
[0m20:20:53.370932 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:20:53.382885 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."intg_deal_changes__dbt_backup"
[0m20:20:53.391431 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_deal_changes"
[0m20:20:53.392433 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_deal_changes"} */
drop table if exists "postgres"."public_integration"."intg_deal_changes__dbt_backup" cascade
[0m20:20:53.396086 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m20:20:53.401114 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: Close
[0m20:20:53.404408 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e364e6cb-e0ef-40e2-a57b-63dc5e9ff07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016755AA74F0>]}
[0m20:20:53.406021 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.intg_deal_changes ......... [[32mSELECT 0[0m in 2.28s]
[0m20:20:53.408132 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.intg_deal_changes
[0m20:20:53.411362 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:53.412008 [debug] [MainThread]: On master: BEGIN
[0m20:20:53.413084 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:20:55.492900 [debug] [MainThread]: SQL status: BEGIN in 2.080 seconds
[0m20:20:55.494604 [debug] [MainThread]: On master: COMMIT
[0m20:20:55.495718 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:55.496828 [debug] [MainThread]: On master: COMMIT
[0m20:20:55.500381 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:20:55.501508 [debug] [MainThread]: On master: Close
[0m20:20:55.503195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:55.505087 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:20:55.506291 [debug] [MainThread]: Connection 'list_postgres_public_pipedrive_analytics' was properly closed.
[0m20:20:55.507309 [debug] [MainThread]: Connection 'model.enpal_assessment_project.intg_deal_changes' was properly closed.
[0m20:20:55.508302 [info ] [MainThread]: 
[0m20:20:55.510312 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.31 seconds (13.31s).
[0m20:20:55.513951 [debug] [MainThread]: Command end result
[0m20:20:55.608522 [info ] [MainThread]: 
[0m20:20:55.610042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:20:55.611899 [info ] [MainThread]: 
[0m20:20:55.613071 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:20:55.616082 [debug] [MainThread]: Command `dbt run` succeeded at 20:20:55.616082 after 15.35 seconds
[0m20:20:55.618083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016752565D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167544DD580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001675248EE20>]}
[0m20:20:55.619095 [debug] [MainThread]: Flushing usage events
[0m20:22:45.209508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F93D9AB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F968BCD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F92BDCB80>]}


============================== 20:22:45.228771 | 5e1b25fa-b232-409b-8c33-dd4201fade58 ==============================
[0m20:22:45.228771 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:22:45.230778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select intg_activity_types', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:22:45.666301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e1b25fa-b232-409b-8c33-dd4201fade58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F941F13A0>]}
[0m20:22:45.763644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e1b25fa-b232-409b-8c33-dd4201fade58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9476E1C0>]}
[0m20:22:45.767293 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:22:45.792533 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:22:46.202553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:22:46.202553 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:22:46.213325 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m20:22:46.303699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e1b25fa-b232-409b-8c33-dd4201fade58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F96E7F040>]}
[0m20:22:46.592087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e1b25fa-b232-409b-8c33-dd4201fade58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F96F4FF10>]}
[0m20:22:46.593083 [info ] [MainThread]: Found 7 models, 7 sources, 423 macros
[0m20:22:46.594077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e1b25fa-b232-409b-8c33-dd4201fade58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F96CA0FD0>]}
[0m20:22:46.597072 [info ] [MainThread]: 
[0m20:22:46.598078 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:22:46.603604 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:22:46.915939 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:22:46.916932 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:22:46.917440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:49.049742 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.132 seconds
[0m20:22:49.052492 [debug] [ThreadPool]: On list_postgres: Close
[0m20:22:49.062481 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_integration'
[0m20:22:49.075167 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m20:22:49.075763 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m20:22:49.076772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:51.146198 [debug] [ThreadPool]: SQL status: BEGIN in 2.070 seconds
[0m20:22:51.147859 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m20:22:51.148415 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m20:22:51.156259 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m20:22:51.160009 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m20:22:51.163301 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m20:22:51.165561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_integration, now list_postgres_public_pipedrive_analytics)
[0m20:22:51.173818 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:22:51.174363 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m20:22:51.175382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:53.256291 [debug] [ThreadPool]: SQL status: BEGIN in 2.081 seconds
[0m20:22:53.257367 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:22:53.258468 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m20:22:53.266213 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m20:22:53.268600 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m20:22:53.271906 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m20:22:53.280774 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:53.281328 [debug] [MainThread]: On master: BEGIN
[0m20:22:53.281882 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:22:55.367089 [debug] [MainThread]: SQL status: BEGIN in 2.085 seconds
[0m20:22:55.367631 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:55.368172 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:22:55.376746 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m20:22:55.378956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e1b25fa-b232-409b-8c33-dd4201fade58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F96ED90D0>]}
[0m20:22:55.380660 [debug] [MainThread]: On master: ROLLBACK
[0m20:22:55.384039 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:55.384582 [debug] [MainThread]: On master: BEGIN
[0m20:22:55.389539 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:22:55.390078 [debug] [MainThread]: On master: COMMIT
[0m20:22:55.390613 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:55.391157 [debug] [MainThread]: On master: COMMIT
[0m20:22:55.393828 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:22:55.394436 [debug] [MainThread]: On master: Close
[0m20:22:55.395522 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:22:55.397656 [info ] [MainThread]: 
[0m20:22:55.433714 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.intg_activity_types
[0m20:22:55.434726 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.intg_activity_types ............ [RUN]
[0m20:22:55.436732 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.intg_activity_types'
[0m20:22:55.437726 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.intg_activity_types
[0m20:22:55.453010 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.intg_activity_types"
[0m20:22:55.455536 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.intg_activity_types
[0m20:22:55.527355 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.intg_activity_types"
[0m20:22:55.530381 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity_types"
[0m20:22:55.531368 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: BEGIN
[0m20:22:55.532378 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:22:57.602577 [debug] [Thread-1  ]: SQL status: BEGIN in 2.070 seconds
[0m20:22:57.603664 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity_types"
[0m20:22:57.604742 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity_types"} */

  
    

  create  table "postgres"."public_integration"."intg_activity_types__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."activity_types"
  );
  
[0m20:22:57.618142 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.013 seconds
[0m20:22:57.629056 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity_types"
[0m20:22:57.630076 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity_types"} */
alter table "postgres"."public_integration"."intg_activity_types" rename to "intg_activity_types__dbt_backup"
[0m20:22:57.637843 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:22:57.647895 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity_types"
[0m20:22:57.648520 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity_types"} */
alter table "postgres"."public_integration"."intg_activity_types__dbt_tmp" rename to "intg_activity_types"
[0m20:22:57.652992 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:22:57.697534 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: COMMIT
[0m20:22:57.698546 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity_types"
[0m20:22:57.700060 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: COMMIT
[0m20:22:57.707462 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:22:57.721647 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."intg_activity_types__dbt_backup"
[0m20:22:57.731959 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity_types"
[0m20:22:57.732954 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity_types"} */
drop table if exists "postgres"."public_integration"."intg_activity_types__dbt_backup" cascade
[0m20:22:57.749250 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.015 seconds
[0m20:22:57.754957 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: Close
[0m20:22:57.759467 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e1b25fa-b232-409b-8c33-dd4201fade58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F972F3D30>]}
[0m20:22:57.760482 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.intg_activity_types ....... [[32mSELECT 4[0m in 2.32s]
[0m20:22:57.763482 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.intg_activity_types
[0m20:22:57.768019 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:57.769133 [debug] [MainThread]: On master: BEGIN
[0m20:22:57.769706 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:22:59.844462 [debug] [MainThread]: SQL status: BEGIN in 2.075 seconds
[0m20:22:59.846284 [debug] [MainThread]: On master: COMMIT
[0m20:22:59.847393 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:59.848470 [debug] [MainThread]: On master: COMMIT
[0m20:22:59.851277 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:22:59.852469 [debug] [MainThread]: On master: Close
[0m20:22:59.853595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:59.855125 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:22:59.855686 [debug] [MainThread]: Connection 'list_postgres_public_pipedrive_analytics' was properly closed.
[0m20:22:59.856793 [debug] [MainThread]: Connection 'model.enpal_assessment_project.intg_activity_types' was properly closed.
[0m20:22:59.857348 [info ] [MainThread]: 
[0m20:22:59.859013 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.26 seconds (13.26s).
[0m20:22:59.862048 [debug] [MainThread]: Command end result
[0m20:22:59.934271 [info ] [MainThread]: 
[0m20:22:59.936286 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:22:59.937803 [info ] [MainThread]: 
[0m20:22:59.938531 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:22:59.941543 [debug] [MainThread]: Command `dbt run` succeeded at 20:22:59.940541 after 14.83 seconds
[0m20:22:59.942542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F93D9AB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9476E1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F96F4F2E0>]}
[0m20:22:59.944548 [debug] [MainThread]: Flushing usage events
[0m20:25:53.440999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F1278BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F3B3F100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F3D19400>]}


============================== 20:25:53.452175 | 57ef6a9e-303f-4be7-be37-a3d8ef46f1b5 ==============================
[0m20:25:53.452175 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:25:53.453175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select intg_deal_changes', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:25:53.818608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57ef6a9e-303f-4be7-be37-a3d8ef46f1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F1183F40>]}
[0m20:25:53.941464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57ef6a9e-303f-4be7-be37-a3d8ef46f1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F3D8C460>]}
[0m20:25:53.944478 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:25:53.968252 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:25:54.312017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:25:54.313027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:25:54.323050 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m20:25:54.383761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57ef6a9e-303f-4be7-be37-a3d8ef46f1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F434E370>]}
[0m20:25:54.626188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57ef6a9e-303f-4be7-be37-a3d8ef46f1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F441FF40>]}
[0m20:25:54.627185 [info ] [MainThread]: Found 7 models, 7 sources, 423 macros
[0m20:25:54.628179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57ef6a9e-303f-4be7-be37-a3d8ef46f1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F41EFA90>]}
[0m20:25:54.631180 [info ] [MainThread]: 
[0m20:25:54.633687 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:25:54.638369 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:25:54.890000 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:25:54.891008 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:25:54.892001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:56.998899 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.107 seconds
[0m20:25:57.001152 [debug] [ThreadPool]: On list_postgres: Close
[0m20:25:57.011571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_integration'
[0m20:25:57.021461 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m20:25:57.021461 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m20:25:57.022986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:59.087597 [debug] [ThreadPool]: SQL status: BEGIN in 2.064 seconds
[0m20:25:59.089144 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m20:25:59.090413 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m20:25:59.100805 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m20:25:59.103654 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m20:25:59.107593 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m20:25:59.109258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_integration, now list_postgres_public_pipedrive_analytics)
[0m20:25:59.117705 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:25:59.119263 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m20:25:59.119918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:01.207642 [debug] [ThreadPool]: SQL status: BEGIN in 2.087 seconds
[0m20:26:01.208191 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:26:01.209331 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m20:26:01.217122 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m20:26:01.219416 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m20:26:01.222755 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m20:26:01.234857 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:01.235856 [debug] [MainThread]: On master: BEGIN
[0m20:26:01.236857 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:26:03.321815 [debug] [MainThread]: SQL status: BEGIN in 2.085 seconds
[0m20:26:03.322372 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:03.323476 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:26:03.331751 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m20:26:03.334085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57ef6a9e-303f-4be7-be37-a3d8ef46f1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F43A7100>]}
[0m20:26:03.335175 [debug] [MainThread]: On master: ROLLBACK
[0m20:26:03.337930 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:03.339701 [debug] [MainThread]: On master: BEGIN
[0m20:26:03.344781 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:26:03.345316 [debug] [MainThread]: On master: COMMIT
[0m20:26:03.345855 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:03.346940 [debug] [MainThread]: On master: COMMIT
[0m20:26:03.349564 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:26:03.349564 [debug] [MainThread]: On master: Close
[0m20:26:03.351108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:26:03.352126 [info ] [MainThread]: 
[0m20:26:03.369720 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.intg_deal_changes
[0m20:26:03.370749 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.intg_deal_changes .............. [RUN]
[0m20:26:03.373810 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.intg_deal_changes'
[0m20:26:03.375351 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.intg_deal_changes
[0m20:26:03.393192 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.intg_deal_changes"
[0m20:26:03.397206 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.intg_deal_changes
[0m20:26:03.459047 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.intg_deal_changes"
[0m20:26:03.462052 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_deal_changes"
[0m20:26:03.463046 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: BEGIN
[0m20:26:03.464041 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:26:05.560080 [debug] [Thread-1  ]: SQL status: BEGIN in 2.096 seconds
[0m20:26:05.561154 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_deal_changes"
[0m20:26:05.561697 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_deal_changes"} */

  
    

  create  table "postgres"."public_integration"."intg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."deal_changes"
  );
  
[0m20:26:05.645653 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.083 seconds
[0m20:26:05.656519 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_deal_changes"
[0m20:26:05.657072 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_deal_changes"} */
alter table "postgres"."public_integration"."intg_deal_changes" rename to "intg_deal_changes__dbt_backup"
[0m20:26:05.661900 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:26:05.668448 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_deal_changes"
[0m20:26:05.669558 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_deal_changes"} */
alter table "postgres"."public_integration"."intg_deal_changes__dbt_tmp" rename to "intg_deal_changes"
[0m20:26:05.673181 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:26:05.707197 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: COMMIT
[0m20:26:05.708200 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_deal_changes"
[0m20:26:05.708200 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: COMMIT
[0m20:26:05.729456 [debug] [Thread-1  ]: SQL status: COMMIT in 0.020 seconds
[0m20:26:05.740392 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."intg_deal_changes__dbt_backup"
[0m20:26:05.747911 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_deal_changes"
[0m20:26:05.748911 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_deal_changes"} */
drop table if exists "postgres"."public_integration"."intg_deal_changes__dbt_backup" cascade
[0m20:26:05.758693 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.009 seconds
[0m20:26:05.763426 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: Close
[0m20:26:05.766860 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57ef6a9e-303f-4be7-be37-a3d8ef46f1b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F47DBD60>]}
[0m20:26:05.767971 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.intg_deal_changes ......... [[32mSELECT 15406[0m in 2.39s]
[0m20:26:05.770187 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.intg_deal_changes
[0m20:26:05.773283 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:05.774352 [debug] [MainThread]: On master: BEGIN
[0m20:26:05.774879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:26:07.843138 [debug] [MainThread]: SQL status: BEGIN in 2.069 seconds
[0m20:26:07.844304 [debug] [MainThread]: On master: COMMIT
[0m20:26:07.844855 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:07.845421 [debug] [MainThread]: On master: COMMIT
[0m20:26:07.848208 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:26:07.849280 [debug] [MainThread]: On master: Close
[0m20:26:07.850394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:07.851499 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:26:07.852045 [debug] [MainThread]: Connection 'list_postgres_public_pipedrive_analytics' was properly closed.
[0m20:26:07.852045 [debug] [MainThread]: Connection 'model.enpal_assessment_project.intg_deal_changes' was properly closed.
[0m20:26:07.852593 [info ] [MainThread]: 
[0m20:26:07.854253 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.22 seconds (13.22s).
[0m20:26:07.857014 [debug] [MainThread]: Command end result
[0m20:26:07.920372 [info ] [MainThread]: 
[0m20:26:07.922046 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:26:07.923064 [info ] [MainThread]: 
[0m20:26:07.925070 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:26:07.928080 [debug] [MainThread]: Command `dbt run` succeeded at 20:26:07.927074 after 14.59 seconds
[0m20:26:07.929085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F1278BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F11C8160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6F1814370>]}
[0m20:26:07.930084 [debug] [MainThread]: Flushing usage events
[0m20:27:04.841753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD40B8AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD43697760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD43697A30>]}


============================== 20:27:04.858436 | 76ce0dd9-6a86-45f1-9eb5-24d33a13e9d0 ==============================
[0m20:27:04.858436 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:27:04.859432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select intg_fields', 'send_anonymous_usage_stats': 'True'}
[0m20:27:05.280226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76ce0dd9-6a86-45f1-9eb5-24d33a13e9d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD40F3E220>]}
[0m20:27:05.367504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76ce0dd9-6a86-45f1-9eb5-24d33a13e9d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD4154C1C0>]}
[0m20:27:05.371040 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:27:05.392951 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:27:05.787702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:27:05.788702 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:27:05.798752 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m20:27:05.880738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76ce0dd9-6a86-45f1-9eb5-24d33a13e9d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD43C60040>]}
[0m20:27:06.142503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76ce0dd9-6a86-45f1-9eb5-24d33a13e9d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD43CEFE80>]}
[0m20:27:06.143501 [info ] [MainThread]: Found 7 models, 7 sources, 423 macros
[0m20:27:06.145500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76ce0dd9-6a86-45f1-9eb5-24d33a13e9d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD43B079D0>]}
[0m20:27:06.147494 [info ] [MainThread]: 
[0m20:27:06.150020 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:27:06.154032 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:27:06.429446 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:27:06.430448 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:27:06.430448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:08.539957 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.109 seconds
[0m20:27:08.541592 [debug] [ThreadPool]: On list_postgres: Close
[0m20:27:08.553563 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m20:27:08.564373 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:27:08.565375 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m20:27:08.566372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:10.672546 [debug] [ThreadPool]: SQL status: BEGIN in 2.106 seconds
[0m20:27:10.673755 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:27:10.675603 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m20:27:10.692363 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m20:27:10.695609 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m20:27:10.699749 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m20:27:10.702561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_integration)
[0m20:27:10.711763 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m20:27:10.714607 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m20:27:10.715742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:12.814095 [debug] [ThreadPool]: SQL status: BEGIN in 2.099 seconds
[0m20:27:12.815183 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m20:27:12.815726 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m20:27:12.825846 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m20:27:12.827982 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m20:27:12.831344 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m20:27:12.841547 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:12.842125 [debug] [MainThread]: On master: BEGIN
[0m20:27:12.843138 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:27:14.913518 [debug] [MainThread]: SQL status: BEGIN in 2.070 seconds
[0m20:27:14.914601 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:14.915146 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:27:14.923519 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m20:27:14.925112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76ce0dd9-6a86-45f1-9eb5-24d33a13e9d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD43CB4040>]}
[0m20:27:14.926115 [debug] [MainThread]: On master: ROLLBACK
[0m20:27:14.929630 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:14.930178 [debug] [MainThread]: On master: BEGIN
[0m20:27:14.935371 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:27:14.935934 [debug] [MainThread]: On master: COMMIT
[0m20:27:14.936486 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:14.937044 [debug] [MainThread]: On master: COMMIT
[0m20:27:14.939769 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:27:14.940301 [debug] [MainThread]: On master: Close
[0m20:27:14.941847 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:27:14.942922 [info ] [MainThread]: 
[0m20:27:14.960638 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.intg_fields
[0m20:27:14.961718 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.intg_fields .................... [RUN]
[0m20:27:14.963366 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.intg_fields'
[0m20:27:14.964890 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.intg_fields
[0m20:27:14.984643 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.intg_fields"
[0m20:27:14.988647 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.intg_fields
[0m20:27:15.065743 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.intg_fields"
[0m20:27:15.069268 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_fields"
[0m20:27:15.070269 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_fields: BEGIN
[0m20:27:15.071265 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:27:17.159324 [debug] [Thread-1  ]: SQL status: BEGIN in 2.088 seconds
[0m20:27:17.160424 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_fields"
[0m20:27:17.161550 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_fields: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_fields"} */

  
    

  create  table "postgres"."public_integration"."intg_fields__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."fields"
  );
  
[0m20:27:17.190356 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.028 seconds
[0m20:27:17.204467 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_fields"
[0m20:27:17.205471 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_fields: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_fields"} */
alter table "postgres"."public_integration"."intg_fields__dbt_tmp" rename to "intg_fields"
[0m20:27:17.209693 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:27:17.244133 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_fields: COMMIT
[0m20:27:17.245145 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_fields"
[0m20:27:17.246149 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_fields: COMMIT
[0m20:27:17.253149 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m20:27:17.266284 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."intg_fields__dbt_backup"
[0m20:27:17.273276 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_fields"
[0m20:27:17.274273 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_fields: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_fields"} */
drop table if exists "postgres"."public_integration"."intg_fields__dbt_backup" cascade
[0m20:27:17.278794 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m20:27:17.284277 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_fields: Close
[0m20:27:17.287554 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76ce0dd9-6a86-45f1-9eb5-24d33a13e9d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD440C25B0>]}
[0m20:27:17.288661 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.intg_fields ............... [[32mSELECT 4[0m in 2.32s]
[0m20:27:17.290909 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.intg_fields
[0m20:27:17.294576 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:17.295129 [debug] [MainThread]: On master: BEGIN
[0m20:27:17.296220 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:27:19.356313 [debug] [MainThread]: SQL status: BEGIN in 2.061 seconds
[0m20:27:19.357395 [debug] [MainThread]: On master: COMMIT
[0m20:27:19.357933 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:19.358478 [debug] [MainThread]: On master: COMMIT
[0m20:27:19.361691 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:27:19.362238 [debug] [MainThread]: On master: Close
[0m20:27:19.363320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:19.364638 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:27:19.365939 [debug] [MainThread]: Connection 'list_postgres_public_integration' was properly closed.
[0m20:27:19.367093 [debug] [MainThread]: Connection 'model.enpal_assessment_project.intg_fields' was properly closed.
[0m20:27:19.368113 [info ] [MainThread]: 
[0m20:27:19.369111 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.22 seconds (13.22s).
[0m20:27:19.371610 [debug] [MainThread]: Command end result
[0m20:27:19.431779 [info ] [MainThread]: 
[0m20:27:19.433305 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:27:19.435327 [info ] [MainThread]: 
[0m20:27:19.436320 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:27:19.439320 [debug] [MainThread]: Command `dbt run` succeeded at 20:27:19.438322 after 14.71 seconds
[0m20:27:19.440321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD40F3E220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD4154C1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD42B1FAF0>]}
[0m20:27:19.441968 [debug] [MainThread]: Flushing usage events
[0m20:28:07.459676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4A917D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4D43EF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB496EED00>]}


============================== 20:28:07.478270 | bd43a383-e2f1-4be4-83fa-81bf4e0fbc1a ==============================
[0m20:28:07.478270 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:28:07.480817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select intg_stages', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:28:07.931717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd43a383-e2f1-4be4-83fa-81bf4e0fbc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4A88FFD0>]}
[0m20:28:08.068986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd43a383-e2f1-4be4-83fa-81bf4e0fbc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4D3CA0A0>]}
[0m20:28:08.071509 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:28:08.094401 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:28:08.519959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:08.520959 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:08.538801 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m20:28:08.619092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd43a383-e2f1-4be4-83fa-81bf4e0fbc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4D9FF370>]}
[0m20:28:08.977636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd43a383-e2f1-4be4-83fa-81bf4e0fbc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4DA8FF40>]}
[0m20:28:08.979653 [info ] [MainThread]: Found 7 models, 7 sources, 423 macros
[0m20:28:08.980650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd43a383-e2f1-4be4-83fa-81bf4e0fbc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4D860A90>]}
[0m20:28:08.984169 [info ] [MainThread]: 
[0m20:28:08.986196 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:28:08.991723 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:28:09.432729 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:28:09.433729 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:28:09.434724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:11.531402 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.097 seconds
[0m20:28:11.534667 [debug] [ThreadPool]: On list_postgres: Close
[0m20:28:11.547397 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m20:28:11.558027 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:28:11.559534 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m20:28:11.560544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:13.646980 [debug] [ThreadPool]: SQL status: BEGIN in 2.086 seconds
[0m20:28:13.648647 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:28:13.650325 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m20:28:13.658554 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m20:28:13.660565 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m20:28:13.664882 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m20:28:13.667123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_integration)
[0m20:28:13.677404 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m20:28:13.678528 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m20:28:13.679068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:15.757493 [debug] [ThreadPool]: SQL status: BEGIN in 2.078 seconds
[0m20:28:15.758565 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m20:28:15.759671 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m20:28:15.768527 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m20:28:15.771678 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m20:28:15.775674 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m20:28:15.790144 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:15.791253 [debug] [MainThread]: On master: BEGIN
[0m20:28:15.791800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:17.854005 [debug] [MainThread]: SQL status: BEGIN in 2.062 seconds
[0m20:28:17.855754 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:17.856915 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:28:17.867939 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m20:28:17.871331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd43a383-e2f1-4be4-83fa-81bf4e0fbc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4DA6CEE0>]}
[0m20:28:17.873010 [debug] [MainThread]: On master: ROLLBACK
[0m20:28:17.876523 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:17.877657 [debug] [MainThread]: On master: BEGIN
[0m20:28:17.883344 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m20:28:17.884960 [debug] [MainThread]: On master: COMMIT
[0m20:28:17.886094 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:17.886651 [debug] [MainThread]: On master: COMMIT
[0m20:28:17.890307 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m20:28:17.891762 [debug] [MainThread]: On master: Close
[0m20:28:17.893799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:28:17.895508 [info ] [MainThread]: 
[0m20:28:17.916976 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.intg_stages
[0m20:28:17.918962 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.intg_stages .................... [RUN]
[0m20:28:17.920967 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.intg_stages'
[0m20:28:17.922659 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.intg_stages
[0m20:28:17.943437 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.intg_stages"
[0m20:28:17.947956 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.intg_stages
[0m20:28:18.052886 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.intg_stages"
[0m20:28:18.057423 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_stages"
[0m20:28:18.058423 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_stages: BEGIN
[0m20:28:18.059426 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:28:20.134932 [debug] [Thread-1  ]: SQL status: BEGIN in 2.075 seconds
[0m20:28:20.136042 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_stages"
[0m20:28:20.137727 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_stages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_stages"} */

  
    

  create  table "postgres"."public_integration"."intg_stages__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."stages"
  );
  
[0m20:28:20.146307 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.007 seconds
[0m20:28:20.159623 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_stages"
[0m20:28:20.160619 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_stages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_stages"} */
alter table "postgres"."public_integration"."intg_stages__dbt_tmp" rename to "intg_stages"
[0m20:28:20.164867 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:28:20.205703 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_stages: COMMIT
[0m20:28:20.207720 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_stages"
[0m20:28:20.207720 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_stages: COMMIT
[0m20:28:20.215552 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:28:20.233065 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."intg_stages__dbt_backup"
[0m20:28:20.243229 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_stages"
[0m20:28:20.244222 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_stages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_stages"} */
drop table if exists "postgres"."public_integration"."intg_stages__dbt_backup" cascade
[0m20:28:20.249461 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m20:28:20.257207 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_stages: Close
[0m20:28:20.262053 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd43a383-e2f1-4be4-83fa-81bf4e0fbc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4DE7F820>]}
[0m20:28:20.264078 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.intg_stages ............... [[32mSELECT 9[0m in 2.34s]
[0m20:28:20.266948 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.intg_stages
[0m20:28:20.270322 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:20.271898 [debug] [MainThread]: On master: BEGIN
[0m20:28:20.273552 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:28:22.355157 [debug] [MainThread]: SQL status: BEGIN in 2.082 seconds
[0m20:28:22.356286 [debug] [MainThread]: On master: COMMIT
[0m20:28:22.358048 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:22.359136 [debug] [MainThread]: On master: COMMIT
[0m20:28:22.362433 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:28:22.364191 [debug] [MainThread]: On master: Close
[0m20:28:22.365874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:22.366887 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:28:22.367900 [debug] [MainThread]: Connection 'list_postgres_public_integration' was properly closed.
[0m20:28:22.369421 [debug] [MainThread]: Connection 'model.enpal_assessment_project.intg_stages' was properly closed.
[0m20:28:22.370673 [info ] [MainThread]: 
[0m20:28:22.372725 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.38 seconds (13.38s).
[0m20:28:22.375784 [debug] [MainThread]: Command end result
[0m20:28:22.472065 [info ] [MainThread]: 
[0m20:28:22.474357 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:22.476049 [info ] [MainThread]: 
[0m20:28:22.477758 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:28:22.481887 [debug] [MainThread]: Command `dbt run` succeeded at 20:28:22.481320 after 15.17 seconds
[0m20:28:22.483017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4A88FFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4D3CA0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4C8BFC70>]}
[0m20:28:22.485960 [debug] [MainThread]: Flushing usage events
[0m20:30:18.296864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022550E2ABB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225511F1D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225538DAD00>]}


============================== 20:30:18.310191 | 46022319-94dd-47e7-b22d-48b213fb9cd7 ==============================
[0m20:30:18.310191 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:30:18.311186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select intg_users', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:30:18.686935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46022319-94dd-47e7-b22d-48b213fb9cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225512813D0>]}
[0m20:30:18.775855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46022319-94dd-47e7-b22d-48b213fb9cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022551801130>]}
[0m20:30:18.779369 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:30:18.803978 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:30:19.189124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:30:19.190131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:30:19.200652 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m20:30:19.276808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46022319-94dd-47e7-b22d-48b213fb9cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022553EDF040>]}
[0m20:30:19.534921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46022319-94dd-47e7-b22d-48b213fb9cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022553FAEF10>]}
[0m20:30:19.535932 [info ] [MainThread]: Found 7 models, 7 sources, 423 macros
[0m20:30:19.536936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46022319-94dd-47e7-b22d-48b213fb9cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022553D40A60>]}
[0m20:30:19.539937 [info ] [MainThread]: 
[0m20:30:19.541928 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:30:19.547662 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:30:19.818908 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:30:19.819914 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:30:19.819914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:21.914256 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.093 seconds
[0m20:30:21.916438 [debug] [ThreadPool]: On list_postgres: Close
[0m20:30:21.927381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_integration'
[0m20:30:21.937999 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m20:30:21.939001 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m20:30:21.939001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:24.007162 [debug] [ThreadPool]: SQL status: BEGIN in 2.067 seconds
[0m20:30:24.008254 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m20:30:24.009525 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m20:30:24.017736 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m20:30:24.019296 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m20:30:24.022780 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m20:30:24.025604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_integration, now list_postgres_public_pipedrive_analytics)
[0m20:30:24.037047 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:30:24.038048 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m20:30:24.039049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:30:26.109774 [debug] [ThreadPool]: SQL status: BEGIN in 2.070 seconds
[0m20:30:26.110964 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m20:30:26.111517 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m20:30:26.121319 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m20:30:26.124665 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m20:30:26.128687 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m20:30:26.138003 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:26.139117 [debug] [MainThread]: On master: BEGIN
[0m20:30:26.139662 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:30:28.202181 [debug] [MainThread]: SQL status: BEGIN in 2.063 seconds
[0m20:30:28.203285 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:28.204528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:30:28.214744 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m20:30:28.216866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46022319-94dd-47e7-b22d-48b213fb9cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022553F750D0>]}
[0m20:30:28.217989 [debug] [MainThread]: On master: ROLLBACK
[0m20:30:28.221488 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:28.222053 [debug] [MainThread]: On master: BEGIN
[0m20:30:28.227569 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m20:30:28.228110 [debug] [MainThread]: On master: COMMIT
[0m20:30:28.228658 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:28.229211 [debug] [MainThread]: On master: COMMIT
[0m20:30:28.231962 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:30:28.232499 [debug] [MainThread]: On master: Close
[0m20:30:28.233513 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:30:28.235844 [info ] [MainThread]: 
[0m20:30:28.254496 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.intg_users
[0m20:30:28.254496 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.intg_users ..................... [RUN]
[0m20:30:28.257020 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.intg_users'
[0m20:30:28.259020 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.intg_users
[0m20:30:28.274585 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.intg_users"
[0m20:30:28.277095 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.intg_users
[0m20:30:28.345687 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.intg_users"
[0m20:30:28.348690 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_users"
[0m20:30:28.349693 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_users: BEGIN
[0m20:30:28.349693 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m20:30:30.421389 [debug] [Thread-1  ]: SQL status: BEGIN in 2.071 seconds
[0m20:30:30.422499 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_users"
[0m20:30:30.423748 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_users"} */

  
    

  create  table "postgres"."public_integration"."intg_users__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."users"
  );
  
[0m20:30:30.455621 [debug] [Thread-1  ]: SQL status: SELECT 1787 in 0.031 seconds
[0m20:30:30.469982 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_users"
[0m20:30:30.471005 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_users"} */
alter table "postgres"."public_integration"."intg_users__dbt_tmp" rename to "intg_users"
[0m20:30:30.475429 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:30:30.515853 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_users: COMMIT
[0m20:30:30.516872 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_users"
[0m20:30:30.517876 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_users: COMMIT
[0m20:30:30.528437 [debug] [Thread-1  ]: SQL status: COMMIT in 0.009 seconds
[0m20:30:30.541027 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."intg_users__dbt_backup"
[0m20:30:30.549273 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_users"
[0m20:30:30.549787 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_users"} */
drop table if exists "postgres"."public_integration"."intg_users__dbt_backup" cascade
[0m20:30:30.553879 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m20:30:30.559235 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_users: Close
[0m20:30:30.563780 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46022319-94dd-47e7-b22d-48b213fb9cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022554375EB0>]}
[0m20:30:30.565990 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.intg_users ................ [[32mSELECT 1787[0m in 2.30s]
[0m20:30:30.568754 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.intg_users
[0m20:30:30.572217 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:30.573377 [debug] [MainThread]: On master: BEGIN
[0m20:30:30.574497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:30:32.677026 [debug] [MainThread]: SQL status: BEGIN in 2.102 seconds
[0m20:30:32.678106 [debug] [MainThread]: On master: COMMIT
[0m20:30:32.679219 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:32.679795 [debug] [MainThread]: On master: COMMIT
[0m20:30:32.683158 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:30:32.684251 [debug] [MainThread]: On master: Close
[0m20:30:32.685909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:32.687002 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m20:30:32.687557 [debug] [MainThread]: Connection 'list_postgres_public_pipedrive_analytics' was properly closed.
[0m20:30:32.688110 [debug] [MainThread]: Connection 'model.enpal_assessment_project.intg_users' was properly closed.
[0m20:30:32.690131 [info ] [MainThread]: 
[0m20:30:32.691630 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.15 seconds (13.15s).
[0m20:30:32.694409 [debug] [MainThread]: Command end result
[0m20:30:32.775118 [info ] [MainThread]: 
[0m20:30:32.777289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:30:32.778303 [info ] [MainThread]: 
[0m20:30:32.779301 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:30:32.782296 [debug] [MainThread]: Command `dbt run` succeeded at 20:30:32.781298 after 14.59 seconds
[0m20:30:32.782296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225512813D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022551801130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022553FAEFD0>]}
[0m20:30:32.783297 [debug] [MainThread]: Flushing usage events
[0m22:09:48.242974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F78191AD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7822587C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7843B2250>]}


============================== 22:09:48.289316 | 4815f1d4-11b5-4c2a-bedb-707cf3fdd2cc ==============================
[0m22:09:48.289316 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:09:48.292317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select intg_deal_changes', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:09:48.949926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4815f1d4-11b5-4c2a-bedb-707cf3fdd2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F781D5F400>]}
[0m22:09:49.041560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4815f1d4-11b5-4c2a-bedb-707cf3fdd2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7843B2DC0>]}
[0m22:09:49.045586 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:09:49.115219 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:09:49.612794 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enpal_assessment_project: integration\schema.yml - Runtime Error
    Syntax error near line 14
    ------------------------------
    11 |       - name: deal_changes
    12 |         columns:
    13 |             - name: deal_id
    14 |              tests:
    15 |             - not_null
    16 |             - unique
    17 | 
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 13, column 13
    did not find expected '-' indicator
      in "<unicode string>", line 14, column 14
[0m22:09:49.616454 [debug] [MainThread]: Command `dbt run` failed at 22:09:49.615429 after 1.54 seconds
[0m22:09:49.617451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F78191AD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7849E9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7849E91C0>]}
[0m22:09:49.618451 [debug] [MainThread]: Flushing usage events
[0m22:11:21.955128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA39317DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA3BE27850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA3B288550>]}


============================== 22:11:21.966670 | 19ea4427-e1e1-4d2d-bd1e-11b9497e57de ==============================
[0m22:11:21.966670 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:11:21.968667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select intg_deal_changes', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:11:22.286344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19ea4427-e1e1-4d2d-bd1e-11b9497e57de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA39223E80>]}
[0m22:11:22.371422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19ea4427-e1e1-4d2d-bd1e-11b9497e57de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA397C3040>]}
[0m22:11:22.375377 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:11:22.397803 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:11:22.613497 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enpal_assessment_project: integration\schema.yml - Runtime Error
    Syntax error near line 37
    ------------------------------
    34 |            - not_null
    35 |            - unique
    36 | 
    37 |           - name: stage_name
    38 |             tests:
    39 |            - not_null
    40 | 
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 30, column 9
    did not find expected key
      in "<unicode string>", line 37, column 11
[0m22:11:22.616028 [debug] [MainThread]: Command `dbt run` failed at 22:11:22.616028 after 0.74 seconds
[0m22:11:22.618034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA39317DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA3C3D24F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA3C3D2280>]}
[0m22:11:22.619032 [debug] [MainThread]: Flushing usage events
[0m22:13:47.994875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB69947D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB6A2887C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB6C3E3250>]}


============================== 22:13:48.006669 | 19feaa28-cbf8-4de2-88ea-c5f7891aadaf ==============================
[0m22:13:48.006669 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:13:48.007656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select intg_deal_changes', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:13:48.377418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19feaa28-cbf8-4de2-88ea-c5f7891aadaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB69D92400>]}
[0m22:13:48.475640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19feaa28-cbf8-4de2-88ea-c5f7891aadaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB6C3E3DC0>]}
[0m22:13:48.478654 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:13:48.498970 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:13:48.697873 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enpal_assessment_project: integration\schema.yml - Runtime Error
    Syntax error near line 37
    ------------------------------
    34 |              - not_null
    35 |              - unique
    36 | 
    37 |           - name: stage_name
    38 |             tests:
    39 |             - not_null
    40 | 
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 30, column 9
    did not find expected key
      in "<unicode string>", line 37, column 11
[0m22:13:48.701171 [debug] [MainThread]: Command `dbt run` failed at 22:13:48.701171 after 0.79 seconds
[0m22:13:48.703183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB69947D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB6CA0B790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB6CA0B1C0>]}
[0m22:13:48.704155 [debug] [MainThread]: Flushing usage events
[0m22:19:54.651771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A3B30AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A6643BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A6643910>]}


============================== 22:19:54.665333 | 6ad4bba1-97c5-4957-b499-1da69bcf23a8 ==============================
[0m22:19:54.665333 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:19:54.667528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select intg_deal_changes', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:19:55.053940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ad4bba1-97c5-4957-b499-1da69bcf23a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A3F77310>]}
[0m22:19:55.161363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ad4bba1-97c5-4957-b499-1da69bcf23a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A3A5E850>]}
[0m22:19:55.165392 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:19:55.189892 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:19:58.652722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 7 files added, 1 files changed.
[0m22:19:58.653722 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformation\trf_deal_changes.sql
[0m22:19:58.654749 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformation\trf_users.sql
[0m22:19:58.656266 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformation\trf_fields.sql
[0m22:19:58.656266 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformation\trf_stages.sql
[0m22:19:58.657788 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformation\trf_activity.sql
[0m22:19:58.658805 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformation\schema.yml
[0m22:19:58.659805 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformation\trf_activity_types.sql
[0m22:19:58.660806 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\integration\schema.yml
[0m22:19:59.221847 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "postgres_activity".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("postgres", "activity").
  
  To fix this, change the name of one of these resources:
  - source.enpal_assessment_project.postgres.activity (models\transformation\schema.yml)
  - source.enpal_assessment_project.postgres.activity (models\integration\schema.yml)
[0m22:19:59.224825 [debug] [MainThread]: Command `dbt run` failed at 22:19:59.223840 after 4.70 seconds
[0m22:19:59.225828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A3B30AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A6DAEDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A4429A30>]}
[0m22:19:59.226822 [debug] [MainThread]: Flushing usage events
[0m22:20:56.175739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5A597B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5D0B3FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D593DCCA0>]}


============================== 22:20:56.188163 | 6a3729ef-e766-4e9c-ab90-0775747e4515 ==============================
[0m22:20:56.188163 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:20:56.189146 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select intg_deal_changes', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:20:56.495231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a3729ef-e766-4e9c-ab90-0775747e4515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5A9713A0>]}
[0m22:20:56.582163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a3729ef-e766-4e9c-ab90-0775747e4515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5AF6C1C0>]}
[0m22:20:56.585886 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:20:56.611139 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:20:56.957041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 6 files added, 1 files changed.
[0m22:20:56.958044 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformation\trf_users.sql
[0m22:20:56.959029 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformation\trf_activity_types.sql
[0m22:20:56.960015 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformation\trf_fields.sql
[0m22:20:56.961023 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformation\trf_stages.sql
[0m22:20:56.961023 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformation\trf_deal_changes.sql
[0m22:20:56.962025 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformation\trf_activity.sql
[0m22:20:56.963026 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\integration\schema.yml
[0m22:20:57.448748 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:20:57.451746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6a3729ef-e766-4e9c-ab90-0775747e4515', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5A45AB20>]}
[0m22:20:57.848543 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m22:20:57.876933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a3729ef-e766-4e9c-ab90-0775747e4515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5D99C640>]}
[0m22:20:58.271860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a3729ef-e766-4e9c-ab90-0775747e4515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5DA35BB0>]}
[0m22:20:58.272860 [info ] [MainThread]: Found 13 models, 2 data tests, 7 sources, 423 macros
[0m22:20:58.273860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a3729ef-e766-4e9c-ab90-0775747e4515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5D9CDC70>]}
[0m22:20:58.277012 [info ] [MainThread]: 
[0m22:20:58.279010 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:20:58.283663 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:21:05.476499 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:21:05.477506 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:21:05.477506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:07.750324 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.272 seconds
[0m22:21:07.752538 [debug] [ThreadPool]: On list_postgres: Close
[0m22:21:07.765508 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m22:21:07.779772 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:21:07.780770 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m22:21:07.781772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:09.880270 [debug] [ThreadPool]: SQL status: BEGIN in 2.098 seconds
[0m22:21:09.881387 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:21:09.882497 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m22:21:09.926116 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.043 seconds
[0m22:21:09.928269 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m22:21:09.931603 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m22:21:09.933409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_integration)
[0m22:21:09.940118 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m22:21:09.941229 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m22:21:09.942376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:21:12.021446 [debug] [ThreadPool]: SQL status: BEGIN in 2.079 seconds
[0m22:21:12.022558 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m22:21:12.023124 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m22:21:12.033163 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m22:21:12.035436 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m22:21:12.038792 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m22:21:12.040457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_integration, now list_postgres_public_transformation)
[0m22:21:12.048408 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m22:21:12.049512 [debug] [ThreadPool]: On list_postgres_public_transformation: BEGIN
[0m22:21:12.050679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:21:14.130922 [debug] [ThreadPool]: SQL status: BEGIN in 2.080 seconds
[0m22:21:14.132034 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m22:21:14.132592 [debug] [ThreadPool]: On list_postgres_public_transformation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_transformation"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_transformation'
  
[0m22:21:14.139874 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m22:21:14.141496 [debug] [ThreadPool]: On list_postgres_public_transformation: ROLLBACK
[0m22:21:14.144444 [debug] [ThreadPool]: On list_postgres_public_transformation: Close
[0m22:21:14.153661 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:14.154784 [debug] [MainThread]: On master: BEGIN
[0m22:21:14.155910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:21:16.224780 [debug] [MainThread]: SQL status: BEGIN in 2.069 seconds
[0m22:21:16.225854 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:16.226999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:21:16.257674 [debug] [MainThread]: SQL status: SELECT 0 in 0.029 seconds
[0m22:21:16.259849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a3729ef-e766-4e9c-ab90-0775747e4515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5DA4FF40>]}
[0m22:21:16.261515 [debug] [MainThread]: On master: ROLLBACK
[0m22:21:16.264325 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:16.264883 [debug] [MainThread]: On master: BEGIN
[0m22:21:16.269940 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m22:21:16.271035 [debug] [MainThread]: On master: COMMIT
[0m22:21:16.272288 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:16.273396 [debug] [MainThread]: On master: COMMIT
[0m22:21:16.276198 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m22:21:16.277301 [debug] [MainThread]: On master: Close
[0m22:21:16.279029 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:21:16.280697 [info ] [MainThread]: 
[0m22:21:16.331216 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.intg_deal_changes
[0m22:21:16.331728 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.intg_deal_changes .............. [RUN]
[0m22:21:16.334434 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.intg_deal_changes'
[0m22:21:16.335437 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.intg_deal_changes
[0m22:21:16.350824 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.intg_deal_changes"
[0m22:21:16.357572 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.intg_deal_changes
[0m22:21:16.513948 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.intg_deal_changes"
[0m22:21:16.518297 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_deal_changes"
[0m22:21:16.519789 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: BEGIN
[0m22:21:16.520801 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:21:18.612379 [debug] [Thread-1  ]: SQL status: BEGIN in 2.091 seconds
[0m22:21:18.613505 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_deal_changes"
[0m22:21:18.614655 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_deal_changes"} */

  
    

  create  table "postgres"."public_integration"."intg_deal_changes__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."deal_changes"
  );
  
[0m22:21:18.775330 [debug] [Thread-1  ]: SQL status: SELECT 15406 in 0.160 seconds
[0m22:21:18.787573 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_deal_changes"
[0m22:21:18.788645 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_deal_changes"} */
alter table "postgres"."public_integration"."intg_deal_changes" rename to "intg_deal_changes__dbt_backup"
[0m22:21:18.796529 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.007 seconds
[0m22:21:18.802797 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_deal_changes"
[0m22:21:18.803910 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_deal_changes"} */
alter table "postgres"."public_integration"."intg_deal_changes__dbt_tmp" rename to "intg_deal_changes"
[0m22:21:18.807979 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:21:18.841930 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: COMMIT
[0m22:21:18.843444 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_deal_changes"
[0m22:21:18.844520 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: COMMIT
[0m22:21:18.869547 [debug] [Thread-1  ]: SQL status: COMMIT in 0.024 seconds
[0m22:21:18.882892 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."intg_deal_changes__dbt_backup"
[0m22:21:18.890992 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_deal_changes"
[0m22:21:18.891578 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_deal_changes"} */
drop table if exists "postgres"."public_integration"."intg_deal_changes__dbt_backup" cascade
[0m22:21:18.934445 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.042 seconds
[0m22:21:18.939255 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_deal_changes: Close
[0m22:21:18.943643 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a3729ef-e766-4e9c-ab90-0775747e4515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5DEE9910>]}
[0m22:21:18.944764 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.intg_deal_changes ......... [[32mSELECT 15406[0m in 2.61s]
[0m22:21:18.946944 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.intg_deal_changes
[0m22:21:18.950414 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:18.951605 [debug] [MainThread]: On master: BEGIN
[0m22:21:18.952670 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:21:21.039414 [debug] [MainThread]: SQL status: BEGIN in 2.087 seconds
[0m22:21:21.039970 [debug] [MainThread]: On master: COMMIT
[0m22:21:21.040565 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:21.041110 [debug] [MainThread]: On master: COMMIT
[0m22:21:21.044419 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m22:21:21.045049 [debug] [MainThread]: On master: Close
[0m22:21:21.046719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:21:21.047281 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m22:21:21.047840 [debug] [MainThread]: Connection 'list_postgres_public_transformation' was properly closed.
[0m22:21:21.048380 [debug] [MainThread]: Connection 'model.enpal_assessment_project.intg_deal_changes' was properly closed.
[0m22:21:21.048920 [info ] [MainThread]: 
[0m22:21:21.050040 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.77 seconds (22.77s).
[0m22:21:21.052798 [debug] [MainThread]: Command end result
[0m22:21:21.121950 [info ] [MainThread]: 
[0m22:21:21.123094 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:21:21.125092 [info ] [MainThread]: 
[0m22:21:21.126624 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:21:21.129617 [debug] [MainThread]: Command `dbt run` succeeded at 22:21:21.129617 after 25.03 seconds
[0m22:21:21.130834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5A597B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5AF6C1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5D9D19D0>]}
[0m22:21:21.130834 [debug] [MainThread]: Flushing usage events
[0m22:23:31.675270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157179E7D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001571A4F8F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001571681CBE0>]}


============================== 22:23:31.688411 | b47a5fb4-2426-4603-90bc-b9c5b3a9a7e4 ==============================
[0m22:23:31.688411 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:23:31.690077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select intg_stages', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:23:32.067995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b47a5fb4-2426-4603-90bc-b9c5b3a9a7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001571795EFD0>]}
[0m22:23:32.175923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b47a5fb4-2426-4603-90bc-b9c5b3a9a7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001571A48D0A0>]}
[0m22:23:32.179313 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:23:32.202902 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:23:32.497855 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enpal_assessment_project: integration\schema.yml - Runtime Error
    Syntax error near line 37
    ------------------------------
    34 |       - name: new_value
    35 |         description: "new_value"
    36 | 
    37 | - name: intg_stages
    38 |     description: "intg_stages"
    39 |     
    40 |     columns:
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 37, column 1
[0m22:23:32.500854 [debug] [MainThread]: Command `dbt run` failed at 22:23:32.500854 after 0.92 seconds
[0m22:23:32.502370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157179E7D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001571AA8A610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001571AA8A580>]}
[0m22:23:32.503543 [debug] [MainThread]: Flushing usage events
[0m22:24:23.826815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA99C08D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA9C71CFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA98A3CD00>]}


============================== 22:24:23.838957 | 7f7cdcd3-d5d7-494a-a20a-974cebaa5ffb ==============================
[0m22:24:23.838957 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:24:23.840945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select intg_stages', 'send_anonymous_usage_stats': 'True'}
[0m22:24:24.224930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f7cdcd3-d5d7-494a-a20a-974cebaa5ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA99B7EFD0>]}
[0m22:24:24.343139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f7cdcd3-d5d7-494a-a20a-974cebaa5ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA9C6AF0A0>]}
[0m22:24:24.346225 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:24:24.369449 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:24:24.923618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:24:24.924618 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\integration\schema.yml
[0m22:24:25.071059 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:24:25.073867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7f7cdcd3-d5d7-494a-a20a-974cebaa5ffb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA9CCA81C0>]}
[0m22:24:25.542985 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m22:24:25.580870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f7cdcd3-d5d7-494a-a20a-974cebaa5ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA9CE788B0>]}
[0m22:24:25.960834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f7cdcd3-d5d7-494a-a20a-974cebaa5ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA9CEC1610>]}
[0m22:24:25.961846 [info ] [MainThread]: Found 13 models, 5 data tests, 7 sources, 423 macros
[0m22:24:25.963355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f7cdcd3-d5d7-494a-a20a-974cebaa5ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA9CF1C190>]}
[0m22:24:25.966373 [info ] [MainThread]: 
[0m22:24:25.968377 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:24:25.973816 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:24:26.225985 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:24:26.226998 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:24:26.228004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:28.352493 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.124 seconds
[0m22:24:28.354711 [debug] [ThreadPool]: On list_postgres: Close
[0m22:24:28.365301 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_transformation'
[0m22:24:28.376626 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m22:24:28.377626 [debug] [ThreadPool]: On list_postgres_public_transformation: BEGIN
[0m22:24:28.377626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:30.468591 [debug] [ThreadPool]: SQL status: BEGIN in 2.091 seconds
[0m22:24:30.469824 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m22:24:30.470919 [debug] [ThreadPool]: On list_postgres_public_transformation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_transformation"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_transformation'
  
[0m22:24:30.481065 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m22:24:30.483307 [debug] [ThreadPool]: On list_postgres_public_transformation: ROLLBACK
[0m22:24:30.486924 [debug] [ThreadPool]: On list_postgres_public_transformation: Close
[0m22:24:30.489168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_transformation, now list_postgres_public_pipedrive_analytics)
[0m22:24:30.494265 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:24:30.494836 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m22:24:30.495975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:32.577533 [debug] [ThreadPool]: SQL status: BEGIN in 2.082 seconds
[0m22:24:32.578076 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:24:32.578634 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m22:24:32.586824 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m22:24:32.588495 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m22:24:32.592841 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m22:24:32.595072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_integration)
[0m22:24:32.601923 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m22:24:32.603595 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m22:24:32.604614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:34.695605 [debug] [ThreadPool]: SQL status: BEGIN in 2.091 seconds
[0m22:24:34.696713 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m22:24:34.697272 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m22:24:34.705256 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m22:24:34.708142 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m22:24:34.711544 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m22:24:34.727542 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:34.728549 [debug] [MainThread]: On master: BEGIN
[0m22:24:34.730423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:24:36.813602 [debug] [MainThread]: SQL status: BEGIN in 2.083 seconds
[0m22:24:36.814151 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:36.815238 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:24:36.824454 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m22:24:36.826689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f7cdcd3-d5d7-494a-a20a-974cebaa5ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA9CEC14C0>]}
[0m22:24:36.827850 [debug] [MainThread]: On master: ROLLBACK
[0m22:24:36.831459 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:36.832600 [debug] [MainThread]: On master: BEGIN
[0m22:24:36.837679 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m22:24:36.838760 [debug] [MainThread]: On master: COMMIT
[0m22:24:36.839299 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:36.839865 [debug] [MainThread]: On master: COMMIT
[0m22:24:36.842644 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m22:24:36.843180 [debug] [MainThread]: On master: Close
[0m22:24:36.844274 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:24:36.845922 [info ] [MainThread]: 
[0m22:24:36.863930 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.intg_stages
[0m22:24:36.865742 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.intg_stages .................... [RUN]
[0m22:24:36.867362 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.intg_stages'
[0m22:24:36.868462 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.intg_stages
[0m22:24:36.887576 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.intg_stages"
[0m22:24:36.890589 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.intg_stages
[0m22:24:36.958557 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.intg_stages"
[0m22:24:36.961320 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_stages"
[0m22:24:36.962812 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_stages: BEGIN
[0m22:24:36.962812 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:24:39.026837 [debug] [Thread-1  ]: SQL status: BEGIN in 2.063 seconds
[0m22:24:39.027924 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_stages"
[0m22:24:39.029077 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_stages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_stages"} */

  
    

  create  table "postgres"."public_integration"."intg_stages__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."stages"
  );
  
[0m22:24:39.048667 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.019 seconds
[0m22:24:39.059986 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_stages"
[0m22:24:39.060531 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_stages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_stages"} */
alter table "postgres"."public_integration"."intg_stages" rename to "intg_stages__dbt_backup"
[0m22:24:39.065628 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:24:39.071785 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_stages"
[0m22:24:39.072341 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_stages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_stages"} */
alter table "postgres"."public_integration"."intg_stages__dbt_tmp" rename to "intg_stages"
[0m22:24:39.076683 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:24:39.116775 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_stages: COMMIT
[0m22:24:39.117905 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_stages"
[0m22:24:39.118458 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_stages: COMMIT
[0m22:24:39.129248 [debug] [Thread-1  ]: SQL status: COMMIT in 0.010 seconds
[0m22:24:39.141197 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."intg_stages__dbt_backup"
[0m22:24:39.149199 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_stages"
[0m22:24:39.150400 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_stages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_stages"} */
drop table if exists "postgres"."public_integration"."intg_stages__dbt_backup" cascade
[0m22:24:39.163878 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.013 seconds
[0m22:24:39.167721 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_stages: Close
[0m22:24:39.171483 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f7cdcd3-d5d7-494a-a20a-974cebaa5ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA9D396CA0>]}
[0m22:24:39.172995 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.intg_stages ............... [[32mSELECT 9[0m in 2.30s]
[0m22:24:39.175478 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.intg_stages
[0m22:24:39.179782 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:39.181501 [debug] [MainThread]: On master: BEGIN
[0m22:24:39.182644 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:24:41.259954 [debug] [MainThread]: SQL status: BEGIN in 2.078 seconds
[0m22:24:41.261054 [debug] [MainThread]: On master: COMMIT
[0m22:24:41.261601 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:41.262150 [debug] [MainThread]: On master: COMMIT
[0m22:24:41.264933 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m22:24:41.266168 [debug] [MainThread]: On master: Close
[0m22:24:41.267246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:41.268350 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m22:24:41.268936 [debug] [MainThread]: Connection 'list_postgres_public_integration' was properly closed.
[0m22:24:41.269498 [debug] [MainThread]: Connection 'model.enpal_assessment_project.intg_stages' was properly closed.
[0m22:24:41.270626 [info ] [MainThread]: 
[0m22:24:41.271873 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.30 seconds (15.30s).
[0m22:24:41.274185 [debug] [MainThread]: Command end result
[0m22:24:41.457098 [info ] [MainThread]: 
[0m22:24:41.458743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:24:41.460780 [info ] [MainThread]: 
[0m22:24:41.461800 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:24:41.464847 [debug] [MainThread]: Command `dbt run` succeeded at 22:24:41.464847 after 17.73 seconds
[0m22:24:41.465911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA99C08D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA9A14E6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA9CC98FD0>]}
[0m22:24:41.467001 [debug] [MainThread]: Flushing usage events
[0m22:30:06.771525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2C6475AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2C8F87AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2C8F87850>]}


============================== 22:30:06.784028 | 8dd510c8-a67b-4461-b5ba-d347095273aa ==============================
[0m22:30:06.784028 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:30:06.785062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select intg_stagesintg_activity_types', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:30:07.186223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dd510c8-a67b-4461-b5ba-d347095273aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2C68B6310>]}
[0m22:30:07.286100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dd510c8-a67b-4461-b5ba-d347095273aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2C6E41160>]}
[0m22:30:07.289651 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:30:07.309968 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:30:07.836333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:30:07.838412 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\integration\schema.yml
[0m22:30:08.043499 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:30:08.046625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8dd510c8-a67b-4461-b5ba-d347095273aa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2C63832E0>]}
[0m22:30:08.465570 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m22:30:08.500812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dd510c8-a67b-4461-b5ba-d347095273aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2C977A460>]}
[0m22:30:08.794861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dd510c8-a67b-4461-b5ba-d347095273aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2C983A160>]}
[0m22:30:08.796311 [info ] [MainThread]: Found 13 models, 10 data tests, 7 sources, 423 macros
[0m22:30:08.797301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dd510c8-a67b-4461-b5ba-d347095273aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2C97DCCD0>]}
[0m22:30:08.798941 [warn ] [MainThread]: The selection criterion 'intg_stagesintg_activity_types' does not match any enabled nodes
[0m22:30:08.801406 [info ] [MainThread]: 
[0m22:30:08.803527 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:30:08.805197 [debug] [MainThread]: Command end result
[0m22:30:08.866163 [debug] [MainThread]: Command `dbt run` succeeded at 22:30:08.866163 after 2.21 seconds
[0m22:30:08.866801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2C6475AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2C83E74F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2C69FA640>]}
[0m22:30:08.867843 [debug] [MainThread]: Flushing usage events
[0m22:30:29.433691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CB1C5AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CB4767D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CB47674C0>]}


============================== 22:30:29.450574 | c0b17c42-62eb-452b-befb-cf42a36375e1 ==============================
[0m22:30:29.450574 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:30:29.451576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select intg_activity_types', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:30:29.857174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0b17c42-62eb-452b-befb-cf42a36375e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CB20D5220>]}
[0m22:30:29.961685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0b17c42-62eb-452b-befb-cf42a36375e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CB1B770A0>]}
[0m22:30:29.964796 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:30:29.986447 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:30:30.457416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:30:30.458830 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:30:30.475686 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m22:30:30.568567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0b17c42-62eb-452b-befb-cf42a36375e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CB4D23EE0>]}
[0m22:30:30.872802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0b17c42-62eb-452b-befb-cf42a36375e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CB4E5AC70>]}
[0m22:30:30.873828 [info ] [MainThread]: Found 13 models, 10 data tests, 7 sources, 423 macros
[0m22:30:30.874840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0b17c42-62eb-452b-befb-cf42a36375e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CB4D9DAC0>]}
[0m22:30:30.878906 [info ] [MainThread]: 
[0m22:30:30.880797 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:30:30.885353 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:30:31.129708 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:30:31.129708 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:30:31.130736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:33.224648 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.093 seconds
[0m22:30:33.226193 [debug] [ThreadPool]: On list_postgres: Close
[0m22:30:33.240716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m22:30:33.251250 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:30:33.252015 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m22:30:33.253012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:35.335724 [debug] [ThreadPool]: SQL status: BEGIN in 2.083 seconds
[0m22:30:35.336962 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m22:30:35.338096 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m22:30:35.348460 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m22:30:35.350141 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m22:30:35.353515 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m22:30:35.355200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_transformation)
[0m22:30:35.361616 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m22:30:35.362683 [debug] [ThreadPool]: On list_postgres_public_transformation: BEGIN
[0m22:30:35.363788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:37.439933 [debug] [ThreadPool]: SQL status: BEGIN in 2.076 seconds
[0m22:30:37.440477 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m22:30:37.441609 [debug] [ThreadPool]: On list_postgres_public_transformation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_transformation"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_transformation'
  
[0m22:30:37.448437 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m22:30:37.450680 [debug] [ThreadPool]: On list_postgres_public_transformation: ROLLBACK
[0m22:30:37.453435 [debug] [ThreadPool]: On list_postgres_public_transformation: Close
[0m22:30:37.455646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_transformation, now list_postgres_public_integration)
[0m22:30:37.460044 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m22:30:37.460614 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m22:30:37.461703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:39.551842 [debug] [ThreadPool]: SQL status: BEGIN in 2.090 seconds
[0m22:30:39.552391 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m22:30:39.553495 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m22:30:39.560774 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m22:30:39.562455 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m22:30:39.565826 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m22:30:39.578206 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:39.579326 [debug] [MainThread]: On master: BEGIN
[0m22:30:39.579880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:30:41.655063 [debug] [MainThread]: SQL status: BEGIN in 2.075 seconds
[0m22:30:41.656182 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:41.657310 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:30:41.668999 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m22:30:41.671816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0b17c42-62eb-452b-befb-cf42a36375e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CB4767880>]}
[0m22:30:41.672943 [debug] [MainThread]: On master: ROLLBACK
[0m22:30:41.676491 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:41.677618 [debug] [MainThread]: On master: BEGIN
[0m22:30:41.683211 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m22:30:41.684292 [debug] [MainThread]: On master: COMMIT
[0m22:30:41.684863 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:41.685450 [debug] [MainThread]: On master: COMMIT
[0m22:30:41.689044 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m22:30:41.690152 [debug] [MainThread]: On master: Close
[0m22:30:41.691574 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:30:41.693416 [info ] [MainThread]: 
[0m22:30:41.712053 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.intg_activity_types
[0m22:30:41.714056 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.intg_activity_types ............ [RUN]
[0m22:30:41.715589 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.intg_activity_types'
[0m22:30:41.717016 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.intg_activity_types
[0m22:30:41.740776 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.intg_activity_types"
[0m22:30:41.742774 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.intg_activity_types
[0m22:30:41.830507 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.intg_activity_types"
[0m22:30:41.834219 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity_types"
[0m22:30:41.835367 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: BEGIN
[0m22:30:41.836371 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:30:43.915697 [debug] [Thread-1  ]: SQL status: BEGIN in 2.079 seconds
[0m22:30:43.916799 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity_types"
[0m22:30:43.917335 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity_types"} */

  
    

  create  table "postgres"."public_integration"."intg_activity_types__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."activity_types"
  );
  
[0m22:30:43.935883 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.017 seconds
[0m22:30:43.946319 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity_types"
[0m22:30:43.946866 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity_types"} */
alter table "postgres"."public_integration"."intg_activity_types" rename to "intg_activity_types__dbt_backup"
[0m22:30:43.953179 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:30:43.958727 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity_types"
[0m22:30:43.959906 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity_types"} */
alter table "postgres"."public_integration"."intg_activity_types__dbt_tmp" rename to "intg_activity_types"
[0m22:30:43.962712 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:30:43.994956 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: COMMIT
[0m22:30:43.994956 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity_types"
[0m22:30:43.995981 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: COMMIT
[0m22:30:44.001638 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m22:30:44.012420 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."intg_activity_types__dbt_backup"
[0m22:30:44.019446 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity_types"
[0m22:30:44.020979 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity_types"} */
drop table if exists "postgres"."public_integration"."intg_activity_types__dbt_backup" cascade
[0m22:30:44.033886 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.012 seconds
[0m22:30:44.038412 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity_types: Close
[0m22:30:44.041982 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0b17c42-62eb-452b-befb-cf42a36375e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CB52DED30>]}
[0m22:30:44.044298 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.intg_activity_types ....... [[32mSELECT 4[0m in 2.32s]
[0m22:30:44.046311 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.intg_activity_types
[0m22:30:44.049878 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:44.050977 [debug] [MainThread]: On master: BEGIN
[0m22:30:44.051532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:30:46.126183 [debug] [MainThread]: SQL status: BEGIN in 2.075 seconds
[0m22:30:46.127398 [debug] [MainThread]: On master: COMMIT
[0m22:30:46.127928 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:46.128463 [debug] [MainThread]: On master: COMMIT
[0m22:30:46.131246 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m22:30:46.132381 [debug] [MainThread]: On master: Close
[0m22:30:46.133514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:30:46.134075 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m22:30:46.134637 [debug] [MainThread]: Connection 'list_postgres_public_integration' was properly closed.
[0m22:30:46.135756 [debug] [MainThread]: Connection 'model.enpal_assessment_project.intg_activity_types' was properly closed.
[0m22:30:46.136313 [info ] [MainThread]: 
[0m22:30:46.137447 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.26 seconds (15.26s).
[0m22:30:46.140366 [debug] [MainThread]: Command end result
[0m22:30:46.205945 [info ] [MainThread]: 
[0m22:30:46.207930 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:30:46.208920 [info ] [MainThread]: 
[0m22:30:46.210175 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:30:46.213732 [debug] [MainThread]: Command `dbt run` succeeded at 22:30:46.213732 after 16.90 seconds
[0m22:30:46.214739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CB1C5AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CB21F1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CB4DBEEB0>]}
[0m22:30:46.215733 [debug] [MainThread]: Flushing usage events
[0m00:15:41.723620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002755FB7AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027562687760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027562687A30>]}


============================== 00:15:41.760632 | 8eb7aa93-06b6-48ed-ae61-03dab17f4e81 ==============================
[0m00:15:41.760632 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:15:41.764159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select intg_activity', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:15:42.350642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8eb7aa93-06b6-48ed-ae61-03dab17f4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002755FFB5220>]}
[0m00:15:42.443424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8eb7aa93-06b6-48ed-ae61-03dab17f4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756053E1C0>]}
[0m00:15:42.446958 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:15:42.513831 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:15:45.972154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:15:45.973154 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\integration\schema.yml
[0m00:15:46.083691 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:15:46.084687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8eb7aa93-06b6-48ed-ae61-03dab17f4e81', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002755FA83220>]}
[0m00:15:46.533259 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m00:15:46.569377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8eb7aa93-06b6-48ed-ae61-03dab17f4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027562E48700>]}
[0m00:15:46.978057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8eb7aa93-06b6-48ed-ae61-03dab17f4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027562E98310>]}
[0m00:15:46.979056 [info ] [MainThread]: Found 13 models, 24 data tests, 7 sources, 423 macros
[0m00:15:46.981056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8eb7aa93-06b6-48ed-ae61-03dab17f4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027562EAC520>]}
[0m00:15:46.984565 [info ] [MainThread]: 
[0m00:15:46.986585 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:15:46.991099 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:15:54.173969 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:15:54.175982 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:15:54.175982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:56.380277 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.203 seconds
[0m00:15:56.382503 [debug] [ThreadPool]: On list_postgres: Close
[0m00:15:56.395374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_transformation'
[0m00:15:56.405711 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m00:15:56.406231 [debug] [ThreadPool]: On list_postgres_public_transformation: BEGIN
[0m00:15:56.407242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:58.536500 [debug] [ThreadPool]: SQL status: BEGIN in 2.129 seconds
[0m00:15:58.537692 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m00:15:58.539260 [debug] [ThreadPool]: On list_postgres_public_transformation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_transformation"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_transformation'
  
[0m00:15:58.588935 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.048 seconds
[0m00:15:58.592504 [debug] [ThreadPool]: On list_postgres_public_transformation: ROLLBACK
[0m00:15:58.596592 [debug] [ThreadPool]: On list_postgres_public_transformation: Close
[0m00:15:58.598601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_transformation, now list_postgres_public_pipedrive_analytics)
[0m00:15:58.605633 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m00:15:58.606303 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m00:15:58.607896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:00.715928 [debug] [ThreadPool]: SQL status: BEGIN in 2.108 seconds
[0m00:16:00.717045 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m00:16:00.717619 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m00:16:00.726722 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m00:16:00.728886 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m00:16:00.731647 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m00:16:00.733272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_integration)
[0m00:16:00.738833 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m00:16:00.739967 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m00:16:00.741114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:02.807299 [debug] [ThreadPool]: SQL status: BEGIN in 2.066 seconds
[0m00:16:02.808394 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m00:16:02.808941 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m00:16:02.817258 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m00:16:02.820324 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m00:16:02.824728 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m00:16:02.835953 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:02.836969 [debug] [MainThread]: On master: BEGIN
[0m00:16:02.837969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:16:04.918212 [debug] [MainThread]: SQL status: BEGIN in 2.080 seconds
[0m00:16:04.919232 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:04.919748 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:16:04.950025 [debug] [MainThread]: SQL status: SELECT 0 in 0.028 seconds
[0m00:16:04.951658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8eb7aa93-06b6-48ed-ae61-03dab17f4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027562F94280>]}
[0m00:16:04.952769 [debug] [MainThread]: On master: ROLLBACK
[0m00:16:04.955528 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:04.957214 [debug] [MainThread]: On master: BEGIN
[0m00:16:04.962309 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:16:04.962840 [debug] [MainThread]: On master: COMMIT
[0m00:16:04.963374 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:04.963923 [debug] [MainThread]: On master: COMMIT
[0m00:16:04.966614 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:16:04.967163 [debug] [MainThread]: On master: Close
[0m00:16:04.968234 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:16:04.969873 [info ] [MainThread]: 
[0m00:16:05.009945 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.intg_activity
[0m00:16:05.011971 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.intg_activity .................. [RUN]
[0m00:16:05.014009 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.intg_activity'
[0m00:16:05.014009 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.intg_activity
[0m00:16:05.030266 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.intg_activity"
[0m00:16:05.035290 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.intg_activity
[0m00:16:05.182743 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.intg_activity"
[0m00:16:05.188282 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity"
[0m00:16:05.189269 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: BEGIN
[0m00:16:05.189269 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:16:07.252946 [debug] [Thread-1  ]: SQL status: BEGIN in 2.063 seconds
[0m00:16:07.253487 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity"
[0m00:16:07.254584 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity"} */

  
    

  create  table "postgres"."public_integration"."intg_activity__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m00:16:07.389784 [debug] [Thread-1  ]: SQL status: SELECT 4579 in 0.134 seconds
[0m00:16:07.400279 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity"
[0m00:16:07.400860 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity"} */
alter table "postgres"."public_integration"."intg_activity" rename to "intg_activity__dbt_backup"
[0m00:16:07.408969 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.007 seconds
[0m00:16:07.414376 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity"
[0m00:16:07.415554 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity"} */
alter table "postgres"."public_integration"."intg_activity__dbt_tmp" rename to "intg_activity"
[0m00:16:07.419467 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:16:07.450614 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: COMMIT
[0m00:16:07.450614 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity"
[0m00:16:07.451609 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: COMMIT
[0m00:16:07.469224 [debug] [Thread-1  ]: SQL status: COMMIT in 0.017 seconds
[0m00:16:07.479778 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."intg_activity__dbt_backup"
[0m00:16:07.485795 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_activity"
[0m00:16:07.487308 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_activity"} */
drop table if exists "postgres"."public_integration"."intg_activity__dbt_backup" cascade
[0m00:16:07.524945 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.036 seconds
[0m00:16:07.528719 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_activity: Close
[0m00:16:07.531525 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eb7aa93-06b6-48ed-ae61-03dab17f4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756333BA60>]}
[0m00:16:07.533165 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.intg_activity ............. [[32mSELECT 4579[0m in 2.52s]
[0m00:16:07.534857 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.intg_activity
[0m00:16:07.538116 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:07.538673 [debug] [MainThread]: On master: BEGIN
[0m00:16:07.540200 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:16:09.624091 [debug] [MainThread]: SQL status: BEGIN in 2.084 seconds
[0m00:16:09.624615 [debug] [MainThread]: On master: COMMIT
[0m00:16:09.625746 [debug] [MainThread]: Using postgres connection "master"
[0m00:16:09.626302 [debug] [MainThread]: On master: COMMIT
[0m00:16:09.629847 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:16:09.630936 [debug] [MainThread]: On master: Close
[0m00:16:09.632047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:09.633577 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:16:09.634688 [debug] [MainThread]: Connection 'list_postgres_public_integration' was properly closed.
[0m00:16:09.635703 [debug] [MainThread]: Connection 'model.enpal_assessment_project.intg_activity' was properly closed.
[0m00:16:09.636710 [info ] [MainThread]: 
[0m00:16:09.638649 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.65 seconds (22.65s).
[0m00:16:09.641302 [debug] [MainThread]: Command end result
[0m00:16:09.726543 [info ] [MainThread]: 
[0m00:16:09.728573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:16:09.730571 [info ] [MainThread]: 
[0m00:16:09.732567 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:16:09.735269 [debug] [MainThread]: Command `dbt run` succeeded at 00:16:09.735269 after 28.20 seconds
[0m00:16:09.737157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002755FB7AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027561AEF4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756010C640>]}
[0m00:16:09.738839 [debug] [MainThread]: Flushing usage events
[0m00:17:10.518954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CDFDE8AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CE28F7AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CE28F7850>]}


============================== 00:17:10.531142 | b6cd1454-5a2d-47a8-9738-7ee544e1e311 ==============================
[0m00:17:10.531142 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:17:10.532142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select intg_users', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:17:10.873926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6cd1454-5a2d-47a8-9738-7ee544e1e311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CE026F310>]}
[0m00:17:10.963420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6cd1454-5a2d-47a8-9738-7ee544e1e311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CE07AE160>]}
[0m00:17:10.965921 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:17:10.983641 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:17:11.453687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:17:11.454704 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:17:11.464230 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m00:17:11.548401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6cd1454-5a2d-47a8-9738-7ee544e1e311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CE2F13AC0>]}
[0m00:17:11.830793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6cd1454-5a2d-47a8-9738-7ee544e1e311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CE30146D0>]}
[0m00:17:11.831785 [info ] [MainThread]: Found 13 models, 24 data tests, 7 sources, 423 macros
[0m00:17:11.832786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6cd1454-5a2d-47a8-9738-7ee544e1e311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CE2F30220>]}
[0m00:17:11.836795 [info ] [MainThread]: 
[0m00:17:11.838789 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:17:11.843009 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:17:12.034033 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:17:12.035036 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:17:12.036035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:14.117235 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.081 seconds
[0m00:17:14.119992 [debug] [ThreadPool]: On list_postgres: Close
[0m00:17:14.132858 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_integration'
[0m00:17:14.147743 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m00:17:14.148749 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m00:17:14.149749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:16.232680 [debug] [ThreadPool]: SQL status: BEGIN in 2.083 seconds
[0m00:17:16.233907 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m00:17:16.235053 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m00:17:16.244347 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m00:17:16.246652 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m00:17:16.250076 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m00:17:16.252279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_integration, now list_postgres_public_transformation)
[0m00:17:16.260062 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m00:17:16.261149 [debug] [ThreadPool]: On list_postgres_public_transformation: BEGIN
[0m00:17:16.261663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:18.323280 [debug] [ThreadPool]: SQL status: BEGIN in 2.062 seconds
[0m00:17:18.324370 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m00:17:18.324908 [debug] [ThreadPool]: On list_postgres_public_transformation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_transformation"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_transformation'
  
[0m00:17:18.336113 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m00:17:18.338974 [debug] [ThreadPool]: On list_postgres_public_transformation: ROLLBACK
[0m00:17:18.342458 [debug] [ThreadPool]: On list_postgres_public_transformation: Close
[0m00:17:18.344707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_transformation, now list_postgres_public_pipedrive_analytics)
[0m00:17:18.350297 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m00:17:18.350877 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m00:17:18.352033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:20.431068 [debug] [ThreadPool]: SQL status: BEGIN in 2.079 seconds
[0m00:17:20.432736 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m00:17:20.433292 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m00:17:20.446216 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m00:17:20.450136 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m00:17:20.453638 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m00:17:20.466705 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:20.467706 [debug] [MainThread]: On master: BEGIN
[0m00:17:20.469228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:17:22.530028 [debug] [MainThread]: SQL status: BEGIN in 2.061 seconds
[0m00:17:22.531134 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:22.532770 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:17:22.542504 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m00:17:22.544786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6cd1454-5a2d-47a8-9738-7ee544e1e311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CE28F7880>]}
[0m00:17:22.545886 [debug] [MainThread]: On master: ROLLBACK
[0m00:17:22.549186 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:22.549751 [debug] [MainThread]: On master: BEGIN
[0m00:17:22.554711 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:17:22.555787 [debug] [MainThread]: On master: COMMIT
[0m00:17:22.556347 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:22.556900 [debug] [MainThread]: On master: COMMIT
[0m00:17:22.559083 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:17:22.560327 [debug] [MainThread]: On master: Close
[0m00:17:22.561335 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:17:22.563026 [info ] [MainThread]: 
[0m00:17:22.577395 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.intg_users
[0m00:17:22.578473 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.intg_users ..................... [RUN]
[0m00:17:22.580040 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.intg_users'
[0m00:17:22.582045 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.intg_users
[0m00:17:22.598812 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.intg_users"
[0m00:17:22.602809 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.intg_users
[0m00:17:22.669566 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.intg_users"
[0m00:17:22.672570 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_users"
[0m00:17:22.673571 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_users: BEGIN
[0m00:17:22.674565 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:17:24.753080 [debug] [Thread-1  ]: SQL status: BEGIN in 2.078 seconds
[0m00:17:24.754158 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_users"
[0m00:17:24.754705 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_users"} */

  
    

  create  table "postgres"."public_integration"."intg_users__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."users"
  );
  
[0m00:17:24.803907 [debug] [Thread-1  ]: SQL status: SELECT 1787 in 0.049 seconds
[0m00:17:24.817948 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_users"
[0m00:17:24.818951 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_users"} */
alter table "postgres"."public_integration"."intg_users" rename to "intg_users__dbt_backup"
[0m00:17:24.823924 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:17:24.829329 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_users"
[0m00:17:24.830409 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_users"} */
alter table "postgres"."public_integration"."intg_users__dbt_tmp" rename to "intg_users"
[0m00:17:24.835116 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m00:17:24.867939 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_users: COMMIT
[0m00:17:24.868940 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_users"
[0m00:17:24.869621 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_users: COMMIT
[0m00:17:24.878257 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m00:17:24.889985 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."intg_users__dbt_backup"
[0m00:17:24.898024 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_users"
[0m00:17:24.899038 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_users"} */
drop table if exists "postgres"."public_integration"."intg_users__dbt_backup" cascade
[0m00:17:24.920711 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.020 seconds
[0m00:17:24.924484 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_users: Close
[0m00:17:24.927854 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6cd1454-5a2d-47a8-9738-7ee544e1e311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CE3409CD0>]}
[0m00:17:24.929511 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.intg_users ................ [[32mSELECT 1787[0m in 2.35s]
[0m00:17:24.931156 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.intg_users
[0m00:17:24.934416 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:24.935541 [debug] [MainThread]: On master: BEGIN
[0m00:17:24.936635 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:17:26.998999 [debug] [MainThread]: SQL status: BEGIN in 2.062 seconds
[0m00:17:26.999517 [debug] [MainThread]: On master: COMMIT
[0m00:17:27.000739 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:27.001833 [debug] [MainThread]: On master: COMMIT
[0m00:17:27.004589 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:17:27.005670 [debug] [MainThread]: On master: Close
[0m00:17:27.006733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:27.007283 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:17:27.007862 [debug] [MainThread]: Connection 'list_postgres_public_pipedrive_analytics' was properly closed.
[0m00:17:27.008415 [debug] [MainThread]: Connection 'model.enpal_assessment_project.intg_users' was properly closed.
[0m00:17:27.008964 [info ] [MainThread]: 
[0m00:17:27.010020 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.17 seconds (15.17s).
[0m00:17:27.012797 [debug] [MainThread]: Command end result
[0m00:17:27.078495 [info ] [MainThread]: 
[0m00:17:27.080499 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:17:27.082021 [info ] [MainThread]: 
[0m00:17:27.083036 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:17:27.086035 [debug] [MainThread]: Command `dbt run` succeeded at 00:17:27.086035 after 16.68 seconds
[0m00:17:27.087031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CDFDE8AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CE03BC1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CE036C640>]}
[0m00:17:27.088035 [debug] [MainThread]: Flushing usage events
[0m00:18:26.904622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255565D9D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255590E8F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002555540BBE0>]}


============================== 00:18:26.918690 | 56f870c2-1b9c-4faa-b3b4-360f0f47ef41 ==============================
[0m00:18:26.918690 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:18:26.920209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select intg_fields', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:18:27.242980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56f870c2-1b9c-4faa-b3b4-360f0f47ef41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002555654EFD0>]}
[0m00:18:27.331320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56f870c2-1b9c-4faa-b3b4-360f0f47ef41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255590800A0>]}
[0m00:18:27.334336 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:18:27.357933 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:18:27.776960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:18:27.777965 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:18:27.793028 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m00:18:27.893114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56f870c2-1b9c-4faa-b3b4-360f0f47ef41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025559706BE0>]}
[0m00:18:28.197782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56f870c2-1b9c-4faa-b3b4-360f0f47ef41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025559805730>]}
[0m00:18:28.198780 [info ] [MainThread]: Found 13 models, 24 data tests, 7 sources, 423 macros
[0m00:18:28.200779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56f870c2-1b9c-4faa-b3b4-360f0f47ef41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255597380D0>]}
[0m00:18:28.204782 [info ] [MainThread]: 
[0m00:18:28.207320 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:18:28.211321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:18:28.414278 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:18:28.415278 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:18:28.415278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:30.511317 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.095 seconds
[0m00:18:30.513570 [debug] [ThreadPool]: On list_postgres: Close
[0m00:18:30.525549 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m00:18:30.538804 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m00:18:30.539805 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m00:18:30.540805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:32.619227 [debug] [ThreadPool]: SQL status: BEGIN in 2.079 seconds
[0m00:18:32.620330 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m00:18:32.620875 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m00:18:32.628959 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m00:18:32.631069 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m00:18:32.634596 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m00:18:32.636792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_integration)
[0m00:18:32.645093 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m00:18:32.645639 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m00:18:32.646650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:34.740022 [debug] [ThreadPool]: SQL status: BEGIN in 2.093 seconds
[0m00:18:34.740562 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m00:18:34.741097 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m00:18:34.750716 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m00:18:34.752263 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m00:18:34.755794 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m00:18:34.758013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_integration, now list_postgres_public_transformation)
[0m00:18:34.766373 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m00:18:34.767506 [debug] [ThreadPool]: On list_postgres_public_transformation: BEGIN
[0m00:18:34.768596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:36.846765 [debug] [ThreadPool]: SQL status: BEGIN in 2.078 seconds
[0m00:18:36.847888 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m00:18:36.848443 [debug] [ThreadPool]: On list_postgres_public_transformation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_transformation"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_transformation'
  
[0m00:18:36.856267 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m00:18:36.857874 [debug] [ThreadPool]: On list_postgres_public_transformation: ROLLBACK
[0m00:18:36.861229 [debug] [ThreadPool]: On list_postgres_public_transformation: Close
[0m00:18:36.874107 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:36.875796 [debug] [MainThread]: On master: BEGIN
[0m00:18:36.876928 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:38.948168 [debug] [MainThread]: SQL status: BEGIN in 2.071 seconds
[0m00:18:38.949228 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:38.949766 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:18:38.958708 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m00:18:38.961352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56f870c2-1b9c-4faa-b3b4-360f0f47ef41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002555983E040>]}
[0m00:18:38.961897 [debug] [MainThread]: On master: ROLLBACK
[0m00:18:38.965235 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:38.966399 [debug] [MainThread]: On master: BEGIN
[0m00:18:38.971410 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:18:38.972497 [debug] [MainThread]: On master: COMMIT
[0m00:18:38.973062 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:38.974168 [debug] [MainThread]: On master: COMMIT
[0m00:18:38.976914 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:18:38.978000 [debug] [MainThread]: On master: Close
[0m00:18:38.979659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:18:38.981196 [info ] [MainThread]: 
[0m00:18:38.999517 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.intg_fields
[0m00:18:39.001524 [info ] [Thread-1  ]: 1 of 1 START sql table model public_integration.intg_fields .................... [RUN]
[0m00:18:39.003519 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.intg_fields'
[0m00:18:39.004524 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.intg_fields
[0m00:18:39.022726 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.intg_fields"
[0m00:18:39.026721 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.intg_fields
[0m00:18:39.126799 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.intg_fields"
[0m00:18:39.133814 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_fields"
[0m00:18:39.134847 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_fields: BEGIN
[0m00:18:39.136872 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:18:41.214252 [debug] [Thread-1  ]: SQL status: BEGIN in 2.077 seconds
[0m00:18:41.215339 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_fields"
[0m00:18:41.215883 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_fields: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_fields"} */

  
    

  create  table "postgres"."public_integration"."intg_fields__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "postgres"."public"."fields"
  );
  
[0m00:18:41.232975 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.016 seconds
[0m00:18:41.250949 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_fields"
[0m00:18:41.252457 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_fields: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_fields"} */
alter table "postgres"."public_integration"."intg_fields" rename to "intg_fields__dbt_backup"
[0m00:18:41.257452 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m00:18:41.264062 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_fields"
[0m00:18:41.265214 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_fields: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_fields"} */
alter table "postgres"."public_integration"."intg_fields__dbt_tmp" rename to "intg_fields"
[0m00:18:41.269237 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:18:41.318559 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_fields: COMMIT
[0m00:18:41.319664 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_fields"
[0m00:18:41.320750 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_fields: COMMIT
[0m00:18:41.327715 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m00:18:41.339738 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_integration"."intg_fields__dbt_backup"
[0m00:18:41.350357 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.intg_fields"
[0m00:18:41.351439 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_fields: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.intg_fields"} */
drop table if exists "postgres"."public_integration"."intg_fields__dbt_backup" cascade
[0m00:18:41.365603 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.013 seconds
[0m00:18:41.369429 [debug] [Thread-1  ]: On model.enpal_assessment_project.intg_fields: Close
[0m00:18:41.373887 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56f870c2-1b9c-4faa-b3b4-360f0f47ef41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025559BCD670>]}
[0m00:18:41.376153 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_integration.intg_fields ............... [[32mSELECT 4[0m in 2.37s]
[0m00:18:41.378799 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.intg_fields
[0m00:18:41.382221 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:41.383360 [debug] [MainThread]: On master: BEGIN
[0m00:18:41.384456 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:43.464549 [debug] [MainThread]: SQL status: BEGIN in 2.080 seconds
[0m00:18:43.465796 [debug] [MainThread]: On master: COMMIT
[0m00:18:43.466347 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:43.466903 [debug] [MainThread]: On master: COMMIT
[0m00:18:43.470350 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:18:43.471443 [debug] [MainThread]: On master: Close
[0m00:18:43.473121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:43.474270 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:18:43.475363 [debug] [MainThread]: Connection 'list_postgres_public_transformation' was properly closed.
[0m00:18:43.476534 [debug] [MainThread]: Connection 'model.enpal_assessment_project.intg_fields' was properly closed.
[0m00:18:43.477668 [info ] [MainThread]: 
[0m00:18:43.479370 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.27 seconds (15.27s).
[0m00:18:43.481746 [debug] [MainThread]: Command end result
[0m00:18:43.572602 [info ] [MainThread]: 
[0m00:18:43.574206 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:18:43.576222 [info ] [MainThread]: 
[0m00:18:43.577220 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:18:43.580762 [debug] [MainThread]: Command `dbt run` succeeded at 00:18:43.579740 after 16.77 seconds
[0m00:18:43.581758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255565D9D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025556B912B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025556B65280>]}
[0m00:18:43.582764 [debug] [MainThread]: Flushing usage events
[0m01:44:29.735177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F25339D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F25C787C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F27DD2250>]}


============================== 01:44:29.749388 | e14a9316-4ce4-48f5-99a7-338e43ae48d6 ==============================
[0m01:44:29.749388 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:44:29.753382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select trf_deal_milestones', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:44:30.214862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e14a9316-4ce4-48f5-99a7-338e43ae48d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F25781400>]}
[0m01:44:30.313654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e14a9316-4ce4-48f5-99a7-338e43ae48d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F27DD2DC0>]}
[0m01:44:30.317670 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:44:30.338999 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:44:30.887806 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 2 files added, 0 files changed.
[0m01:44:30.889805 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformation\trf_deal_milestones.sql
[0m01:44:30.889805 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformation\trans.yml
[0m01:44:30.890809 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models\transformation\trf_deal_changes.sql
[0m01:44:30.891803 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models\transformation\trf_stages.sql
[0m01:44:30.892809 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models\transformation\trf_activity_types.sql
[0m01:44:30.893433 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models\transformation\trf_activity.sql
[0m01:44:30.894453 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models\transformation\trf_users.sql
[0m01:44:30.894970 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models\transformation\trf_fields.sql
[0m01:44:31.324340 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:44:31.326952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e14a9316-4ce4-48f5-99a7-338e43ae48d6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F252602B0>]}
[0m01:44:31.672325 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.integration
[0m01:44:31.704930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e14a9316-4ce4-48f5-99a7-338e43ae48d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F2877A790>]}
[0m01:44:32.022533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e14a9316-4ce4-48f5-99a7-338e43ae48d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F2875C7F0>]}
[0m01:44:32.023532 [info ] [MainThread]: Found 8 models, 27 data tests, 7 sources, 423 macros
[0m01:44:32.024536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e14a9316-4ce4-48f5-99a7-338e43ae48d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F28763850>]}
[0m01:44:32.028062 [info ] [MainThread]: 
[0m01:44:32.030058 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:44:32.034058 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:44:32.264679 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:44:32.265679 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:44:32.265679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:34.506162 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.240 seconds
[0m01:44:34.509471 [debug] [ThreadPool]: On list_postgres: Close
[0m01:44:34.523242 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_integration'
[0m01:44:34.616023 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m01:44:34.617014 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m01:44:34.618016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:36.705790 [debug] [ThreadPool]: SQL status: BEGIN in 2.087 seconds
[0m01:44:36.706883 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m01:44:36.707427 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m01:44:36.750839 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.043 seconds
[0m01:44:36.753035 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m01:44:36.756441 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m01:44:36.758204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_integration, now list_postgres_public_pipedrive_analytics)
[0m01:44:36.765738 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:44:36.766788 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m01:44:36.767324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:44:38.852681 [debug] [ThreadPool]: SQL status: BEGIN in 2.085 seconds
[0m01:44:38.853817 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:44:38.854528 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m01:44:38.864911 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m01:44:38.868324 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m01:44:38.871884 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m01:44:38.885346 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:38.886864 [debug] [MainThread]: On master: BEGIN
[0m01:44:38.887888 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:44:40.969696 [debug] [MainThread]: SQL status: BEGIN in 2.082 seconds
[0m01:44:40.970774 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:40.971317 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:44:41.011669 [debug] [MainThread]: SQL status: SELECT 0 in 0.039 seconds
[0m01:44:41.013892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e14a9316-4ce4-48f5-99a7-338e43ae48d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F28649250>]}
[0m01:44:41.015018 [debug] [MainThread]: On master: ROLLBACK
[0m01:44:41.017894 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:41.019023 [debug] [MainThread]: On master: BEGIN
[0m01:44:41.023528 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:44:41.024777 [debug] [MainThread]: On master: COMMIT
[0m01:44:41.025958 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:41.026533 [debug] [MainThread]: On master: COMMIT
[0m01:44:41.029489 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:44:41.030583 [debug] [MainThread]: On master: Close
[0m01:44:41.031742 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:44:41.033424 [info ] [MainThread]: 
[0m01:44:41.055192 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.trf_deal_milestones
[0m01:44:41.056208 [info ] [Thread-1  ]: 1 of 1 START sql table model public_pipedrive_analytics.trf_deal_milestones .... [RUN]
[0m01:44:41.058204 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.trf_deal_milestones'
[0m01:44:41.059199 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.trf_deal_milestones
[0m01:44:41.080895 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.trf_deal_milestones"
[0m01:44:41.087078 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.trf_deal_milestones
[0m01:44:41.152768 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.trf_deal_milestones"
[0m01:44:41.158303 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m01:44:41.159307 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: BEGIN
[0m01:44:41.160297 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m01:44:43.229508 [debug] [Thread-1  ]: SQL status: BEGIN in 2.069 seconds
[0m01:44:43.230593 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m01:44:43.231690 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.trf_deal_milestones"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."trf_deal_milestones__dbt_tmp"
  
  
    as
  
  (
    /*
    Model: trf_deal_milestones
    
    Purpose:
        Captures deal lifecycle milestones including stage progression,
        creation timestamp, and outcome metadata. Combines all key
        temporal and outcome data points for each deal.
    
    Grain: One row per deal
    
    Business Logic:
        - Pivots stage transitions to wide format (9 stage columns)
        - Extracts deal creation timestamp from add_time events
        - Captures latest lost_reason if deal was lost BEFORE winning
        - Filters out spurious lost_reasons set after deals reached stage 9
        - One row per deal with all temporal milestones
*/

with stage_changes as (

    select
        deal_id,
        new_value as stage_id,
        change_time as stage_reached_at

    from "postgres"."public_integration"."intg_deal_changes"
    
    where changed_field_key = 'stage_id'

),

creation_times as (

    select
        deal_id,
        min(change_time) as created_at

    from "postgres"."public_integration"."intg_deal_changes"
    
    where changed_field_key = 'add_time'
    
    group by deal_id

),

stage_9_times as (

    -- Get the timestamp when each deal reached stage 9 (won)
    -- Used to filter out lost_reasons that were set AFTER winning
    select
        deal_id,
        min(change_time) as stage_9_reached_at

    from "postgres"."public_integration"."intg_deal_changes"
    
    where changed_field_key = 'stage_id'
      and new_value = '9'
    
    group by deal_id

),

lost_reasons_raw as (

    -- Extract lost_reasons, but only those set BEFORE stage 9 (or if never reached stage 9)
    -- Data quality issue: All won deals have lost_reasons set 1-39 days AFTER winning, these are filtered out
    select
        lost_reasons.deal_id,
        lost_reasons.new_value as lost_reason_id,
        lost_reasons.change_time,
        s9.stage_9_reached_at,
       
        row_number() 
            over (partition by lost_reasons.deal_id order by lost_reasons.change_time desc) as row_number

    from "postgres"."public_integration"."intg_deal_changes" as lost_reasons
    
    left join stage_9_times as s9 
        on lost_reasons.deal_id = s9.deal_id
    
    where lost_reasons.changed_field_key = 'lost_reason'
      -- Only include lost_reasons set BEFORE stage 9 (or if never reached stage 9)
      and (s9.stage_9_reached_at is null 
           or lost_reasons.change_time <= s9.stage_9_reached_at)

),


lost_reasons as (
    
    -- Take the most recent valid lost_reason per deal
    select
        deal_id,
        lost_reason_id

    from lost_reasons_raw
    
    where row_number = 1

),


stage_pivot as (

    -- Pivot stage changes to wide format: one column per stage
    select
        deal_id,
        
        min(case when stage_id = '1' then stage_reached_at end) as stage_1_reached_at,
        min(case when stage_id = '2' then stage_reached_at end) as stage_2_reached_at,
        min(case when stage_id = '3' then stage_reached_at end) as stage_3_reached_at,
        min(case when stage_id = '4' then stage_reached_at end) as stage_4_reached_at,
        min(case when stage_id = '5' then stage_reached_at end) as stage_5_reached_at,
        min(case when stage_id = '6' then stage_reached_at end) as stage_6_reached_at,
        min(case when stage_id = '7' then stage_reached_at end) as stage_7_reached_at,
        min(case when stage_id = '8' then stage_reached_at end) as stage_8_reached_at,
        min(case when stage_id = '9' then stage_reached_at end) as stage_9_reached_at

    from stage_changes
    
    group by deal_id

),

final as (

    select
        pivot.deal_id,
        
        -- Creation timestamp
        creation_times.created_at,
        
        -- Stage milestones
        pivot.stage_1_reached_at,
        pivot.stage_2_reached_at,
        pivot.stage_3_reached_at,
        pivot.stage_4_reached_at,
        pivot.stage_5_reached_at,
        pivot.stage_6_reached_at,
        pivot.stage_7_reached_at,
        pivot.stage_8_reached_at,
        pivot.stage_9_reached_at,
        
        -- Outcome metadata
        lost_reasons.lost_reason_id

    from stage_pivot as pivot
    
    left join creation_times 
        on pivot.deal_id = creation_times.deal_id

    left join lost_reasons 
        on pivot.deal_id = lost_reasons.deal_id

)

select * from final
  );
  
[0m01:44:43.440668 [debug] [Thread-1  ]: SQL status: SELECT 1995 in 0.207 seconds
[0m01:44:43.450401 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m01:44:43.451857 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.trf_deal_milestones"} */
alter table "postgres"."public_pipedrive_analytics"."trf_deal_milestones__dbt_tmp" rename to "trf_deal_milestones"
[0m01:44:43.457918 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.005 seconds
[0m01:44:43.487067 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: COMMIT
[0m01:44:43.488069 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m01:44:43.488069 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: COMMIT
[0m01:44:43.499063 [debug] [Thread-1  ]: SQL status: COMMIT in 0.009 seconds
[0m01:44:43.509311 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."trf_deal_milestones__dbt_backup"
[0m01:44:43.518143 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m01:44:43.519141 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.trf_deal_milestones"} */
drop table if exists "postgres"."public_pipedrive_analytics"."trf_deal_milestones__dbt_backup" cascade
[0m01:44:43.524929 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m01:44:43.529433 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: Close
[0m01:44:43.532706 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e14a9316-4ce4-48f5-99a7-338e43ae48d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F25309460>]}
[0m01:44:43.533821 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_pipedrive_analytics.trf_deal_milestones  [[32mSELECT 1995[0m in 2.47s]
[0m01:44:43.535974 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.trf_deal_milestones
[0m01:44:43.540506 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:43.541527 [debug] [MainThread]: On master: BEGIN
[0m01:44:43.543047 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:44:45.616383 [debug] [MainThread]: SQL status: BEGIN in 2.073 seconds
[0m01:44:45.616928 [debug] [MainThread]: On master: COMMIT
[0m01:44:45.617996 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:45.618528 [debug] [MainThread]: On master: COMMIT
[0m01:44:45.621275 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:44:45.621816 [debug] [MainThread]: On master: Close
[0m01:44:45.622909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:44:45.624016 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m01:44:45.624583 [debug] [MainThread]: Connection 'list_postgres_public_pipedrive_analytics' was properly closed.
[0m01:44:45.625127 [debug] [MainThread]: Connection 'model.enpal_assessment_project.trf_deal_milestones' was properly closed.
[0m01:44:45.625663 [info ] [MainThread]: 
[0m01:44:45.626765 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.60 seconds (13.60s).
[0m01:44:45.629579 [debug] [MainThread]: Command end result
[0m01:44:45.702187 [info ] [MainThread]: 
[0m01:44:45.704192 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:44:45.705193 [info ] [MainThread]: 
[0m01:44:45.707190 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:44:45.709913 [debug] [MainThread]: Command `dbt run` succeeded at 01:44:45.708887 after 16.08 seconds
[0m01:44:45.711422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F25339D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F2861D8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F258CD280>]}
[0m01:44:45.712439 [debug] [MainThread]: Flushing usage events
[0m01:48:56.832234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025381A69D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253823A87C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025384507250>]}


============================== 01:48:56.846539 | 2a91badd-0a04-4039-8966-54f31b3872af ==============================
[0m01:48:56.846539 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:48:56.848228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select trf_deal_milestones', 'send_anonymous_usage_stats': 'True'}
[0m01:48:57.255390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a91badd-0a04-4039-8966-54f31b3872af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025381EB3400>]}
[0m01:48:57.358929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a91badd-0a04-4039-8966-54f31b3872af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538431D5B0>]}
[0m01:48:57.361972 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:48:57.384825 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:48:57.626321 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:48:57.628323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2a91badd-0a04-4039-8966-54f31b3872af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253839D8490>]}
[0m01:48:59.860784 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:48:59.862990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2a91badd-0a04-4039-8966-54f31b3872af', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025384C3E2E0>]}
[0m01:49:00.477612 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.transformation
- models.integration
[0m01:49:00.512798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a91badd-0a04-4039-8966-54f31b3872af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025384DD9E20>]}
[0m01:49:00.823219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a91badd-0a04-4039-8966-54f31b3872af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025384E27790>]}
[0m01:49:00.824731 [info ] [MainThread]: Found 8 models, 27 data tests, 7 sources, 423 macros
[0m01:49:00.826419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a91badd-0a04-4039-8966-54f31b3872af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025384DE0760>]}
[0m01:49:00.830441 [info ] [MainThread]: 
[0m01:49:00.832440 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:49:00.835969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:49:01.074640 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:49:01.075298 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:49:01.076309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:49:03.194635 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.118 seconds
[0m01:49:03.197349 [debug] [ThreadPool]: On list_postgres: Close
[0m01:49:03.208312 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_integration'
[0m01:49:03.218079 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m01:49:03.219074 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m01:49:03.220074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:49:05.292609 [debug] [ThreadPool]: SQL status: BEGIN in 2.072 seconds
[0m01:49:05.293669 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m01:49:05.294748 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m01:49:05.302526 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m01:49:05.305183 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m01:49:05.308816 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m01:49:05.310485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_integration, now list_postgres_public_pipedrive_analytics)
[0m01:49:05.319895 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:49:05.320906 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m01:49:05.322428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:49:07.391031 [debug] [ThreadPool]: SQL status: BEGIN in 2.068 seconds
[0m01:49:07.392077 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:49:07.392614 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m01:49:07.400373 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m01:49:07.401972 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m01:49:07.404966 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m01:49:07.416833 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:07.417502 [debug] [MainThread]: On master: BEGIN
[0m01:49:07.418045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:49:09.467410 [debug] [MainThread]: SQL status: BEGIN in 2.049 seconds
[0m01:49:09.469051 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:09.470173 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:49:09.478769 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m01:49:09.480912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a91badd-0a04-4039-8966-54f31b3872af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025384EF61F0>]}
[0m01:49:09.482019 [debug] [MainThread]: On master: ROLLBACK
[0m01:49:09.485454 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:09.486529 [debug] [MainThread]: On master: BEGIN
[0m01:49:09.490936 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:49:09.492032 [debug] [MainThread]: On master: COMMIT
[0m01:49:09.492614 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:09.493196 [debug] [MainThread]: On master: COMMIT
[0m01:49:09.496844 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:49:09.497405 [debug] [MainThread]: On master: Close
[0m01:49:09.499205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:49:09.500846 [info ] [MainThread]: 
[0m01:49:09.522285 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.trf_deal_milestones
[0m01:49:09.523286 [info ] [Thread-1  ]: 1 of 1 START sql table model public_pipedrive_analytics.trf_deal_milestones .... [RUN]
[0m01:49:09.525804 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.trf_deal_milestones'
[0m01:49:09.526820 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.trf_deal_milestones
[0m01:49:09.549581 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.trf_deal_milestones"
[0m01:49:09.553583 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.trf_deal_milestones
[0m01:49:09.622098 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.trf_deal_milestones"
[0m01:49:09.626118 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m01:49:09.626118 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: BEGIN
[0m01:49:09.627108 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m01:49:11.686868 [debug] [Thread-1  ]: SQL status: BEGIN in 2.059 seconds
[0m01:49:11.688517 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m01:49:11.689611 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.trf_deal_milestones"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."trf_deal_milestones__dbt_tmp"
  
  
    as
  
  (
    /*
    Model: trf_deal_milestones
    
    Purpose:
        Captures deal lifecycle milestones including stage progression,
        creation timestamp, and outcome metadata. Combines all key
        temporal and outcome data points for each deal.
    
    Grain: One row per deal
    
    Business Logic:
        - Pivots stage transitions to wide format (9 stage columns)
        - Extracts deal creation timestamp from add_time events
        - Captures latest lost_reason if deal was lost BEFORE winning
        - Filters out spurious lost_reasons set after deals reached stage 9
        - One row per deal with all temporal milestones
*/

with stage_changes as (

    select
        deal_id,
        new_value as stage_id,
        change_time as stage_reached_at

    from "postgres"."public_integration"."intg_deal_changes"
    
    where changed_field_key = 'stage_id'

),

creation_times as (

    select
        deal_id,
        min(change_time) as created_at

    from "postgres"."public_integration"."intg_deal_changes"
    
    where changed_field_key = 'add_time'
    
    group by deal_id

),

stage_9_times as (

    -- Get the timestamp when each deal reached stage 9 (won)
    -- Used to filter out lost_reasons that were set AFTER winning
    select
        deal_id,
        min(change_time) as stage_9_reached_at

    from "postgres"."public_integration"."intg_deal_changes"
    
    where changed_field_key = 'stage_id'
      and new_value = '9'
    
    group by deal_id

),

lost_reasons_raw as (

    -- Extract lost_reasons, but only those set BEFORE stage 9 (or if never reached stage 9)
    -- Data quality issue: All won deals have lost_reasons set 1-39 days AFTER winning, these are filtered out
    select
        lost_reasons.deal_id,
        lost_reasons.new_value as lost_reason_id,
        lost_reasons.change_time,
        s9.stage_9_reached_at,
       
        row_number() 
            over (partition by lost_reasons.deal_id order by lost_reasons.change_time desc) as row_number

    from "postgres"."public_integration"."intg_deal_changes" as lost_reasons
    
    left join stage_9_times as s9 
        on lost_reasons.deal_id = s9.deal_id
    
    where lost_reasons.changed_field_key = 'lost_reason'
      -- Only include lost_reasons set BEFORE stage 9 (or if never reached stage 9)
      and (s9.stage_9_reached_at is null 
           or lost_reasons.change_time <= s9.stage_9_reached_at)

),


lost_reasons as (
    
    -- Take the most recent valid lost_reason per deal
    select
        deal_id,
        lost_reason_id

    from lost_reasons_raw
    
    where row_number = 1

),


stage_pivot as (

    -- Pivot stage changes to wide format: one column per stage
    select
        deal_id,
        
        min(case when stage_id = '1' then stage_reached_at end) as stage_1_reached_at,
        min(case when stage_id = '2' then stage_reached_at end) as stage_2_reached_at,
        min(case when stage_id = '3' then stage_reached_at end) as stage_3_reached_at,
        min(case when stage_id = '4' then stage_reached_at end) as stage_4_reached_at,
        min(case when stage_id = '5' then stage_reached_at end) as stage_5_reached_at,
        min(case when stage_id = '6' then stage_reached_at end) as stage_6_reached_at,
        min(case when stage_id = '7' then stage_reached_at end) as stage_7_reached_at,
        min(case when stage_id = '8' then stage_reached_at end) as stage_8_reached_at,
        min(case when stage_id = '9' then stage_reached_at end) as stage_9_reached_at

    from stage_changes
    
    group by deal_id

),

final as (

    select
        pivot.deal_id,
        
        -- Creation timestamp
        creation_times.created_at,
        
        -- Stage milestones
        pivot.stage_1_reached_at,
        pivot.stage_2_reached_at,
        pivot.stage_3_reached_at,
        pivot.stage_4_reached_at,
        pivot.stage_5_reached_at,
        pivot.stage_6_reached_at,
        pivot.stage_7_reached_at,
        pivot.stage_8_reached_at,
        pivot.stage_9_reached_at,
        
        -- Outcome metadata
        lost_reasons.lost_reason_id

    from stage_pivot as pivot
    
    left join creation_times 
        on pivot.deal_id = creation_times.deal_id

    left join lost_reasons 
        on pivot.deal_id = lost_reasons.deal_id

)

select * from final
  );
  
[0m01:49:11.781271 [debug] [Thread-1  ]: SQL status: SELECT 1995 in 0.090 seconds
[0m01:49:11.796259 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m01:49:11.797278 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.trf_deal_milestones"} */
alter table "postgres"."public_pipedrive_analytics"."trf_deal_milestones" rename to "trf_deal_milestones__dbt_backup"
[0m01:49:11.804203 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.005 seconds
[0m01:49:11.809611 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m01:49:11.810145 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.trf_deal_milestones"} */
alter table "postgres"."public_pipedrive_analytics"."trf_deal_milestones__dbt_tmp" rename to "trf_deal_milestones"
[0m01:49:11.814894 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m01:49:11.850616 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: COMMIT
[0m01:49:11.851618 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m01:49:11.852616 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: COMMIT
[0m01:49:11.862772 [debug] [Thread-1  ]: SQL status: COMMIT in 0.009 seconds
[0m01:49:11.873355 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."trf_deal_milestones__dbt_backup"
[0m01:49:11.881422 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m01:49:11.882418 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.trf_deal_milestones"} */
drop table if exists "postgres"."public_pipedrive_analytics"."trf_deal_milestones__dbt_backup" cascade
[0m01:49:11.898536 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.015 seconds
[0m01:49:11.902808 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: Close
[0m01:49:11.906862 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a91badd-0a04-4039-8966-54f31b3872af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253852C3E20>]}
[0m01:49:11.908563 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_pipedrive_analytics.trf_deal_milestones  [[32mSELECT 1995[0m in 2.38s]
[0m01:49:11.910714 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.trf_deal_milestones
[0m01:49:11.915481 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:11.916633 [debug] [MainThread]: On master: BEGIN
[0m01:49:11.918341 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:49:13.990462 [debug] [MainThread]: SQL status: BEGIN in 2.072 seconds
[0m01:49:13.991553 [debug] [MainThread]: On master: COMMIT
[0m01:49:13.992121 [debug] [MainThread]: Using postgres connection "master"
[0m01:49:13.993255 [debug] [MainThread]: On master: COMMIT
[0m01:49:13.996097 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:49:13.997213 [debug] [MainThread]: On master: Close
[0m01:49:13.998870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:49:14.000061 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m01:49:14.001283 [debug] [MainThread]: Connection 'list_postgres_public_pipedrive_analytics' was properly closed.
[0m01:49:14.002397 [debug] [MainThread]: Connection 'model.enpal_assessment_project.trf_deal_milestones' was properly closed.
[0m01:49:14.003506 [info ] [MainThread]: 
[0m01:49:14.005157 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.17 seconds (13.17s).
[0m01:49:14.007746 [debug] [MainThread]: Command end result
[0m01:49:14.117630 [info ] [MainThread]: 
[0m01:49:14.118628 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:49:14.121629 [info ] [MainThread]: 
[0m01:49:14.124284 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:49:14.128352 [debug] [MainThread]: Command `dbt run` succeeded at 01:49:14.128352 after 17.44 seconds
[0m01:49:14.130358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025381A69D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253839D8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025382002280>]}
[0m01:49:14.132354 [debug] [MainThread]: Flushing usage events
[0m01:52:28.099045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002849EA7ADC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284A15899D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284A09E8760>]}


============================== 01:52:28.111077 | 635d782d-dc41-454c-9f5c-2363b7ceee58 ==============================
[0m01:52:28.111077 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:52:28.113092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select trf_deal_milestones', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:52:28.440216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '635d782d-dc41-454c-9f5c-2363b7ceee58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002849EEC1430>]}
[0m01:52:28.532498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '635d782d-dc41-454c-9f5c-2363b7ceee58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002849EF22040>]}
[0m01:52:28.535022 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:52:28.552092 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:52:28.978572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:52:28.979570 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformation\trans.yml
[0m01:52:29.159191 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "postgres_activity".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("postgres", "activity").
  
  To fix this, change the name of one of these resources:
  - source.enpal_assessment_project.postgres.activity (models\transformation\trans.yml)
  - source.enpal_assessment_project.postgres.activity (models\integration\schema.yml)
[0m01:52:29.163193 [debug] [MainThread]: Command `dbt run` failed at 01:52:29.162199 after 1.16 seconds
[0m01:52:29.164198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002849EA7ADC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284A1C19DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284A1C199A0>]}
[0m01:52:29.164710 [debug] [MainThread]: Flushing usage events
[0m01:53:17.881087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B9B39EBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B9DCEC970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B9DD7BA90>]}


============================== 01:53:17.893279 | 4f14ff0f-b589-46bf-9a5d-27ea8ed70028 ==============================
[0m01:53:17.893279 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:53:17.894276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select trf_deal_milestones', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:53:18.224484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f14ff0f-b589-46bf-9a5d-27ea8ed70028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B9B2B3F10>]}
[0m01:53:18.321813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f14ff0f-b589-46bf-9a5d-27ea8ed70028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B9DC5E850>]}
[0m01:53:18.325339 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:53:18.349053 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:53:18.760152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:53:18.761673 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformation\trans.yml
[0m01:53:19.045618 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.transformation
- models.integration
[0m01:53:19.079835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f14ff0f-b589-46bf-9a5d-27ea8ed70028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B9E61C8B0>]}
[0m01:53:19.349854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f14ff0f-b589-46bf-9a5d-27ea8ed70028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B9E662340>]}
[0m01:53:19.351501 [info ] [MainThread]: Found 8 models, 27 data tests, 7 sources, 423 macros
[0m01:53:19.352526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f14ff0f-b589-46bf-9a5d-27ea8ed70028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B9E5C2400>]}
[0m01:53:19.357045 [info ] [MainThread]: 
[0m01:53:19.359050 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:53:19.362054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:53:19.548697 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:53:19.549699 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:53:19.549699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:21.646996 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.097 seconds
[0m01:53:21.650354 [debug] [ThreadPool]: On list_postgres: Close
[0m01:53:21.659746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m01:53:21.670689 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:53:21.671784 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m01:53:21.671784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:23.750267 [debug] [ThreadPool]: SQL status: BEGIN in 2.078 seconds
[0m01:53:23.751495 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m01:53:23.753020 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m01:53:23.761878 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m01:53:23.764127 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m01:53:23.767659 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m01:53:23.769905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_integration)
[0m01:53:23.776056 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m01:53:23.777159 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m01:53:23.777718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:53:25.857397 [debug] [ThreadPool]: SQL status: BEGIN in 2.079 seconds
[0m01:53:25.857949 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m01:53:25.858492 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m01:53:25.866348 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m01:53:25.869093 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m01:53:25.872486 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m01:53:25.886332 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:25.887441 [debug] [MainThread]: On master: BEGIN
[0m01:53:25.888537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:53:27.972035 [debug] [MainThread]: SQL status: BEGIN in 2.083 seconds
[0m01:53:27.973156 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:27.974269 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:53:27.983526 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m01:53:27.986365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f14ff0f-b589-46bf-9a5d-27ea8ed70028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B9E662490>]}
[0m01:53:27.986918 [debug] [MainThread]: On master: ROLLBACK
[0m01:53:27.990274 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:27.990835 [debug] [MainThread]: On master: BEGIN
[0m01:53:27.996085 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:53:27.997200 [debug] [MainThread]: On master: COMMIT
[0m01:53:27.997754 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:27.998309 [debug] [MainThread]: On master: COMMIT
[0m01:53:28.001178 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:53:28.001740 [debug] [MainThread]: On master: Close
[0m01:53:28.003387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:53:28.004492 [info ] [MainThread]: 
[0m01:53:28.024525 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.trf_deal_milestones
[0m01:53:28.026281 [info ] [Thread-1  ]: 1 of 1 START sql table model public_pipedrive_analytics.trf_deal_milestones .... [RUN]
[0m01:53:28.028708 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.trf_deal_milestones'
[0m01:53:28.029804 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.trf_deal_milestones
[0m01:53:28.053357 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.trf_deal_milestones"
[0m01:53:28.057142 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.trf_deal_milestones
[0m01:53:28.126993 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.trf_deal_milestones"
[0m01:53:28.129759 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m01:53:28.130314 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: BEGIN
[0m01:53:28.131329 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m01:53:30.201092 [debug] [Thread-1  ]: SQL status: BEGIN in 2.069 seconds
[0m01:53:30.202176 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m01:53:30.203257 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.trf_deal_milestones"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."trf_deal_milestones__dbt_tmp"
  
  
    as
  
  (
    /*
    Model: trf_deal_milestones
    
    Purpose:
        Captures deal lifecycle milestones including stage progression,
        creation timestamp, and outcome metadata. Combines all key
        temporal and outcome data points for each deal.
    
    Grain: One row per deal
    
    Business Logic:
        - Pivots stage transitions to wide format (9 stage columns)
        - Extracts deal creation timestamp from add_time events
        - Captures latest lost_reason if deal was lost BEFORE winning
        - Filters out spurious lost_reasons set after deals reached stage 9
        - One row per deal with all temporal milestones
*/

with stage_changes as (

    select
        deal_id,
        new_value as stage_id,
        change_time as stage_reached_at

    from "postgres"."public_integration"."intg_deal_changes"
    
    where changed_field_key = 'stage_id'

),

creation_times as (

    select
        deal_id,
        min(change_time) as created_at

    from "postgres"."public_integration"."intg_deal_changes"
    
    where changed_field_key = 'add_time'
    
    group by deal_id

),

stage_9_times as (

    -- Get the timestamp when each deal reached stage 9 (won)
    -- Used to filter out lost_reasons that were set AFTER winning
    select
        deal_id,
        min(change_time) as stage_9_reached_at

    from "postgres"."public_integration"."intg_deal_changes"
    
    where changed_field_key = 'stage_id'
      and new_value = '9'
    
    group by deal_id

),

lost_reasons_raw as (

    -- Extract lost_reasons, but only those set BEFORE stage 9 (or if never reached stage 9)
    -- Data quality issue: All won deals have lost_reasons set 1-39 days AFTER winning, these are filtered out
    select
        lost_reasons.deal_id,
        lost_reasons.new_value as lost_reason_id,
        lost_reasons.change_time,
        s9.stage_9_reached_at,
       
        row_number() 
            over (partition by lost_reasons.deal_id order by lost_reasons.change_time desc) as row_number

    from "postgres"."public_integration"."intg_deal_changes" as lost_reasons
    
    left join stage_9_times as s9 
        on lost_reasons.deal_id = s9.deal_id
    
    where lost_reasons.changed_field_key = 'lost_reason'
      -- Only include lost_reasons set BEFORE stage 9 (or if never reached stage 9)
      and (s9.stage_9_reached_at is null 
           or lost_reasons.change_time <= s9.stage_9_reached_at)

),


lost_reasons as (
    
    -- Take the most recent valid lost_reason per deal
    select
        deal_id,
        lost_reason_id

    from lost_reasons_raw
    
    where row_number = 1

),


stage_pivot as (

    -- Pivot stage changes to wide format: one column per stage
    select
        deal_id,
        
        min(case when stage_id = '1' then stage_reached_at end) as stage_1_reached_at,
        min(case when stage_id = '2' then stage_reached_at end) as stage_2_reached_at,
        min(case when stage_id = '3' then stage_reached_at end) as stage_3_reached_at,
        min(case when stage_id = '4' then stage_reached_at end) as stage_4_reached_at,
        min(case when stage_id = '5' then stage_reached_at end) as stage_5_reached_at,
        min(case when stage_id = '6' then stage_reached_at end) as stage_6_reached_at,
        min(case when stage_id = '7' then stage_reached_at end) as stage_7_reached_at,
        min(case when stage_id = '8' then stage_reached_at end) as stage_8_reached_at,
        min(case when stage_id = '9' then stage_reached_at end) as stage_9_reached_at

    from stage_changes
    
    group by deal_id

),

final as (

    select
        pivot.deal_id,
        
        -- Creation timestamp
        creation_times.created_at,
        
        -- Stage milestones
        pivot.stage_1_reached_at,
        pivot.stage_2_reached_at,
        pivot.stage_3_reached_at,
        pivot.stage_4_reached_at,
        pivot.stage_5_reached_at,
        pivot.stage_6_reached_at,
        pivot.stage_7_reached_at,
        pivot.stage_8_reached_at,
        pivot.stage_9_reached_at,
        
        -- Outcome metadata
        lost_reasons.lost_reason_id

    from stage_pivot as pivot
    
    left join creation_times 
        on pivot.deal_id = creation_times.deal_id

    left join lost_reasons 
        on pivot.deal_id = lost_reasons.deal_id

)

select * from final
  );
  
[0m01:53:30.244490 [debug] [Thread-1  ]: SQL status: SELECT 1995 in 0.040 seconds
[0m01:53:30.255498 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m01:53:30.255498 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.trf_deal_milestones"} */
alter table "postgres"."public_pipedrive_analytics"."trf_deal_milestones" rename to "trf_deal_milestones__dbt_backup"
[0m01:53:30.260346 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m01:53:30.265819 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m01:53:30.267004 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.trf_deal_milestones"} */
alter table "postgres"."public_pipedrive_analytics"."trf_deal_milestones__dbt_tmp" rename to "trf_deal_milestones"
[0m01:53:30.269698 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:53:30.301542 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: COMMIT
[0m01:53:30.301542 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m01:53:30.303058 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: COMMIT
[0m01:53:30.311287 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m01:53:30.321811 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."trf_deal_milestones__dbt_backup"
[0m01:53:30.329437 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m01:53:30.330058 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.trf_deal_milestones"} */
drop table if exists "postgres"."public_pipedrive_analytics"."trf_deal_milestones__dbt_backup" cascade
[0m01:53:30.338133 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m01:53:30.341969 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: Close
[0m01:53:30.345339 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f14ff0f-b589-46bf-9a5d-27ea8ed70028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B9EAE7E50>]}
[0m01:53:30.347051 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_pipedrive_analytics.trf_deal_milestones  [[32mSELECT 1995[0m in 2.32s]
[0m01:53:30.348737 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.trf_deal_milestones
[0m01:53:30.352412 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:30.353516 [debug] [MainThread]: On master: BEGIN
[0m01:53:30.354633 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:53:32.426987 [debug] [MainThread]: SQL status: BEGIN in 2.073 seconds
[0m01:53:32.427525 [debug] [MainThread]: On master: COMMIT
[0m01:53:32.428043 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:32.429140 [debug] [MainThread]: On master: COMMIT
[0m01:53:32.431312 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:53:32.432427 [debug] [MainThread]: On master: Close
[0m01:53:32.433537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:53:32.434649 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m01:53:32.435198 [debug] [MainThread]: Connection 'list_postgres_public_integration' was properly closed.
[0m01:53:32.435786 [debug] [MainThread]: Connection 'model.enpal_assessment_project.trf_deal_milestones' was properly closed.
[0m01:53:32.436331 [info ] [MainThread]: 
[0m01:53:32.437395 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.08 seconds (13.08s).
[0m01:53:32.440297 [debug] [MainThread]: Command end result
[0m01:53:32.601415 [info ] [MainThread]: 
[0m01:53:32.602409 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:53:32.604409 [info ] [MainThread]: 
[0m01:53:32.605407 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:53:32.608931 [debug] [MainThread]: Command `dbt run` succeeded at 01:53:32.607927 after 14.82 seconds
[0m01:53:32.609932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B9B39EBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B9B7DFD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B9D317550>]}
[0m01:53:32.611567 [debug] [MainThread]: Flushing usage events
[0m02:14:01.558397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001676F118B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016771C39940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016771C39BE0>]}


============================== 02:14:01.572180 | 06a2e64d-24bb-4098-bb4a-8befc6ba9ccb ==============================
[0m02:14:01.572180 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:14:01.575183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select deals', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:14:02.036066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06a2e64d-24bb-4098-bb4a-8befc6ba9ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001676F4F13A0>]}
[0m02:14:02.132385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06a2e64d-24bb-4098-bb4a-8befc6ba9ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001676F092490>]}
[0m02:14:02.135390 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:14:02.161160 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:14:02.436230 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:14:02.437877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '06a2e64d-24bb-4098-bb4a-8befc6ba9ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016771096430>]}
[0m02:14:04.597954 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:14:04.600499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '06a2e64d-24bb-4098-bb4a-8befc6ba9ccb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001676F011B20>]}
[0m02:14:05.351701 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformation
- models.curated
- models.integration
[0m02:14:05.382112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06a2e64d-24bb-4098-bb4a-8befc6ba9ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001677246BEB0>]}
[0m02:14:05.820837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06a2e64d-24bb-4098-bb4a-8befc6ba9ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001677254E850>]}
[0m02:14:05.821837 [info ] [MainThread]: Found 9 models, 31 data tests, 7 sources, 423 macros
[0m02:14:05.822838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06a2e64d-24bb-4098-bb4a-8befc6ba9ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167724BBD30>]}
[0m02:14:05.826368 [info ] [MainThread]: 
[0m02:14:05.828362 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:14:05.832374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:14:06.065915 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:14:06.066916 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:14:06.068424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:14:08.220435 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.152 seconds
[0m02:14:08.223223 [debug] [ThreadPool]: On list_postgres: Close
[0m02:14:08.234864 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m02:14:08.245243 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:14:08.246277 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m02:14:08.247264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:14:10.332716 [debug] [ThreadPool]: SQL status: BEGIN in 2.085 seconds
[0m02:14:10.333820 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:14:10.334988 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m02:14:10.358159 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.022 seconds
[0m02:14:10.360309 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m02:14:10.363056 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m02:14:10.365231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_integration)
[0m02:14:10.371445 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m02:14:10.372762 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m02:14:10.373835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:14:12.440007 [debug] [ThreadPool]: SQL status: BEGIN in 2.066 seconds
[0m02:14:12.441118 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m02:14:12.441659 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m02:14:12.448882 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m02:14:12.451015 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m02:14:12.454358 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m02:14:12.465677 [debug] [MainThread]: Using postgres connection "master"
[0m02:14:12.466688 [debug] [MainThread]: On master: BEGIN
[0m02:14:12.466688 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:14:14.534019 [debug] [MainThread]: SQL status: BEGIN in 2.067 seconds
[0m02:14:14.535137 [debug] [MainThread]: Using postgres connection "master"
[0m02:14:14.536311 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:14:14.552446 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m02:14:14.554883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06a2e64d-24bb-4098-bb4a-8befc6ba9ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001677254EDC0>]}
[0m02:14:14.555976 [debug] [MainThread]: On master: ROLLBACK
[0m02:14:14.558770 [debug] [MainThread]: Using postgres connection "master"
[0m02:14:14.559856 [debug] [MainThread]: On master: BEGIN
[0m02:14:14.564286 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m02:14:14.565007 [debug] [MainThread]: On master: COMMIT
[0m02:14:14.566128 [debug] [MainThread]: Using postgres connection "master"
[0m02:14:14.566674 [debug] [MainThread]: On master: COMMIT
[0m02:14:14.569385 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m02:14:14.569945 [debug] [MainThread]: On master: Close
[0m02:14:14.571629 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:14:14.572700 [info ] [MainThread]: 
[0m02:14:14.589432 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.deals
[0m02:14:14.590525 [info ] [Thread-1  ]: 1 of 1 START sql table model public_pipedrive_analytics.deals .................. [RUN]
[0m02:14:14.593098 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.deals'
[0m02:14:14.594623 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.deals
[0m02:14:14.614926 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.deals"
[0m02:14:14.621046 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.deals
[0m02:14:14.692110 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.deals"
[0m02:14:14.696634 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m02:14:14.697657 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: BEGIN
[0m02:14:14.697657 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:14:16.787666 [debug] [Thread-1  ]: SQL status: BEGIN in 2.089 seconds
[0m02:14:16.788210 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m02:14:16.788760 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deals"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."deals__dbt_tmp"
  
  
    as
  
  (
    /*
    Model: deals
    
    Purpose:
        Complete deal entity combining stage progression, creation metadata,
        and outcome information. Serves as the foundational business entity
        for all deal-related analysis across the organization.
    
    Grain: One row per deal
    
    Reusability:
        This model enables multiple analytical use cases:
        - Funnel analysis at any time grain (daily, weekly, monthly, quarterly)
        - Win/loss analysis by reason, stage, or cohort
        - Sales cycle velocity and duration metrics
        - Conversion rate analysis across stages
        - Pipeline forecasting and capacity planning
        - Cohort retention and progression analysis
    
    Design Philosophy:
        Built as a reusable entity rather than report-specific aggregation.
        Maintains deal-level grain with enriched attributes to support
        flexible downstream analysis without rebuilding base logic.
*/

with deal_milestones as (

    select * from "postgres"."public_pipedrive_analytics"."trf_deal_milestones"

),

lost_reason_lookup as (

    select
        value->>'id' as lost_reason_id,
        value->>'label' as lost_reason_label

    from "postgres"."public_integration"."intg_fields",
         json_array_elements(field_value_options) as value
    
    where field_key = 'lost_reason'

),

final as (

    select
        milestones.deal_id,
        
        -- Creation timestamps at multiple grains for flexible aggregation
        milestones.created_at,
        date_trunc('day', milestones.created_at)::date as creation_date,
        date_trunc('week', milestones.created_at)::date as creation_week,
        date_trunc('month', milestones.created_at)::date as creation_month,
        date_trunc('quarter', milestones.created_at)::date as creation_quarter,
        
        -- Stage milestones (9 funnel steps)
        milestones.stage_1_reached_at,
        milestones.stage_2_reached_at,
        milestones.stage_3_reached_at,
        milestones.stage_4_reached_at,
        milestones.stage_5_reached_at,
        milestones.stage_6_reached_at,
        milestones.stage_7_reached_at,
        milestones.stage_8_reached_at,
        milestones.stage_9_reached_at,
        
        -- Deal outcome metadata
        milestones.lost_reason_id,
        lost_reasons.lost_reason_label as lost_reason,
        
        -- Derived metrics for analysis
        milestones.stage_9_reached_at is not null as is_won,
        
        -- Only lost if has reason AND didn't win
        (milestones.lost_reason_id is not null 
         and milestones.stage_9_reached_at is null) as is_lost,

        milestones.stage_9_reached_at - milestones.created_at as sales_cycle_duration

    from deal_milestones as milestones
    
    left join lost_reason_lookup as lost_reasons
        on milestones.lost_reason_id = lost_reasons.lost_reason_id
)

select * from final
  );
  
[0m02:14:16.803788 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function json_array_elements(jsonb) does not exist
LINE 50:          json_array_elements(field_value_options) as value
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m02:14:16.804879 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: ROLLBACK
[0m02:14:16.808176 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: Close
[0m02:14:17.234379 [debug] [Thread-1  ]: Database Error in model deals (models\curated\deals.sql)
  function json_array_elements(jsonb) does not exist
  LINE 50:          json_array_elements(field_value_options) as value
                    ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\enpal_assessment_project\models\curated\deals.sql
[0m02:14:17.236895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06a2e64d-24bb-4098-bb4a-8befc6ba9ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016771074430>]}
[0m02:14:17.237909 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public_pipedrive_analytics.deals ......... [[31mERROR[0m in 2.64s]
[0m02:14:17.239910 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.deals
[0m02:14:17.244537 [debug] [MainThread]: Using postgres connection "master"
[0m02:14:17.245551 [debug] [MainThread]: On master: BEGIN
[0m02:14:17.245551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:14:19.298967 [debug] [MainThread]: SQL status: BEGIN in 2.052 seconds
[0m02:14:19.299499 [debug] [MainThread]: On master: COMMIT
[0m02:14:19.300601 [debug] [MainThread]: Using postgres connection "master"
[0m02:14:19.301158 [debug] [MainThread]: On master: COMMIT
[0m02:14:19.303900 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m02:14:19.304434 [debug] [MainThread]: On master: Close
[0m02:14:19.305543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:14:19.306660 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m02:14:19.307241 [debug] [MainThread]: Connection 'list_postgres_public_integration' was properly closed.
[0m02:14:19.307796 [debug] [MainThread]: Connection 'model.enpal_assessment_project.deals' was properly closed.
[0m02:14:19.308337 [info ] [MainThread]: 
[0m02:14:19.310171 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.48 seconds (13.48s).
[0m02:14:19.313022 [debug] [MainThread]: Command end result
[0m02:14:19.398959 [info ] [MainThread]: 
[0m02:14:19.400462 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:14:19.402121 [info ] [MainThread]: 
[0m02:14:19.403140 [error] [MainThread]:   Database Error in model deals (models\curated\deals.sql)
  function json_array_elements(jsonb) does not exist
  LINE 50:          json_array_elements(field_value_options) as value
                    ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\enpal_assessment_project\models\curated\deals.sql
[0m02:14:19.405141 [info ] [MainThread]: 
[0m02:14:19.406142 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:14:19.409132 [debug] [MainThread]: Command `dbt run` failed at 02:14:19.409132 after 17.98 seconds
[0m02:14:19.410640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001676F118B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001676F092490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167723AF940>]}
[0m02:14:19.411650 [debug] [MainThread]: Flushing usage events
[0m02:16:33.533352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A81C20BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A8474EEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A846D3400>]}


============================== 02:16:33.544550 | aa880eb3-066f-428b-adc0-7bcdb45b9de0 ==============================
[0m02:16:33.544550 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:16:33.545553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select deals', 'send_anonymous_usage_stats': 'True'}
[0m02:16:33.887835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa880eb3-066f-428b-adc0-7bcdb45b9de0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A820713D0>]}
[0m02:16:33.980787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa880eb3-066f-428b-adc0-7bcdb45b9de0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A848794C0>]}
[0m02:16:33.983292 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:16:34.005354 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:16:34.467796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:16:34.468794 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\curated\deals.sql
[0m02:16:34.848726 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:16:34.850727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aa880eb3-066f-428b-adc0-7bcdb45b9de0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A84EEA3A0>]}
[0m02:16:35.163270 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.integration
- models.transformation
- models.curated
[0m02:16:35.192683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa880eb3-066f-428b-adc0-7bcdb45b9de0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A85183CD0>]}
[0m02:16:35.545729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa880eb3-066f-428b-adc0-7bcdb45b9de0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A85234760>]}
[0m02:16:35.546823 [info ] [MainThread]: Found 9 models, 31 data tests, 7 sources, 423 macros
[0m02:16:35.547898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa880eb3-066f-428b-adc0-7bcdb45b9de0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A851CEF10>]}
[0m02:16:35.552229 [info ] [MainThread]: 
[0m02:16:35.554325 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:16:35.558758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:16:35.884290 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:16:35.886348 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:16:35.887368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:37.990783 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.103 seconds
[0m02:16:37.994156 [debug] [ThreadPool]: On list_postgres: Close
[0m02:16:38.007060 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m02:16:38.117731 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:16:38.118245 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m02:16:38.119260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:40.193888 [debug] [ThreadPool]: SQL status: BEGIN in 2.074 seconds
[0m02:16:40.195003 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:16:40.195560 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m02:16:40.204984 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.009 seconds
[0m02:16:40.207668 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m02:16:40.210985 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m02:16:40.212066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_integration)
[0m02:16:40.218231 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m02:16:40.218784 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m02:16:40.219328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:16:42.273869 [debug] [ThreadPool]: SQL status: BEGIN in 2.054 seconds
[0m02:16:42.274419 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m02:16:42.275115 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m02:16:42.283402 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m02:16:42.285573 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m02:16:42.289093 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m02:16:42.300649 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:42.301739 [debug] [MainThread]: On master: BEGIN
[0m02:16:42.302280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:16:44.384696 [debug] [MainThread]: SQL status: BEGIN in 2.083 seconds
[0m02:16:44.385795 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:44.386906 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:16:44.398329 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m02:16:44.400704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa880eb3-066f-428b-adc0-7bcdb45b9de0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A8508F3D0>]}
[0m02:16:44.401780 [debug] [MainThread]: On master: ROLLBACK
[0m02:16:44.405035 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:44.405579 [debug] [MainThread]: On master: BEGIN
[0m02:16:44.411182 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m02:16:44.411703 [debug] [MainThread]: On master: COMMIT
[0m02:16:44.412257 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:44.412793 [debug] [MainThread]: On master: COMMIT
[0m02:16:44.415638 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m02:16:44.416729 [debug] [MainThread]: On master: Close
[0m02:16:44.417818 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:16:44.418904 [info ] [MainThread]: 
[0m02:16:44.434538 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.deals
[0m02:16:44.435626 [info ] [Thread-1  ]: 1 of 1 START sql table model public_pipedrive_analytics.deals .................. [RUN]
[0m02:16:44.436735 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.deals'
[0m02:16:44.437824 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.deals
[0m02:16:44.452896 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.deals"
[0m02:16:44.456414 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.deals
[0m02:16:44.525511 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.deals"
[0m02:16:44.528033 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m02:16:44.529052 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: BEGIN
[0m02:16:44.530044 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:16:46.606359 [debug] [Thread-1  ]: SQL status: BEGIN in 2.076 seconds
[0m02:16:46.607600 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m02:16:46.609256 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deals"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."deals__dbt_tmp"
  
  
    as
  
  (
    /*
    Model: deals
    
    Purpose:
        Complete deal entity combining stage progression, creation metadata,
        and outcome information. Serves as the foundational business entity
        for all deal-related analysis across the organization.
    
    Grain: One row per deal
    
    Reusability:
        This model enables multiple analytical use cases:
        - Funnel analysis at any time grain (daily, weekly, monthly, quarterly)
        - Win/loss analysis by reason, stage, or cohort
        - Sales cycle velocity and duration metrics
        - Conversion rate analysis across stages
        - Pipeline forecasting and capacity planning
        - Cohort retention and progression analysis
    
    Design Philosophy:
        Built as a reusable entity rather than report-specific aggregation.
        Maintains deal-level grain with enriched attributes to support
        flexible downstream analysis without rebuilding base logic.
*/

with deal_milestones as (

    select * from "postgres"."public_pipedrive_analytics"."trf_deal_milestones"

),

lost_reason_lookup as (

    select
        value->>'id' as lost_reason_id,
        value->>'label' as lost_reason_label

    from "postgres"."public_integration"."intg_fields",
         json_array_elements(field_value_options::jsonb) as value
    
    where field_key = 'lost_reason'

),

final as (

    select
        milestones.deal_id,
        
        -- Creation timestamps at multiple grains for flexible aggregation
        milestones.created_at,
        date_trunc('day', milestones.created_at)::date as creation_date,
        date_trunc('week', milestones.created_at)::date as creation_week,
        date_trunc('month', milestones.created_at)::date as creation_month,
        date_trunc('quarter', milestones.created_at)::date as creation_quarter,
        
        -- Stage milestones (9 funnel steps)
        milestones.stage_1_reached_at,
        milestones.stage_2_reached_at,
        milestones.stage_3_reached_at,
        milestones.stage_4_reached_at,
        milestones.stage_5_reached_at,
        milestones.stage_6_reached_at,
        milestones.stage_7_reached_at,
        milestones.stage_8_reached_at,
        milestones.stage_9_reached_at,
        
        -- Deal outcome metadata
        milestones.lost_reason_id,
        lost_reasons.lost_reason_label as lost_reason,
        
        -- Derived metrics for analysis
        milestones.stage_9_reached_at is not null as is_won,
        
        -- Only lost if has reason AND didn't win
        (milestones.lost_reason_id is not null 
         and milestones.stage_9_reached_at is null) as is_lost,

        milestones.stage_9_reached_at - milestones.created_at as sales_cycle_duration

    from deal_milestones as milestones
    
    left join lost_reason_lookup as lost_reasons
        on milestones.lost_reason_id = lost_reasons.lost_reason_id
)

select * from final
  );
  
[0m02:16:46.614232 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function json_array_elements(jsonb) does not exist
LINE 50:          json_array_elements(field_value_options::jsonb) as ...
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m02:16:46.614772 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: ROLLBACK
[0m02:16:46.619016 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: Close
[0m02:16:46.628641 [debug] [Thread-1  ]: Database Error in model deals (models\curated\deals.sql)
  function json_array_elements(jsonb) does not exist
  LINE 50:          json_array_elements(field_value_options::jsonb) as ...
                    ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\enpal_assessment_project\models\curated\deals.sql
[0m02:16:46.631385 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa880eb3-066f-428b-adc0-7bcdb45b9de0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A83B834C0>]}
[0m02:16:46.633071 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public_pipedrive_analytics.deals ......... [[31mERROR[0m in 2.19s]
[0m02:16:46.634725 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.deals
[0m02:16:46.638112 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:46.638675 [debug] [MainThread]: On master: BEGIN
[0m02:16:46.639695 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:16:48.714840 [debug] [MainThread]: SQL status: BEGIN in 2.075 seconds
[0m02:16:48.715944 [debug] [MainThread]: On master: COMMIT
[0m02:16:48.716489 [debug] [MainThread]: Using postgres connection "master"
[0m02:16:48.717042 [debug] [MainThread]: On master: COMMIT
[0m02:16:48.719744 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m02:16:48.720824 [debug] [MainThread]: On master: Close
[0m02:16:48.722526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:16:48.723646 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m02:16:48.724194 [debug] [MainThread]: Connection 'list_postgres_public_integration' was properly closed.
[0m02:16:48.725288 [debug] [MainThread]: Connection 'model.enpal_assessment_project.deals' was properly closed.
[0m02:16:48.726476 [info ] [MainThread]: 
[0m02:16:48.727588 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.17 seconds (13.17s).
[0m02:16:48.730329 [debug] [MainThread]: Command end result
[0m02:16:48.830768 [info ] [MainThread]: 
[0m02:16:48.832288 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:16:48.833945 [info ] [MainThread]: 
[0m02:16:48.835964 [error] [MainThread]:   Database Error in model deals (models\curated\deals.sql)
  function json_array_elements(jsonb) does not exist
  LINE 50:          json_array_elements(field_value_options::jsonb) as ...
                    ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\enpal_assessment_project\models\curated\deals.sql
[0m02:16:48.836967 [info ] [MainThread]: 
[0m02:16:48.837967 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:16:48.840964 [debug] [MainThread]: Command `dbt run` failed at 02:16:48.840964 after 15.39 seconds
[0m02:16:48.840964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A83BAA550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A821F9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A85234760>]}
[0m02:16:48.842484 [debug] [MainThread]: Flushing usage events
[0m02:19:48.832171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E788AD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E97FA0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255EA396D00>]}


============================== 02:19:48.842694 | adf7791a-e1fd-4970-9541-c472d5ea51cd ==============================
[0m02:19:48.842694 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:19:48.844700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select deals', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:19:49.198725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adf7791a-e1fd-4970-9541-c472d5ea51cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E776F3A0>]}
[0m02:19:49.285359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adf7791a-e1fd-4970-9541-c472d5ea51cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255EA3252B0>]}
[0m02:19:49.288374 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:19:49.307100 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:19:49.719788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:19:49.721297 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\curated\deals.sql
[0m02:19:50.148628 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:19:50.150632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'adf7791a-e1fd-4970-9541-c472d5ea51cd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255EAA01280>]}
[0m02:19:50.457582 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.integration
- models.transformation
- models.curated
[0m02:19:50.493923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adf7791a-e1fd-4970-9541-c472d5ea51cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255EAC8FC10>]}
[0m02:19:50.760256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adf7791a-e1fd-4970-9541-c472d5ea51cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255EAD45520>]}
[0m02:19:50.761251 [info ] [MainThread]: Found 9 models, 31 data tests, 7 sources, 423 macros
[0m02:19:50.763248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adf7791a-e1fd-4970-9541-c472d5ea51cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255EACDFD90>]}
[0m02:19:50.767785 [info ] [MainThread]: 
[0m02:19:50.769780 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:19:50.773927 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:19:50.987905 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:19:50.987905 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:19:50.988922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:53.077454 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.088 seconds
[0m02:19:53.080814 [debug] [ThreadPool]: On list_postgres: Close
[0m02:19:53.094086 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m02:19:53.215359 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:19:53.216876 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m02:19:53.216876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:55.289631 [debug] [ThreadPool]: SQL status: BEGIN in 2.072 seconds
[0m02:19:55.290178 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:19:55.291410 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m02:19:55.300290 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m02:19:55.302313 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m02:19:55.306186 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m02:19:55.308206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_integration)
[0m02:19:55.313834 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m02:19:55.315032 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m02:19:55.315587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:19:57.418426 [debug] [ThreadPool]: SQL status: BEGIN in 2.103 seconds
[0m02:19:57.418946 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m02:19:57.419486 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m02:19:57.427245 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m02:19:57.429358 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m02:19:57.432304 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m02:19:57.444394 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:57.444932 [debug] [MainThread]: On master: BEGIN
[0m02:19:57.445488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:19:59.517522 [debug] [MainThread]: SQL status: BEGIN in 2.072 seconds
[0m02:19:59.518687 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:59.519935 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:19:59.529704 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m02:19:59.531927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adf7791a-e1fd-4970-9541-c472d5ea51cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255EADB7F70>]}
[0m02:19:59.533025 [debug] [MainThread]: On master: ROLLBACK
[0m02:19:59.535915 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:59.537028 [debug] [MainThread]: On master: BEGIN
[0m02:19:59.542579 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m02:19:59.543710 [debug] [MainThread]: On master: COMMIT
[0m02:19:59.544854 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:59.545990 [debug] [MainThread]: On master: COMMIT
[0m02:19:59.548837 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m02:19:59.549992 [debug] [MainThread]: On master: Close
[0m02:19:59.551103 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:19:59.552779 [info ] [MainThread]: 
[0m02:19:59.571642 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.deals
[0m02:19:59.573658 [info ] [Thread-1  ]: 1 of 1 START sql table model public_pipedrive_analytics.deals .................. [RUN]
[0m02:19:59.575660 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.deals'
[0m02:19:59.577658 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.deals
[0m02:19:59.599156 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.deals"
[0m02:19:59.603689 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.deals
[0m02:19:59.702046 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.deals"
[0m02:19:59.705196 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m02:19:59.706210 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: BEGIN
[0m02:19:59.707210 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:20:01.771419 [debug] [Thread-1  ]: SQL status: BEGIN in 2.064 seconds
[0m02:20:01.772488 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m02:20:01.773575 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deals"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."deals__dbt_tmp"
  
  
    as
  
  (
    /*
    Model: deals
    
    Purpose:
        Complete deal entity combining stage progression, creation metadata,
        and outcome information. Serves as the foundational business entity
        for all deal-related analysis across the organization.
    
    Grain: One row per deal
    
    Reusability:
        This model enables multiple analytical use cases:
        - Funnel analysis at any time grain (daily, weekly, monthly, quarterly)
        - Win/loss analysis by reason, stage, or cohort
        - Sales cycle velocity and duration metrics
        - Conversion rate analysis across stages
        - Pipeline forecasting and capacity planning
        - Cohort retention and progression analysis
    
    Design Philosophy:
        Built as a reusable entity rather than report-specific aggregation.
        Maintains deal-level grain with enriched attributes to support
        flexible downstream analysis without rebuilding base logic.
*/

with deal_milestones as (

    select * from "postgres"."public_pipedrive_analytics"."trf_deal_milestones"

),

lost_reason_lookup as (
  select
    option->>'id' as lost_reason_id,
    option->>'label' as lost_reason_label
  from "postgres"."public_integration"."intg_fields",
  jsonb_array_elements(field_value_options::jsonb->'options') as option
  where field_key = 'lost_reason'
),

final as (

    select
        milestones.deal_id,
        
        -- Creation timestamps at multiple grains for flexible aggregation
        milestones.created_at,
        date_trunc('day', milestones.created_at)::date as creation_date,
        date_trunc('week', milestones.created_at)::date as creation_week,
        date_trunc('month', milestones.created_at)::date as creation_month,
        date_trunc('quarter', milestones.created_at)::date as creation_quarter,
        
        -- Stage milestones (9 funnel steps)
        milestones.stage_1_reached_at,
        milestones.stage_2_reached_at,
        milestones.stage_3_reached_at,
        milestones.stage_4_reached_at,
        milestones.stage_5_reached_at,
        milestones.stage_6_reached_at,
        milestones.stage_7_reached_at,
        milestones.stage_8_reached_at,
        milestones.stage_9_reached_at,
        
        -- Deal outcome metadata
        milestones.lost_reason_id,
        lost_reasons.lost_reason_label as lost_reason,
        
        -- Derived metrics for analysis
        milestones.stage_9_reached_at is not null as is_won,
        
        -- Only lost if has reason AND didn't win
        (milestones.lost_reason_id is not null 
         and milestones.stage_9_reached_at is null) as is_lost,

        milestones.stage_9_reached_at - milestones.created_at as sales_cycle_duration

    from deal_milestones as milestones
    
    left join lost_reason_lookup as lost_reasons
        on milestones.lost_reason_id = lost_reasons.lost_reason_id
)

select * from final
  );
  
[0m02:20:01.859634 [debug] [Thread-1  ]: SQL status: SELECT 1995 in 0.086 seconds
[0m02:20:01.870829 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m02:20:01.871365 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deals"} */
alter table "postgres"."public_pipedrive_analytics"."deals__dbt_tmp" rename to "deals"
[0m02:20:01.876464 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m02:20:01.904764 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: COMMIT
[0m02:20:01.904764 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m02:20:01.905762 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: COMMIT
[0m02:20:01.915274 [debug] [Thread-1  ]: SQL status: COMMIT in 0.008 seconds
[0m02:20:01.925377 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."deals__dbt_backup"
[0m02:20:01.932623 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m02:20:01.933620 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deals"} */
drop table if exists "postgres"."public_pipedrive_analytics"."deals__dbt_backup" cascade
[0m02:20:01.938915 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m02:20:01.942711 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: Close
[0m02:20:01.946681 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adf7791a-e1fd-4970-9541-c472d5ea51cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E782A400>]}
[0m02:20:01.947772 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_pipedrive_analytics.deals ............. [[32mSELECT 1995[0m in 2.37s]
[0m02:20:01.949827 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.deals
[0m02:20:01.952994 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:01.953567 [debug] [MainThread]: On master: BEGIN
[0m02:20:01.954122 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:20:04.020924 [debug] [MainThread]: SQL status: BEGIN in 2.067 seconds
[0m02:20:04.022014 [debug] [MainThread]: On master: COMMIT
[0m02:20:04.022549 [debug] [MainThread]: Using postgres connection "master"
[0m02:20:04.023077 [debug] [MainThread]: On master: COMMIT
[0m02:20:04.025950 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m02:20:04.027043 [debug] [MainThread]: On master: Close
[0m02:20:04.028153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:20:04.029272 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m02:20:04.029825 [debug] [MainThread]: Connection 'list_postgres_public_integration' was properly closed.
[0m02:20:04.030374 [debug] [MainThread]: Connection 'model.enpal_assessment_project.deals' was properly closed.
[0m02:20:04.030927 [info ] [MainThread]: 
[0m02:20:04.032027 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.26 seconds (13.26s).
[0m02:20:04.034820 [debug] [MainThread]: Command end result
[0m02:20:04.104236 [info ] [MainThread]: 
[0m02:20:04.106228 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:20:04.107231 [info ] [MainThread]: 
[0m02:20:04.109232 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:20:04.112745 [debug] [MainThread]: Command `dbt run` succeeded at 02:20:04.111736 after 15.38 seconds
[0m02:20:04.112745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E788AD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E9E8D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255EAD26B20>]}
[0m02:20:04.113752 [debug] [MainThread]: Flushing usage events
[0m02:21:43.961955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001738DC35AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017390747760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017390747040>]}


============================== 02:21:43.976041 | 58b535b3-9273-4795-898f-58b966258b48 ==============================
[0m02:21:43.976041 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:21:43.978057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select deals', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:21:44.390998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58b535b3-9273-4795-898f-58b966258b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001738E077310>]}
[0m02:21:44.480260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58b535b3-9273-4795-898f-58b966258b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001738DB588E0>]}
[0m02:21:44.482788 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:21:44.504846 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:21:45.028039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:21:45.029737 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\curated\curated.yml
[0m02:21:45.307138 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.integration
- models.curated
- models.transformation
[0m02:21:45.345015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58b535b3-9273-4795-898f-58b966258b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017390E8DFA0>]}
[0m02:21:45.665987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58b535b3-9273-4795-898f-58b966258b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017390F66820>]}
[0m02:21:45.667739 [info ] [MainThread]: Found 9 models, 31 data tests, 7 sources, 423 macros
[0m02:21:45.668839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58b535b3-9273-4795-898f-58b966258b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017390EB7040>]}
[0m02:21:45.673231 [info ] [MainThread]: 
[0m02:21:45.675472 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:21:45.679170 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:21:45.977910 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:21:45.978971 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:21:45.980014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:48.085751 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.106 seconds
[0m02:21:48.088103 [debug] [ThreadPool]: On list_postgres: Close
[0m02:21:48.100314 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m02:21:48.111622 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:21:48.112620 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m02:21:48.112620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:50.192284 [debug] [ThreadPool]: SQL status: BEGIN in 2.079 seconds
[0m02:21:50.192826 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:21:50.193901 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m02:21:50.201119 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m02:21:50.203260 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m02:21:50.206776 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m02:21:50.207893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_integration)
[0m02:21:50.214048 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m02:21:50.215206 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m02:21:50.215741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:21:52.277518 [debug] [ThreadPool]: SQL status: BEGIN in 2.062 seconds
[0m02:21:52.278048 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m02:21:52.279109 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m02:21:52.286985 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m02:21:52.289174 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m02:21:52.292341 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m02:21:52.305919 [debug] [MainThread]: Using postgres connection "master"
[0m02:21:52.306915 [debug] [MainThread]: On master: BEGIN
[0m02:21:52.307913 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:21:54.383027 [debug] [MainThread]: SQL status: BEGIN in 2.075 seconds
[0m02:21:54.384133 [debug] [MainThread]: Using postgres connection "master"
[0m02:21:54.385251 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:21:54.397541 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m02:21:54.399199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58b535b3-9273-4795-898f-58b966258b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017391308B50>]}
[0m02:21:54.400308 [debug] [MainThread]: On master: ROLLBACK
[0m02:21:54.403657 [debug] [MainThread]: Using postgres connection "master"
[0m02:21:54.404716 [debug] [MainThread]: On master: BEGIN
[0m02:21:54.409347 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m02:21:54.410429 [debug] [MainThread]: On master: COMMIT
[0m02:21:54.410985 [debug] [MainThread]: Using postgres connection "master"
[0m02:21:54.411522 [debug] [MainThread]: On master: COMMIT
[0m02:21:54.414285 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m02:21:54.415340 [debug] [MainThread]: On master: Close
[0m02:21:54.416444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:21:54.418101 [info ] [MainThread]: 
[0m02:21:54.435150 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.deals
[0m02:21:54.436228 [info ] [Thread-1  ]: 1 of 1 START sql table model public_pipedrive_analytics.deals .................. [RUN]
[0m02:21:54.439238 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.deals'
[0m02:21:54.439913 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.deals
[0m02:21:54.457692 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.deals"
[0m02:21:54.462636 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.deals
[0m02:21:54.534483 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.deals"
[0m02:21:54.537492 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m02:21:54.539006 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: BEGIN
[0m02:21:54.539006 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:21:56.626668 [debug] [Thread-1  ]: SQL status: BEGIN in 2.087 seconds
[0m02:21:56.628324 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m02:21:56.629939 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deals"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."deals__dbt_tmp"
  
  
    as
  
  (
    /*
    Model: deals
    
    Purpose:
        Complete deal entity combining stage progression, creation metadata,
        and outcome information. Serves as the foundational business entity
        for all deal-related analysis across the organization.
    
    Grain: One row per deal
    
    Reusability:
        This model enables multiple analytical use cases:
        - Funnel analysis at any time grain (daily, weekly, monthly, quarterly)
        - Win/loss analysis by reason, stage, or cohort
        - Sales cycle velocity and duration metrics
        - Conversion rate analysis across stages
        - Pipeline forecasting and capacity planning
        - Cohort retention and progression analysis
    
    Design Philosophy:
        Built as a reusable entity rather than report-specific aggregation.
        Maintains deal-level grain with enriched attributes to support
        flexible downstream analysis without rebuilding base logic.
*/

with deal_milestones as (

    select * from "postgres"."public_pipedrive_analytics"."trf_deal_milestones"

),

lost_reason_lookup as (
  select
    option->>'id' as lost_reason_id,
    option->>'label' as lost_reason_label
  from "postgres"."public_integration"."intg_fields",
  jsonb_array_elements(field_value_options::jsonb->'options') as option
  where field_key = 'lost_reason'
),

final as (

    select
        milestones.deal_id,
        
        -- Creation timestamps at multiple grains for flexible aggregation
        milestones.created_at,
        date_trunc('day', milestones.created_at)::date as creation_date,
        date_trunc('week', milestones.created_at)::date as creation_week,
        date_trunc('month', milestones.created_at)::date as creation_month,
        date_trunc('quarter', milestones.created_at)::date as creation_quarter,
        
        -- Stage milestones (9 funnel steps)
        milestones.stage_1_reached_at,
        milestones.stage_2_reached_at,
        milestones.stage_3_reached_at,
        milestones.stage_4_reached_at,
        milestones.stage_5_reached_at,
        milestones.stage_6_reached_at,
        milestones.stage_7_reached_at,
        milestones.stage_8_reached_at,
        milestones.stage_9_reached_at,
        
        -- Deal outcome metadata
        milestones.lost_reason_id,
        lost_reasons.lost_reason_label as lost_reason,
        
        -- Derived metrics for analysis
        milestones.stage_9_reached_at is not null as is_won,
        
        -- Only lost if has reason AND didn't win
        (milestones.lost_reason_id is not null 
         and milestones.stage_9_reached_at is null) as is_lost,

        milestones.stage_9_reached_at - milestones.created_at as sales_cycle_duration

    from deal_milestones as milestones
    
    left join lost_reason_lookup as lost_reasons
        on milestones.lost_reason_id = lost_reasons.lost_reason_id
)

select * from final
  );
  
[0m02:21:56.705160 [debug] [Thread-1  ]: SQL status: SELECT 1995 in 0.074 seconds
[0m02:21:56.716513 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m02:21:56.717514 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deals"} */
alter table "postgres"."public_pipedrive_analytics"."deals" rename to "deals__dbt_backup"
[0m02:21:56.721646 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m02:21:56.727263 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m02:21:56.728656 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deals"} */
alter table "postgres"."public_pipedrive_analytics"."deals__dbt_tmp" rename to "deals"
[0m02:21:56.733515 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m02:21:56.769333 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: COMMIT
[0m02:21:56.770334 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m02:21:56.771330 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: COMMIT
[0m02:21:56.782667 [debug] [Thread-1  ]: SQL status: COMMIT in 0.010 seconds
[0m02:21:56.800522 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."deals__dbt_backup"
[0m02:21:56.812052 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m02:21:56.813051 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deals"} */
drop table if exists "postgres"."public_pipedrive_analytics"."deals__dbt_backup" cascade
[0m02:21:56.836597 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.022 seconds
[0m02:21:56.841226 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: Close
[0m02:21:56.844584 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58b535b3-9273-4795-898f-58b966258b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001739143A6A0>]}
[0m02:21:56.846279 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_pipedrive_analytics.deals ............. [[32mSELECT 1995[0m in 2.40s]
[0m02:21:56.848016 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.deals
[0m02:21:56.852241 [debug] [MainThread]: Using postgres connection "master"
[0m02:21:56.853475 [debug] [MainThread]: On master: BEGIN
[0m02:21:56.854594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:21:58.940775 [debug] [MainThread]: SQL status: BEGIN in 2.086 seconds
[0m02:21:58.941892 [debug] [MainThread]: On master: COMMIT
[0m02:21:58.942443 [debug] [MainThread]: Using postgres connection "master"
[0m02:21:58.942988 [debug] [MainThread]: On master: COMMIT
[0m02:21:58.945124 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m02:21:58.946347 [debug] [MainThread]: On master: Close
[0m02:21:58.947453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:21:58.948563 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m02:21:58.949139 [debug] [MainThread]: Connection 'list_postgres_public_integration' was properly closed.
[0m02:21:58.949700 [debug] [MainThread]: Connection 'model.enpal_assessment_project.deals' was properly closed.
[0m02:21:58.950263 [info ] [MainThread]: 
[0m02:21:58.951381 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.28 seconds (13.28s).
[0m02:21:58.953399 [debug] [MainThread]: Command end result
[0m02:21:59.114755 [info ] [MainThread]: 
[0m02:21:59.115756 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:21:59.117418 [info ] [MainThread]: 
[0m02:21:59.118430 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:21:59.121427 [debug] [MainThread]: Command `dbt run` succeeded at 02:21:59.120434 after 15.25 seconds
[0m02:21:59.122429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001738E1EB1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001738E06FCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001738FBAF550>]}
[0m02:21:59.122940 [debug] [MainThread]: Flushing usage events
[0m02:39:45.809298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A80DC06B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A80E47DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A810719100>]}


============================== 02:39:45.824578 | 6c9cd42f-6650-465a-98ec-681a7dd84a9b ==============================
[0m02:39:45.824578 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:39:45.827098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select rep_sales_funnel_monthly', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:39:46.347635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c9cd42f-6650-465a-98ec-681a7dd84a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A810719EE0>]}
[0m02:39:46.454756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c9cd42f-6650-465a-98ec-681a7dd84a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A80DAFCE50>]}
[0m02:39:46.459583 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:39:46.489800 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:39:46.837531 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:39:46.839051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6c9cd42f-6650-465a-98ec-681a7dd84a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A80FB78520>]}
[0m02:39:48.834792 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:39:48.843150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6c9cd42f-6650-465a-98ec-681a7dd84a9b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A810C9D520>]}
[0m02:39:49.570513 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.marts
- models.curated
- models.transformation
- models.integration
[0m02:39:49.602791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c9cd42f-6650-465a-98ec-681a7dd84a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A810FDBFA0>]}
[0m02:39:49.951664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c9cd42f-6650-465a-98ec-681a7dd84a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A810FD0970>]}
[0m02:39:49.952664 [info ] [MainThread]: Found 10 models, 38 data tests, 7 sources, 423 macros
[0m02:39:49.954670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c9cd42f-6650-465a-98ec-681a7dd84a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A811057C40>]}
[0m02:39:49.959186 [info ] [MainThread]: 
[0m02:39:49.961209 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:39:49.965907 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:39:50.223911 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:39:50.224919 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:39:50.225919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:39:52.445051 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.219 seconds
[0m02:39:52.447323 [debug] [ThreadPool]: On list_postgres: Close
[0m02:39:52.456680 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m02:39:52.468059 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:39:52.468595 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m02:39:52.469145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:39:54.542567 [debug] [ThreadPool]: SQL status: BEGIN in 2.073 seconds
[0m02:39:54.543755 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m02:39:54.544922 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m02:39:54.581015 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.035 seconds
[0m02:39:54.583203 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m02:39:54.585992 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m02:39:54.587628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_integration)
[0m02:39:54.593796 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m02:39:54.594354 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m02:39:54.594912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:39:56.700118 [debug] [ThreadPool]: SQL status: BEGIN in 2.105 seconds
[0m02:39:56.701265 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m02:39:56.702431 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m02:39:56.716458 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m02:39:56.721076 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m02:39:56.725482 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m02:39:56.743784 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:56.744981 [debug] [MainThread]: On master: BEGIN
[0m02:39:56.746720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:39:58.835799 [debug] [MainThread]: SQL status: BEGIN in 2.089 seconds
[0m02:39:58.836346 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:58.836882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:39:58.857186 [debug] [MainThread]: SQL status: SELECT 0 in 0.019 seconds
[0m02:39:58.859442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c9cd42f-6650-465a-98ec-681a7dd84a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A811414280>]}
[0m02:39:58.860533 [debug] [MainThread]: On master: ROLLBACK
[0m02:39:58.863783 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:58.864316 [debug] [MainThread]: On master: BEGIN
[0m02:39:58.869273 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m02:39:58.869823 [debug] [MainThread]: On master: COMMIT
[0m02:39:58.870907 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:58.871446 [debug] [MainThread]: On master: COMMIT
[0m02:39:58.874329 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m02:39:58.875445 [debug] [MainThread]: On master: Close
[0m02:39:58.877242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:39:58.878265 [info ] [MainThread]: 
[0m02:39:58.896040 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m02:39:58.897054 [info ] [Thread-1  ]: 1 of 1 START sql table model public_pipedrive_analytics.rep_sales_funnel_monthly  [RUN]
[0m02:39:58.899053 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.rep_sales_funnel_monthly'
[0m02:39:58.900047 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m02:39:58.921003 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:39:58.928555 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m02:39:59.008200 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:39:59.015397 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:39:59.016404 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: BEGIN
[0m02:39:59.018386 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:40:01.099045 [debug] [Thread-1  ]: SQL status: BEGIN in 2.081 seconds
[0m02:40:01.100092 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:40:01.101189 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp"
  
  
    as
  
  (
    /*
    Model: rep_sales_funnel_monthly
    
    Purpose:
        Monthly sales funnel report showing deal progression through 9 stage-based
        steps. Aggregates deals by creation month cohort and counts how many reached
        each funnel milestone.
    
    Grain: month × funnel_step (one row per month per step)
    
    Columns:
        - month: First day of month when deals were created
        - kpi_name: Human-readable funnel step name
        - funnel_step: Numeric step identifier (1-9)
        - deals_count: Number of deals from this cohort that reached this step
    
    Design:
        Uses a date spine to ensure all month × step combinations exist, even when
        counts are zero. This prevents gaps in time-series visualizations and ensures
        report completeness.
    
    Note:
        Activity-based sub-steps (2.1 Sales Call 1, 3.1 Sales Call 2) are included
        but return zero counts due to documented data quality issues. See project EDA
        for validation details.
*/

with deals_base as (

    select
        creation_month,
        stage_1_reached_at,
        stage_2_reached_at,
        stage_3_reached_at,
        stage_4_reached_at,
        stage_5_reached_at,
        stage_6_reached_at,
        stage_7_reached_at,
        stage_8_reached_at,
        stage_9_reached_at
    
    from "postgres"."public_pipedrive_analytics"."deals"

),

-- Get all unique months from deals
months_spine as (

    select 
        distinct creation_month as month
    
    from deals_base

),

-- Define all funnel steps including activity-based sub-steps
steps_spine as (

    select * from (
        values
            ('1', 'Lead Generation'),
            ('2', 'Qualified Lead'),
            ('2.1', 'Sales Call 1'),
            ('3', 'Needs Assessment'),
            ('3.1', 'Sales Call 2'),
            ('4', 'Proposal/Quote Preparation'),
            ('5', 'Negotiation'),
            ('6', 'Closing'),
            ('7', 'Implementation/Onboarding'),
            ('8', 'Follow-up/Customer Success'),
            ('9', 'Renewal/Expansion')
    ) as t(funnel_step, kpi_name)

),

-- Create complete spine: every month × every step
complete_spine as (

    select
        months.month,
        steps.funnel_step,
        steps.kpi_name

    from months_spine as months
    
    cross join steps_spine as steps

),

-- Calculate actual counts per step
step_counts as (

    select
        creation_month as month,
        '1' as funnel_step,
        count(case when stage_1_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

    union all

    select
        creation_month as month,
        '2' as funnel_step,
        count(case when stage_2_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

    union all

    select
        creation_month as month,
        '3' as funnel_step,
        count(case when stage_3_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

    union all

    select
        creation_month as month,
        '4' as funnel_step,
        count(case when stage_4_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

    union all

    select
        creation_month as month,
        '5' as funnel_step,
        count(case when stage_5_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

    union all

    select
        creation_month as month,
        '6' as funnel_step,
        count(case when stage_6_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

    union all

    select
        creation_month as month,
        '7' as funnel_step,
        count(case when stage_7_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

    union all

    select
        creation_month as month,
        '8' as funnel_step,
        count(case when stage_8_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

    union all

    select
        creation_month as month,
        '9' as funnel_step,
        count(case when stage_9_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

),

final as (

    select
        spine.month,
        spine.kpi_name,
        spine.funnel_step,
        coalesce(counts.deals_count, 0) as deals_count
    
    from complete_spine as spine

    left join step_counts as counts
        on spine.month = counts.month
        and spine.funnel_step = counts.funnel_step

    order by spine.month, spine.funnel_step

)

select * from final
  );
  
[0m02:40:01.172277 [debug] [Thread-1  ]: SQL status: SELECT 99 in 0.070 seconds
[0m02:40:01.183371 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:40:01.184366 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp" rename to "rep_sales_funnel_monthly"
[0m02:40:01.190513 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.005 seconds
[0m02:40:01.218867 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m02:40:01.219883 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:40:01.220888 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m02:40:01.227548 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m02:40:01.238249 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup"
[0m02:40:01.245283 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:40:01.246292 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
drop table if exists "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup" cascade
[0m02:40:01.253659 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m02:40:01.258133 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m02:40:01.261428 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c9cd42f-6650-465a-98ec-681a7dd84a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A811460730>]}
[0m02:40:01.263070 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_pipedrive_analytics.rep_sales_funnel_monthly  [[32mSELECT 99[0m in 2.36s]
[0m02:40:01.264178 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m02:40:01.269066 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:01.270247 [debug] [MainThread]: On master: BEGIN
[0m02:40:01.271381 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:40:03.330752 [debug] [MainThread]: SQL status: BEGIN in 2.060 seconds
[0m02:40:03.331944 [debug] [MainThread]: On master: COMMIT
[0m02:40:03.332496 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:03.333624 [debug] [MainThread]: On master: COMMIT
[0m02:40:03.336383 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m02:40:03.337490 [debug] [MainThread]: On master: Close
[0m02:40:03.338607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:40:03.339156 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m02:40:03.340221 [debug] [MainThread]: Connection 'list_postgres_public_integration' was properly closed.
[0m02:40:03.340801 [debug] [MainThread]: Connection 'model.enpal_assessment_project.rep_sales_funnel_monthly' was properly closed.
[0m02:40:03.341350 [info ] [MainThread]: 
[0m02:40:03.342367 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.38 seconds (13.38s).
[0m02:40:03.345244 [debug] [MainThread]: Command end result
[0m02:40:03.426945 [info ] [MainThread]: 
[0m02:40:03.428951 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:40:03.429941 [info ] [MainThread]: 
[0m02:40:03.431942 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:40:03.433942 [debug] [MainThread]: Command `dbt run` succeeded at 02:40:03.433942 after 17.78 seconds
[0m02:40:03.434937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A80DC06B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A80FB78610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A80E1A4670>]}
[0m02:40:03.436463 [debug] [MainThread]: Flushing usage events
[0m11:08:08.250379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C937B70B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C93A68C3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9369ACCA0>]}


============================== 11:08:08.288592 | a6a5f935-bc5b-45f1-9744-f67b4b82fabb ==============================
[0m11:08:08.288592 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:08:08.291635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select trf_deal_milestones', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:08:08.745525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6a5f935-bc5b-45f1-9744-f67b4b82fabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C93A54BA90>]}
[0m11:08:08.810510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6a5f935-bc5b-45f1-9744-f67b4b82fabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C937A79C40>]}
[0m11:08:08.813205 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:08:08.862711 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:08:11.294369 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m11:08:11.295380 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\transformation\schema.yml
[0m11:08:11.295380 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://analyses\exploratory_analysis.md
[0m11:08:11.296378 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\transformation\trf_deal_milestones.sql
[0m11:08:11.562320 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:08:11.563847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a6a5f935-bc5b-45f1-9744-f67b4b82fabb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C93ACF3A90>]}
[0m11:08:11.864499 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.curated
- models.marts
- models.transformation
- models.integration
[0m11:08:11.883085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6a5f935-bc5b-45f1-9744-f67b4b82fabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C93B027CA0>]}
[0m11:08:12.225792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6a5f935-bc5b-45f1-9744-f67b4b82fabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C93B0CBDC0>]}
[0m11:08:12.225792 [info ] [MainThread]: Found 10 models, 38 data tests, 7 sources, 423 macros
[0m11:08:12.227184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6a5f935-bc5b-45f1-9744-f67b4b82fabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C93AFEEFD0>]}
[0m11:08:12.228696 [info ] [MainThread]: 
[0m11:08:12.229940 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:08:12.232843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:08:17.349808 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:08:17.349808 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:08:17.350851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:19.538721 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.188 seconds
[0m11:08:19.540851 [debug] [ThreadPool]: On list_postgres: Close
[0m11:08:19.542445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_transformation)
[0m11:08:19.543553 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_transformation"
"
[0m11:08:19.550634 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_transformation"
[0m11:08:19.551153 [debug] [ThreadPool]: On create_postgres_public_transformation: BEGIN
[0m11:08:19.551153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:21.630882 [debug] [ThreadPool]: SQL status: BEGIN in 2.080 seconds
[0m11:08:21.631427 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_transformation"
[0m11:08:21.631971 [debug] [ThreadPool]: On create_postgres_public_transformation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_transformation"} */
create schema if not exists "public_transformation"
[0m11:08:21.649613 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.017 seconds
[0m11:08:21.651209 [debug] [ThreadPool]: On create_postgres_public_transformation: COMMIT
[0m11:08:21.651745 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_transformation"
[0m11:08:21.652287 [debug] [ThreadPool]: On create_postgres_public_transformation: COMMIT
[0m11:08:21.663591 [debug] [ThreadPool]: SQL status: COMMIT in 0.011 seconds
[0m11:08:21.664623 [debug] [ThreadPool]: On create_postgres_public_transformation: Close
[0m11:08:21.672870 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_transformation'
[0m11:08:21.680380 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m11:08:21.680922 [debug] [ThreadPool]: On list_postgres_public_transformation: BEGIN
[0m11:08:21.681459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:23.759446 [debug] [ThreadPool]: SQL status: BEGIN in 2.078 seconds
[0m11:08:23.759982 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m11:08:23.760521 [debug] [ThreadPool]: On list_postgres_public_transformation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_transformation"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_transformation'
  
[0m11:08:23.802807 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.042 seconds
[0m11:08:23.804406 [debug] [ThreadPool]: On list_postgres_public_transformation: ROLLBACK
[0m11:08:23.806567 [debug] [ThreadPool]: On list_postgres_public_transformation: Close
[0m11:08:23.807645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_transformation, now list_postgres_public_pipedrive_analytics)
[0m11:08:23.810978 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:08:23.811523 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m11:08:23.812083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:25.893100 [debug] [ThreadPool]: SQL status: BEGIN in 2.081 seconds
[0m11:08:25.893655 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:08:25.894194 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m11:08:25.900206 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m11:08:25.901806 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m11:08:25.904032 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m11:08:25.905140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_integration)
[0m11:08:25.912068 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m11:08:25.912068 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m11:08:25.912068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:28.002676 [debug] [ThreadPool]: SQL status: BEGIN in 2.090 seconds
[0m11:08:28.003219 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m11:08:28.003758 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m11:08:28.010317 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m11:08:28.012476 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m11:08:28.015097 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m11:08:28.023524 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:28.024061 [debug] [MainThread]: On master: BEGIN
[0m11:08:28.024617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:08:30.076804 [debug] [MainThread]: SQL status: BEGIN in 2.052 seconds
[0m11:08:30.077331 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:30.077854 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:08:30.100903 [debug] [MainThread]: SQL status: SELECT 0 in 0.023 seconds
[0m11:08:30.102501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6a5f935-bc5b-45f1-9744-f67b4b82fabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C937ADB400>]}
[0m11:08:30.103591 [debug] [MainThread]: On master: ROLLBACK
[0m11:08:30.105299 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:30.105837 [debug] [MainThread]: On master: BEGIN
[0m11:08:30.109107 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:08:30.110292 [debug] [MainThread]: On master: COMMIT
[0m11:08:30.110824 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:30.110824 [debug] [MainThread]: On master: COMMIT
[0m11:08:30.112421 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:08:30.113458 [debug] [MainThread]: On master: Close
[0m11:08:30.114011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:08:30.114555 [info ] [MainThread]: 
[0m11:08:30.144719 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.trf_deal_milestones
[0m11:08:30.145245 [info ] [Thread-1  ]: 1 of 1 START sql table model public_transformation.trf_deal_milestones ......... [RUN]
[0m11:08:30.146296 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.trf_deal_milestones'
[0m11:08:30.147757 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.trf_deal_milestones
[0m11:08:30.159945 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.trf_deal_milestones"
[0m11:08:30.166620 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.trf_deal_milestones
[0m11:08:30.223641 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.trf_deal_milestones"
[0m11:08:30.227318 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m11:08:30.228317 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: BEGIN
[0m11:08:30.229318 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:08:32.316820 [debug] [Thread-1  ]: SQL status: BEGIN in 2.087 seconds
[0m11:08:32.317360 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m11:08:32.318438 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.trf_deal_milestones"} */

  
    

  create  table "postgres"."public_transformation"."trf_deal_milestones__dbt_tmp"
  
  
    as
  
  (
    /*
    Model: trf_deal_milestones
    
    Purpose:
        Captures deal lifecycle milestones including stage progression,
        creation timestamp, and outcome metadata. Combines all key
        temporal and outcome data points for each deal.
    
    Grain: One row per deal
    
    Business Logic:
        - Pivots stage transitions to wide format (9 stage columns)
        - Extracts deal creation timestamp from add_time events
        - Captures latest lost_reason if deal was lost BEFORE winning
        - Filters out spurious lost_reasons set after deals reached stage 9
        - One row per deal with all temporal milestones
*/



with stage_changes as (

    select
        deal_id,
        new_value as stage_id,
        change_time as stage_reached_at

    from "postgres"."public_integration"."intg_deal_changes"
    
    where changed_field_key = 'stage_id'

),

creation_times as (

    select
        deal_id,
        min(change_time) as created_at

    from "postgres"."public_integration"."intg_deal_changes"
    
    where changed_field_key = 'add_time'
    
    group by deal_id

),

stage_9_times as (

    -- Get the timestamp when each deal reached stage 9 (won)
    -- Used to filter out lost_reasons that were set AFTER winning
    select
        deal_id,
        min(change_time) as stage_9_reached_at

    from "postgres"."public_integration"."intg_deal_changes"
    
    where changed_field_key = 'stage_id'
      and new_value = '9'
    
    group by deal_id

),

lost_reasons_raw as (

    -- Extract lost_reasons, but only those set BEFORE stage 9 (or if never reached stage 9)
    -- Data quality issue: All won deals have lost_reasons set 1-39 days AFTER winning, these are filtered out
    select
        lost_reasons.deal_id,
        lost_reasons.new_value as lost_reason_id,
        lost_reasons.change_time,
        s9.stage_9_reached_at,
       
        row_number() 
            over (partition by lost_reasons.deal_id order by lost_reasons.change_time desc) as row_number

    from "postgres"."public_integration"."intg_deal_changes" as lost_reasons
    
    left join stage_9_times as s9 
        on lost_reasons.deal_id = s9.deal_id
    
    where lost_reasons.changed_field_key = 'lost_reason'
      -- Only include lost_reasons set BEFORE stage 9 (or if never reached stage 9)
      and (s9.stage_9_reached_at is null 
           or lost_reasons.change_time <= s9.stage_9_reached_at)

),


lost_reasons as (
    
    -- Take the most recent valid lost_reason per deal
    select
        deal_id,
        lost_reason_id

    from lost_reasons_raw
    
    where row_number = 1

),


stage_pivot as (

    -- Pivot stage changes to wide format: one column per stage
    select
        deal_id,
        
        min(case when stage_id = '1' then stage_reached_at end) as stage_1_reached_at,
        min(case when stage_id = '2' then stage_reached_at end) as stage_2_reached_at,
        min(case when stage_id = '3' then stage_reached_at end) as stage_3_reached_at,
        min(case when stage_id = '4' then stage_reached_at end) as stage_4_reached_at,
        min(case when stage_id = '5' then stage_reached_at end) as stage_5_reached_at,
        min(case when stage_id = '6' then stage_reached_at end) as stage_6_reached_at,
        min(case when stage_id = '7' then stage_reached_at end) as stage_7_reached_at,
        min(case when stage_id = '8' then stage_reached_at end) as stage_8_reached_at,
        min(case when stage_id = '9' then stage_reached_at end) as stage_9_reached_at

    from stage_changes
    
    group by deal_id

),

final as (

    select
        pivot.deal_id,
        
        -- Creation timestamp
        creation_times.created_at,
        
        -- Stage milestones
        pivot.stage_1_reached_at,
        pivot.stage_2_reached_at,
        pivot.stage_3_reached_at,
        pivot.stage_4_reached_at,
        pivot.stage_5_reached_at,
        pivot.stage_6_reached_at,
        pivot.stage_7_reached_at,
        pivot.stage_8_reached_at,
        pivot.stage_9_reached_at,
        
        -- Outcome metadata
        lost_reasons.lost_reason_id

    from stage_pivot as pivot
    
    left join creation_times 
        on pivot.deal_id = creation_times.deal_id

    left join lost_reasons 
        on pivot.deal_id = lost_reasons.deal_id

)

select * from final
  );
  
[0m11:08:32.458302 [debug] [Thread-1  ]: SQL status: SELECT 1995 in 0.139 seconds
[0m11:08:32.465963 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m11:08:32.466481 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.trf_deal_milestones"} */
alter table "postgres"."public_transformation"."trf_deal_milestones__dbt_tmp" rename to "trf_deal_milestones"
[0m11:08:32.470461 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:08:32.494028 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: COMMIT
[0m11:08:32.494028 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m11:08:32.494028 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: COMMIT
[0m11:08:32.500545 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m11:08:32.509765 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_transformation"."trf_deal_milestones__dbt_backup"
[0m11:08:32.515673 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.trf_deal_milestones"
[0m11:08:32.517180 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.trf_deal_milestones"} */
drop table if exists "postgres"."public_transformation"."trf_deal_milestones__dbt_backup" cascade
[0m11:08:32.522163 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m11:08:32.524801 [debug] [Thread-1  ]: On model.enpal_assessment_project.trf_deal_milestones: Close
[0m11:08:32.526968 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a5f935-bc5b-45f1-9744-f67b4b82fabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C93ADFF820>]}
[0m11:08:32.528032 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_transformation.trf_deal_milestones .... [[32mSELECT 1995[0m in 2.38s]
[0m11:08:32.529175 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.trf_deal_milestones
[0m11:08:32.532520 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:32.533050 [debug] [MainThread]: On master: BEGIN
[0m11:08:32.533583 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:08:34.617456 [debug] [MainThread]: SQL status: BEGIN in 2.084 seconds
[0m11:08:34.618556 [debug] [MainThread]: On master: COMMIT
[0m11:08:34.620091 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:34.621253 [debug] [MainThread]: On master: COMMIT
[0m11:08:34.625345 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m11:08:34.626493 [debug] [MainThread]: On master: Close
[0m11:08:34.628736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:34.629753 [debug] [MainThread]: Connection 'create_postgres_public_transformation' was properly closed.
[0m11:08:34.631245 [debug] [MainThread]: Connection 'list_postgres_public_integration' was properly closed.
[0m11:08:34.632242 [debug] [MainThread]: Connection 'model.enpal_assessment_project.trf_deal_milestones' was properly closed.
[0m11:08:34.633246 [info ] [MainThread]: 
[0m11:08:34.635848 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.40 seconds (22.40s).
[0m11:08:34.638864 [debug] [MainThread]: Command end result
[0m11:08:34.750831 [info ] [MainThread]: 
[0m11:08:34.753924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:08:34.756490 [info ] [MainThread]: 
[0m11:08:34.758733 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:08:34.760772 [debug] [MainThread]: Command `dbt run` succeeded at 11:08:34.760259 after 26.63 seconds
[0m11:08:34.761284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C93A54BA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C93811E670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C939AFDC10>]}
[0m11:08:34.762306 [debug] [MainThread]: Flushing usage events
[0m12:03:13.891871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267983EBB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026798C6DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002679AF0A100>]}


============================== 12:03:13.916519 | 382d35fc-6271-4c10-b57e-f904f39e2879 ==============================
[0m12:03:13.916519 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:03:13.917545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select deals', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:03:14.312280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '382d35fc-6271-4c10-b57e-f904f39e2879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002679AF0AEE0>]}
[0m12:03:14.373195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '382d35fc-6271-4c10-b57e-f904f39e2879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267982F9E80>]}
[0m12:03:14.375777 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:03:14.420668 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:03:16.500981 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m12:03:16.501982 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models\marts\schema.yml
[0m12:03:16.501982 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\marts\rep_sales_funnel_monthly.sql
[0m12:03:16.502987 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models\curated\deals.sql
[0m12:03:16.734775 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:03:16.736775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '382d35fc-6271-4c10-b57e-f904f39e2879', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026798295E20>]}
[0m12:03:17.144927 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.marts
- models.curated
- models.integration
- models.transformation
[0m12:03:17.162314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '382d35fc-6271-4c10-b57e-f904f39e2879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002679B9007F0>]}
[0m12:03:17.442397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '382d35fc-6271-4c10-b57e-f904f39e2879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002679B8CF400>]}
[0m12:03:17.443861 [info ] [MainThread]: Found 10 models, 38 data tests, 7 sources, 423 macros
[0m12:03:17.444439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '382d35fc-6271-4c10-b57e-f904f39e2879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002679B91A3A0>]}
[0m12:03:17.446528 [info ] [MainThread]: 
[0m12:03:17.447559 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:03:17.449562 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:03:22.086778 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:03:22.087773 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:03:22.087773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:24.265948 [debug] [ThreadPool]: SQL status: SELECT 7 in 2.178 seconds
[0m12:03:24.268153 [debug] [ThreadPool]: On list_postgres: Close
[0m12:03:24.269762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_curated)
[0m12:03:24.270991 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_curated"
"
[0m12:03:24.279221 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_curated"
[0m12:03:24.280222 [debug] [ThreadPool]: On create_postgres_public_curated: BEGIN
[0m12:03:24.280222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:26.365219 [debug] [ThreadPool]: SQL status: BEGIN in 2.085 seconds
[0m12:03:26.365765 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_curated"
[0m12:03:26.366307 [debug] [ThreadPool]: On create_postgres_public_curated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_curated"} */
create schema if not exists "public_curated"
[0m12:03:26.383973 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.018 seconds
[0m12:03:26.385860 [debug] [ThreadPool]: On create_postgres_public_curated: COMMIT
[0m12:03:26.386412 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_curated"
[0m12:03:26.386976 [debug] [ThreadPool]: On create_postgres_public_curated: COMMIT
[0m12:03:26.403013 [debug] [ThreadPool]: SQL status: COMMIT in 0.015 seconds
[0m12:03:26.403626 [debug] [ThreadPool]: On create_postgres_public_curated: Close
[0m12:03:26.410713 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_marts'
[0m12:03:26.418375 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m12:03:26.419085 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m12:03:26.419646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:28.507456 [debug] [ThreadPool]: SQL status: BEGIN in 2.088 seconds
[0m12:03:28.508040 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m12:03:28.508587 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m12:03:28.535287 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.027 seconds
[0m12:03:28.537423 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m12:03:28.539629 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m12:03:28.540732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts, now list_postgres_public_pipedrive_analytics)
[0m12:03:28.544034 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m12:03:28.544577 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m12:03:28.544577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:30.631561 [debug] [ThreadPool]: SQL status: BEGIN in 2.086 seconds
[0m12:03:30.632087 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m12:03:30.632087 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m12:03:30.638818 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m12:03:30.640433 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m12:03:30.642585 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m12:03:30.643636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_integration)
[0m12:03:30.647493 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m12:03:30.648037 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m12:03:30.648621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:32.725685 [debug] [ThreadPool]: SQL status: BEGIN in 2.077 seconds
[0m12:03:32.726271 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m12:03:32.726797 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m12:03:32.731679 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m12:03:32.733816 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m12:03:32.735446 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m12:03:32.736508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_integration, now list_postgres_public_curated)
[0m12:03:32.739760 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_curated"
[0m12:03:32.741448 [debug] [ThreadPool]: On list_postgres_public_curated: BEGIN
[0m12:03:32.741448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:34.811096 [debug] [ThreadPool]: SQL status: BEGIN in 2.069 seconds
[0m12:03:34.812132 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_curated"
[0m12:03:34.812657 [debug] [ThreadPool]: On list_postgres_public_curated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_curated"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_curated'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_curated'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_curated'
  
[0m12:03:34.818127 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m12:03:34.819204 [debug] [ThreadPool]: On list_postgres_public_curated: ROLLBACK
[0m12:03:34.821419 [debug] [ThreadPool]: On list_postgres_public_curated: Close
[0m12:03:34.822502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_curated, now list_postgres_public_transformation)
[0m12:03:34.825258 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m12:03:34.825786 [debug] [ThreadPool]: On list_postgres_public_transformation: BEGIN
[0m12:03:34.826313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:36.892946 [debug] [ThreadPool]: SQL status: BEGIN in 2.067 seconds
[0m12:03:36.893484 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m12:03:36.894045 [debug] [ThreadPool]: On list_postgres_public_transformation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_transformation"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_transformation'
  
[0m12:03:36.900012 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m12:03:36.901699 [debug] [ThreadPool]: On list_postgres_public_transformation: ROLLBACK
[0m12:03:36.903922 [debug] [ThreadPool]: On list_postgres_public_transformation: Close
[0m12:03:36.911505 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:36.912071 [debug] [MainThread]: On master: BEGIN
[0m12:03:36.912613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:03:39.002965 [debug] [MainThread]: SQL status: BEGIN in 2.090 seconds
[0m12:03:39.003535 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:39.004049 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:03:39.030160 [debug] [MainThread]: SQL status: SELECT 0 in 0.026 seconds
[0m12:03:39.031910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '382d35fc-6271-4c10-b57e-f904f39e2879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002679B9B2EB0>]}
[0m12:03:39.033005 [debug] [MainThread]: On master: ROLLBACK
[0m12:03:39.035749 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:39.036295 [debug] [MainThread]: On master: BEGIN
[0m12:03:39.040621 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m12:03:39.041183 [debug] [MainThread]: On master: COMMIT
[0m12:03:39.041718 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:39.041718 [debug] [MainThread]: On master: COMMIT
[0m12:03:39.044395 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:03:39.044939 [debug] [MainThread]: On master: Close
[0m12:03:39.046616 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:03:39.048292 [info ] [MainThread]: 
[0m12:03:39.080683 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.deals
[0m12:03:39.082196 [info ] [Thread-1  ]: 1 of 1 START sql table model public_curated.deals .............................. [RUN]
[0m12:03:39.082196 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.deals'
[0m12:03:39.083637 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.deals
[0m12:03:39.094394 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.deals"
[0m12:03:39.098400 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.deals
[0m12:03:39.143144 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.deals"
[0m12:03:39.146678 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m12:03:39.147658 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: BEGIN
[0m12:03:39.147658 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:03:41.234356 [debug] [Thread-1  ]: SQL status: BEGIN in 2.086 seconds
[0m12:03:41.234887 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m12:03:41.234887 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deals"} */

  
    

  create  table "postgres"."public_curated"."deals__dbt_tmp"
  
  
    as
  
  (
    /*
    Model: deals
    
    Purpose:
        Complete deal entity combining stage progression, creation metadata,
        and outcome information. Serves as the foundational business entity
        for all deal-related analysis across the organization.
    
    Grain: One row per deal
    
    Reusability:
        This model enables multiple analytical use cases:
        - Funnel analysis at any time grain (daily, weekly, monthly, quarterly)
        - Win/loss analysis by reason, stage, or cohort
        - Sales cycle velocity and duration metrics
        - Conversion rate analysis across stages
        - Pipeline forecasting and capacity planning
        - Cohort retention and progression analysis
    
    Design Philosophy:
        Built as a reusable entity rather than report-specific aggregation.
        Maintains deal-level grain with enriched attributes to support
        flexible downstream analysis without rebuilding base logic.
*/


with deal_milestones as (

    select * from "postgres"."public_transformation"."trf_deal_milestones"

),

lost_reason_lookup as (
  select
    option->>'id' as lost_reason_id,
    option->>'label' as lost_reason_label
  from "postgres"."public_integration"."intg_fields",
  jsonb_array_elements(field_value_options::jsonb->'options') as option
  where field_key = 'lost_reason'
),

final as (

    select
        milestones.deal_id,
        
        -- Creation timestamps at multiple grains for flexible aggregation
        milestones.created_at,
        date_trunc('day', milestones.created_at)::date as creation_date,
        date_trunc('week', milestones.created_at)::date as creation_week,
        date_trunc('month', milestones.created_at)::date as creation_month,
        date_trunc('quarter', milestones.created_at)::date as creation_quarter,
        
        -- Stage milestones (9 funnel steps)
        milestones.stage_1_reached_at,
        milestones.stage_2_reached_at,
        milestones.stage_3_reached_at,
        milestones.stage_4_reached_at,
        milestones.stage_5_reached_at,
        milestones.stage_6_reached_at,
        milestones.stage_7_reached_at,
        milestones.stage_8_reached_at,
        milestones.stage_9_reached_at,
        
        -- Deal outcome metadata
        milestones.lost_reason_id,
        lost_reasons.lost_reason_label as lost_reason,
        
        -- Derived metrics for analysis
        milestones.stage_9_reached_at is not null as is_won,
        
        -- Only lost if has reason AND didn't win
        (milestones.lost_reason_id is not null 
         and milestones.stage_9_reached_at is null) as is_lost,

        milestones.stage_9_reached_at - milestones.created_at as sales_cycle_duration

    from deal_milestones as milestones
    
    left join lost_reason_lookup as lost_reasons
        on milestones.lost_reason_id = lost_reasons.lost_reason_id
)

select * from final
  );
  
[0m12:03:41.325772 [debug] [Thread-1  ]: SQL status: SELECT 1995 in 0.090 seconds
[0m12:03:41.333074 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m12:03:41.333617 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deals"} */
alter table "postgres"."public_curated"."deals__dbt_tmp" rename to "deals"
[0m12:03:41.336521 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:03:41.355775 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: COMMIT
[0m12:03:41.356773 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m12:03:41.356773 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: COMMIT
[0m12:03:41.367394 [debug] [Thread-1  ]: SQL status: COMMIT in 0.010 seconds
[0m12:03:41.374055 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_curated"."deals__dbt_backup"
[0m12:03:41.379116 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.deals"
[0m12:03:41.379116 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.deals"} */
drop table if exists "postgres"."public_curated"."deals__dbt_backup" cascade
[0m12:03:41.384521 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m12:03:41.387754 [debug] [Thread-1  ]: On model.enpal_assessment_project.deals: Close
[0m12:03:41.389917 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '382d35fc-6271-4c10-b57e-f904f39e2879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002679CB83C10>]}
[0m12:03:41.390975 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_curated.deals ......................... [[32mSELECT 1995[0m in 2.31s]
[0m12:03:41.392027 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.deals
[0m12:03:41.393694 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:41.394250 [debug] [MainThread]: On master: BEGIN
[0m12:03:41.394781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:03:43.460232 [debug] [MainThread]: SQL status: BEGIN in 2.066 seconds
[0m12:03:43.460771 [debug] [MainThread]: On master: COMMIT
[0m12:03:43.461328 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:43.461328 [debug] [MainThread]: On master: COMMIT
[0m12:03:43.463611 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:03:43.464701 [debug] [MainThread]: On master: Close
[0m12:03:43.465253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:43.465793 [debug] [MainThread]: Connection 'create_postgres_public_curated' was properly closed.
[0m12:03:43.465793 [debug] [MainThread]: Connection 'list_postgres_public_transformation' was properly closed.
[0m12:03:43.466342 [debug] [MainThread]: Connection 'model.enpal_assessment_project.deals' was properly closed.
[0m12:03:43.466342 [info ] [MainThread]: 
[0m12:03:43.466885 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 26.02 seconds (26.02s).
[0m12:03:43.468956 [debug] [MainThread]: Command end result
[0m12:03:43.523813 [info ] [MainThread]: 
[0m12:03:43.524811 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:43.525815 [info ] [MainThread]: 
[0m12:03:43.525815 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:03:43.527245 [debug] [MainThread]: Command `dbt run` succeeded at 12:03:43.527245 after 29.74 seconds
[0m12:03:43.528247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267983EBB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002679B8CF400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002679B93A400>]}
[0m12:03:43.528247 [debug] [MainThread]: Flushing usage events
[0m12:05:54.366455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E7864B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E80DDD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229EA369100>]}


============================== 12:05:54.380700 | 463d33f9-245b-4636-8fb1-843110600c8b ==============================
[0m12:05:54.380700 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:05:54.381714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment', 'log_path': 'C:\\Users\\yashd\\Downloads\\dbt_enpal_assessment\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select rep_sales_funnel_monthly', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:05:54.677625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '463d33f9-245b-4636-8fb1-843110600c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229EA369EE0>]}
[0m12:05:54.750749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '463d33f9-245b-4636-8fb1-843110600c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E7769E80>]}
[0m12:05:54.754279 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:05:54.774983 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:05:55.343883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:05:55.344884 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:05:55.364180 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.marts
- models.curated
- models.transformation
- models.integration
[0m12:05:55.474694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '463d33f9-245b-4636-8fb1-843110600c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229EA94FE20>]}
[0m12:05:55.839338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '463d33f9-245b-4636-8fb1-843110600c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229EAA1BEE0>]}
[0m12:05:55.841043 [info ] [MainThread]: Found 10 models, 38 data tests, 7 sources, 423 macros
[0m12:05:55.842396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '463d33f9-245b-4636-8fb1-843110600c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229EA9F8EB0>]}
[0m12:05:55.844921 [info ] [MainThread]: 
[0m12:05:55.847115 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:05:55.850142 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:05:56.084102 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:05:56.084102 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:05:56.085102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:58.201568 [debug] [ThreadPool]: SQL status: SELECT 8 in 2.116 seconds
[0m12:05:58.203148 [debug] [ThreadPool]: On list_postgres: Close
[0m12:05:58.204789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_marts)
[0m12:05:58.205883 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_marts"
"
[0m12:05:58.213837 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_marts"
[0m12:05:58.213837 [debug] [ThreadPool]: On create_postgres_public_marts: BEGIN
[0m12:05:58.214929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:06:00.292887 [debug] [ThreadPool]: SQL status: BEGIN in 2.078 seconds
[0m12:06:00.293430 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_marts"
[0m12:06:00.294534 [debug] [ThreadPool]: On create_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_marts"} */
create schema if not exists "public_marts"
[0m12:06:00.297308 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m12:06:00.298943 [debug] [ThreadPool]: On create_postgres_public_marts: COMMIT
[0m12:06:00.299484 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_marts"
[0m12:06:00.300035 [debug] [ThreadPool]: On create_postgres_public_marts: COMMIT
[0m12:06:00.304391 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m12:06:00.305505 [debug] [ThreadPool]: On create_postgres_public_marts: Close
[0m12:06:00.317296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_transformation'
[0m12:06:00.330082 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m12:06:00.331082 [debug] [ThreadPool]: On list_postgres_public_transformation: BEGIN
[0m12:06:00.331082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:02.414962 [debug] [ThreadPool]: SQL status: BEGIN in 2.083 seconds
[0m12:06:02.415513 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_transformation"
[0m12:06:02.416068 [debug] [ThreadPool]: On list_postgres_public_transformation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_transformation"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_transformation'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_transformation'
  
[0m12:06:02.422034 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m12:06:02.423681 [debug] [ThreadPool]: On list_postgres_public_transformation: ROLLBACK
[0m12:06:02.425890 [debug] [ThreadPool]: On list_postgres_public_transformation: Close
[0m12:06:02.427020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_transformation, now list_postgres_public_integration)
[0m12:06:02.430932 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m12:06:02.432011 [debug] [ThreadPool]: On list_postgres_public_integration: BEGIN
[0m12:06:02.432011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:06:04.508251 [debug] [ThreadPool]: SQL status: BEGIN in 2.076 seconds
[0m12:06:04.509115 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_integration"
[0m12:06:04.510177 [debug] [ThreadPool]: On list_postgres_public_integration: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_integration"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_integration'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_integration'
  
[0m12:06:04.517286 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m12:06:04.520131 [debug] [ThreadPool]: On list_postgres_public_integration: ROLLBACK
[0m12:06:04.523786 [debug] [ThreadPool]: On list_postgres_public_integration: Close
[0m12:06:04.525466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_integration, now list_postgres_public_pipedrive_analytics)
[0m12:06:04.533156 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m12:06:04.533702 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m12:06:04.534242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:06:06.600415 [debug] [ThreadPool]: SQL status: BEGIN in 2.066 seconds
[0m12:06:06.600962 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m12:06:06.601499 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m12:06:06.609813 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m12:06:06.612430 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m12:06:06.614700 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m12:06:06.616300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now list_postgres_public_curated)
[0m12:06:06.623698 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_curated"
[0m12:06:06.625392 [debug] [ThreadPool]: On list_postgres_public_curated: BEGIN
[0m12:06:06.627063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:06:08.704819 [debug] [ThreadPool]: SQL status: BEGIN in 2.078 seconds
[0m12:06:08.705933 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_curated"
[0m12:06:08.707053 [debug] [ThreadPool]: On list_postgres_public_curated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_curated"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_curated'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_curated'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_curated'
  
[0m12:06:08.716337 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m12:06:08.719130 [debug] [ThreadPool]: On list_postgres_public_curated: ROLLBACK
[0m12:06:08.722010 [debug] [ThreadPool]: On list_postgres_public_curated: Close
[0m12:06:08.724216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_curated, now list_postgres_public_marts)
[0m12:06:08.730423 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m12:06:08.731520 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m12:06:08.732615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:06:10.824908 [debug] [ThreadPool]: SQL status: BEGIN in 2.092 seconds
[0m12:06:10.825436 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m12:06:10.825965 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m12:06:10.831203 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m12:06:10.832285 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m12:06:10.834450 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m12:06:10.842218 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:10.843234 [debug] [MainThread]: On master: BEGIN
[0m12:06:10.843234 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:06:12.943478 [debug] [MainThread]: SQL status: BEGIN in 2.100 seconds
[0m12:06:12.944009 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:12.944533 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:06:12.952023 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m12:06:12.953651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '463d33f9-245b-4636-8fb1-843110600c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E77D8FD0>]}
[0m12:06:12.954745 [debug] [MainThread]: On master: ROLLBACK
[0m12:06:12.956882 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:12.957533 [debug] [MainThread]: On master: BEGIN
[0m12:06:12.961337 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m12:06:12.961871 [debug] [MainThread]: On master: COMMIT
[0m12:06:12.962396 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:12.962396 [debug] [MainThread]: On master: COMMIT
[0m12:06:12.964524 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:06:12.965609 [debug] [MainThread]: On master: Close
[0m12:06:12.966153 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:06:12.966686 [info ] [MainThread]: 
[0m12:06:12.979811 [debug] [Thread-1  ]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m12:06:12.980346 [info ] [Thread-1  ]: 1 of 1 START sql table model public_marts.rep_sales_funnel_monthly ............. [RUN]
[0m12:06:12.981355 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.enpal_assessment_project.rep_sales_funnel_monthly'
[0m12:06:12.981355 [debug] [Thread-1  ]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m12:06:12.996338 [debug] [Thread-1  ]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m12:06:12.999334 [debug] [Thread-1  ]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m12:06:13.054915 [debug] [Thread-1  ]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m12:06:13.066077 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m12:06:13.066077 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: BEGIN
[0m12:06:13.067207 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:06:15.154080 [debug] [Thread-1  ]: SQL status: BEGIN in 2.086 seconds
[0m12:06:15.155633 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m12:06:15.157640 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

  
    

  create  table "postgres"."public_marts"."rep_sales_funnel_monthly__dbt_tmp"
  
  
    as
  
  (
    /*
    Model: rep_sales_funnel_monthly
    
    Purpose:
        Monthly sales funnel report showing deal progression through 9 stage-based
        steps. Aggregates deals by creation month cohort and counts how many reached
        each funnel milestone.
    
    Grain: month × funnel_step (one row per month per step)
    
    Columns:
        - month: First day of month when deals were created
        - kpi_name: Human-readable funnel step name
        - funnel_step: Numeric step identifier (1-9)
        - deals_count: Number of deals from this cohort that reached this step
    
    Design:
        Uses a date spine to ensure all month × step combinations exist, even when
        counts are zero. This prevents gaps in time-series visualizations and ensures
        report completeness.
    
    Note:
        Activity-based sub-steps (2.1 Sales Call 1, 3.1 Sales Call 2) are included
        but return zero counts due to documented data quality issues. See project EDA
        for validation details.
*/


with deals_base as (

    select
        creation_month,
        stage_1_reached_at,
        stage_2_reached_at,
        stage_3_reached_at,
        stage_4_reached_at,
        stage_5_reached_at,
        stage_6_reached_at,
        stage_7_reached_at,
        stage_8_reached_at,
        stage_9_reached_at
    
    from "postgres"."public_curated"."deals"

),

-- Get all unique months from deals
months_spine as (

    select 
        distinct creation_month as month
    
    from deals_base

),

-- Define all funnel steps including activity-based sub-steps
steps_spine as (

    select * from (
        values
            ('1', 'Lead Generation'),
            ('2', 'Qualified Lead'),
            ('2.1', 'Sales Call 1'),
            ('3', 'Needs Assessment'),
            ('3.1', 'Sales Call 2'),
            ('4', 'Proposal/Quote Preparation'),
            ('5', 'Negotiation'),
            ('6', 'Closing'),
            ('7', 'Implementation/Onboarding'),
            ('8', 'Follow-up/Customer Success'),
            ('9', 'Renewal/Expansion')
    ) as t(funnel_step, kpi_name)

),

-- Create complete spine: every month × every step
complete_spine as (

    select
        months.month,
        steps.funnel_step,
        steps.kpi_name

    from months_spine as months
    
    cross join steps_spine as steps

),

-- Calculate actual counts per step
step_counts as (

    select
        creation_month as month,
        '1' as funnel_step,
        count(case when stage_1_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

    union all

    select
        creation_month as month,
        '2' as funnel_step,
        count(case when stage_2_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

    union all

    select
        creation_month as month,
        '3' as funnel_step,
        count(case when stage_3_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

    union all

    select
        creation_month as month,
        '4' as funnel_step,
        count(case when stage_4_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

    union all

    select
        creation_month as month,
        '5' as funnel_step,
        count(case when stage_5_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

    union all

    select
        creation_month as month,
        '6' as funnel_step,
        count(case when stage_6_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

    union all

    select
        creation_month as month,
        '7' as funnel_step,
        count(case when stage_7_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

    union all

    select
        creation_month as month,
        '8' as funnel_step,
        count(case when stage_8_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

    union all

    select
        creation_month as month,
        '9' as funnel_step,
        count(case when stage_9_reached_at is not null then 1 end) as deals_count
    
    from deals_base
    group by creation_month

),

final as (

    select
        spine.month,
        spine.kpi_name,
        spine.funnel_step,
        coalesce(counts.deals_count, 0) as deals_count
    
    from complete_spine as spine

    left join step_counts as counts
        on spine.month = counts.month
        and spine.funnel_step = counts.funnel_step

    order by spine.month, spine.funnel_step

)

select * from final
  );
  
[0m12:06:15.189806 [debug] [Thread-1  ]: SQL status: SELECT 99 in 0.031 seconds
[0m12:06:15.206470 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m12:06:15.207041 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."public_marts"."rep_sales_funnel_monthly__dbt_tmp" rename to "rep_sales_funnel_monthly"
[0m12:06:15.211680 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:06:15.258567 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m12:06:15.260025 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m12:06:15.261014 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m12:06:15.269493 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m12:06:15.282193 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_marts"."rep_sales_funnel_monthly__dbt_backup"
[0m12:06:15.291963 [debug] [Thread-1  ]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m12:06:15.292473 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
drop table if exists "postgres"."public_marts"."rep_sales_funnel_monthly__dbt_backup" cascade
[0m12:06:15.296958 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m12:06:15.301957 [debug] [Thread-1  ]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m12:06:15.305957 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '463d33f9-245b-4636-8fb1-843110600c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229EB0D2E80>]}
[0m12:06:15.307629 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_marts.rep_sales_funnel_monthly ........ [[32mSELECT 99[0m in 2.32s]
[0m12:06:15.309866 [debug] [Thread-1  ]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m12:06:15.313206 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:15.314291 [debug] [MainThread]: On master: BEGIN
[0m12:06:15.315420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:06:17.381429 [debug] [MainThread]: SQL status: BEGIN in 2.066 seconds
[0m12:06:17.382523 [debug] [MainThread]: On master: COMMIT
[0m12:06:17.383660 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:17.384215 [debug] [MainThread]: On master: COMMIT
[0m12:06:17.386942 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:06:17.388132 [debug] [MainThread]: On master: Close
[0m12:06:17.389791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:06:17.390907 [debug] [MainThread]: Connection 'create_postgres_public_marts' was properly closed.
[0m12:06:17.392014 [debug] [MainThread]: Connection 'list_postgres_public_marts' was properly closed.
[0m12:06:17.392573 [debug] [MainThread]: Connection 'model.enpal_assessment_project.rep_sales_funnel_monthly' was properly closed.
[0m12:06:17.393658 [info ] [MainThread]: 
[0m12:06:17.395369 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 21.55 seconds (21.55s).
[0m12:06:17.397204 [debug] [MainThread]: Command end result
[0m12:06:17.487524 [info ] [MainThread]: 
[0m12:06:17.488534 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:06:17.490974 [info ] [MainThread]: 
[0m12:06:17.492208 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:06:17.495903 [debug] [MainThread]: Command `dbt run` succeeded at 12:06:17.495394 after 23.21 seconds
[0m12:06:17.497021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229EA369EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E7E04670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E7753310>]}
[0m12:06:17.498159 [debug] [MainThread]: Flushing usage events
